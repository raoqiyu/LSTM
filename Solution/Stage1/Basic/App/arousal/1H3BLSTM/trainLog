/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'epochs': 2000, 'valid_batch_size': 5, 'validFreq': -1, 'L1_penalty': None, 'dispFreq': 1, 'optimizer': <optimizer.ADADELTA object at 0x7ff3db045160>, 'saveto': 'Stage1/Basic/App/arousal/1H3BLSTM/', 'patience': 20, 'shuffle': False, 'L2_penalty': None, 'reload_model': None, 'learning_rate': 1e-05, 'saveFreq': 1110, 'batch_size': 15}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.18124 0.00656943764872
valid Data: 0.208163 -0.0108587278174
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 10231.02734375

Train Data: 0.280296 0.00137382155934
valid Data: 0.350986 -0.00303953403447
Test  Data: 0.350986 -0.00303953403447 

Save model
Saving rmse model
Epoch 1
     Update 2 Cost 15231.11328125

Train Data: 0.198844 -0.000618544787896
valid Data: 0.194599 -0.00225101798994
Test  Data: 0.194599 -0.00225101798994 

Save model
Saving rmse model
Epoch 2
     Update 3 Cost 11428.748046875

Train Data: 0.202596 0.0147920693473
valid Data: 0.255744 0.000523357851755
Test  Data: 0.255744 0.000523357851755 

Save model
Saving ccc model
Epoch 3
     Update 4 Cost 10637.376953125

Train Data: 0.198868 0.00758684163593
valid Data: 0.193403 0.00860637343248
Test  Data: 0.193403 0.00860637343248 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 5 Cost 11494.93359375

Train Data: 0.203384 0.0156730903451
valid Data: 0.258951 0.00360128649348
Test  Data: 0.258951 0.00360128649348 

Epoch 5
     Update 6 Cost 10624.486328125

Train Data: 0.185296 0.0116219515845
valid Data: 0.198377 -0.00788664710747
Test  Data: 0.198377 -0.00788664710747 

Epoch 6
     Update 7 Cost 10573.443359375

Train Data: 0.190664 0.0146227584017
valid Data: 0.239167 0.00350114755096
Test  Data: 0.239167 0.00350114755096 

Epoch 7
     Update 8 Cost 10166.3984375

Train Data: 0.177322 0.0488830857445
valid Data: 0.209486 0.000660934919763
Test  Data: 0.209486 0.000660934919763 

Epoch 8
     Update 9 Cost 9877.7880859375

Train Data: 0.18006 0.0748422321266
valid Data: 0.227031 0.0159071504775
Test  Data: 0.227031 0.0159071504775 

Save model
Saving ccc model
Epoch 9
     Update 10 Cost 9683.224609375

Train Data: 0.173556 0.110493616823
valid Data: 0.215673 -0.00326562830977
Test  Data: 0.215673 -0.00326562830977 

Epoch 10
     Update 11 Cost 9594.92578125

Train Data: 0.171688 0.158630470242
valid Data: 0.216241 0.0199430753667
Test  Data: 0.216241 0.0199430753667 

Save model
Saving ccc model
Epoch 11
     Update 12 Cost 9336.34765625

Train Data: 0.174143 0.211321230691
valid Data: 0.231849 0.03220830893
Test  Data: 0.231849 0.03220830893 

Save model
Saving ccc model
Epoch 12
     Update 13 Cost 9074.072265625

Train Data: 0.163354 0.306263873895
valid Data: 0.19644 0.0459396539707
Test  Data: 0.19644 0.0459396539707 

Save model
Saving ccc model
Epoch 13
     Update 14 Cost 9087.982421875

Train Data: 0.229739 0.152618909856
valid Data: 0.311919 0.0327582158496
Test  Data: 0.311919 0.0327582158496 

Epoch 14
     Update 15 Cost 12157.033203125

Train Data: 0.195463 0.107352789976
valid Data: 0.192659 0.0150803385952
Test  Data: 0.192659 0.0150803385952 

Save model
Saving rmse model
Epoch 15
     Update 16 Cost 11273.609375

Train Data: 0.191003 0.0522445866979
valid Data: 0.24979 0.000926968766975
Test  Data: 0.24979 0.000926968766975 

Epoch 16
     Update 17 Cost 10125.8955078125

Train Data: 0.173915 0.148660874823
valid Data: 0.196462 0.020954860856
Test  Data: 0.196462 0.020954860856 

Epoch 17
     Update 18 Cost 9884.5625

Train Data: 0.179311 0.167721494098
valid Data: 0.240829 0.00877699020827
Test  Data: 0.240829 0.00877699020827 

Epoch 18
     Update 19 Cost 9400.103515625

Train Data: 0.176452 0.14788386171
valid Data: 0.217035 -0.0145969787374
Test  Data: 0.217035 -0.0145969787374 

Epoch 19
     Update 20 Cost 9734.8583984375

Train Data: 0.170307 0.218317148202
valid Data: 0.223027 0.0169429548932
Test  Data: 0.223027 0.0169429548932 

Epoch 20
     Update 21 Cost 9111.6982421875

Train Data: 0.163368 0.308238631852
valid Data: 0.216137 0.0306396675555
Test  Data: 0.216137 0.0306396675555 

Epoch 21
     Update 22 Cost 8731.5859375

Train Data: 0.164812 0.316856546032
valid Data: 0.225348 0.0370083972606
Test  Data: 0.225348 0.0370083972606 

Epoch 22
     Update 23 Cost 8611.7275390625

Train Data: 0.17462 0.301788579569
valid Data: 0.194801 0.0616453770768
Test  Data: 0.194801 0.0616453770768 

Save model
Saving ccc model
Epoch 23
     Update 24 Cost 9796.765625

Train Data: 0.200582 0.199203156272
valid Data: 0.26977 0.0401933843962
Test  Data: 0.26977 0.0401933843962 

Epoch 24
     Update 25 Cost 10380.953125

Train Data: 0.176292 0.19966206242
valid Data: 0.191466 0.0422264953772
Test  Data: 0.191466 0.0422264953772 

Save model
Saving rmse model
Epoch 25
     Update 26 Cost 10090.630859375

Train Data: 0.165955 0.283146936619
valid Data: 0.227676 0.0682369310917
Test  Data: 0.227676 0.0682369310917 

Save model
Saving ccc model
Epoch 26
     Update 27 Cost 8638.794921875

Train Data: 0.150219 0.413246088374
valid Data: 0.199777 0.139648519939
Test  Data: 0.199777 0.139648519939 

Save model
Saving ccc model
Epoch 27
     Update 28 Cost 8090.99853515625

Train Data: 0.1549 0.466177607081
valid Data: 0.2215 0.163724638379
Test  Data: 0.2215 0.163724638379 

Save model
Saving ccc model
Epoch 28
     Update 29 Cost 7873.13134765625

Train Data: 0.15994 0.429337384037
valid Data: 0.187532 0.14152376928
Test  Data: 0.187532 0.14152376928 

Save model
Saving rmse model
Epoch 29
     Update 30 Cost 8921.40234375

Train Data: 0.184555 0.342711550686
valid Data: 0.266666 0.114951736195
Test  Data: 0.266666 0.114951736195 

Epoch 30
     Update 31 Cost 9450.791015625

Train Data: 0.164818 0.333941347092
valid Data: 0.190205 0.0766887818403
Test  Data: 0.190205 0.0766887818403 

Epoch 31
     Update 32 Cost 9325.193359375

Train Data: 0.150221 0.450768640127
valid Data: 0.218423 0.123223656878
Test  Data: 0.218423 0.123223656878 

Epoch 32
     Update 33 Cost 7777.6640625

Train Data: 0.13529 0.587523383708
valid Data: 0.189706 0.279564160132
Test  Data: 0.189706 0.279564160132 

Save model
Saving ccc model
Epoch 33
     Update 34 Cost 7121.08203125

Train Data: 0.145565 0.580941345913
valid Data: 0.225396 0.236320983452
Test  Data: 0.225396 0.236320983452 

Epoch 34
     Update 35 Cost 7395.82421875

Train Data: 0.175707 0.443650614216
valid Data: 0.193322 0.207049031135
Test  Data: 0.193322 0.207049031135 

Epoch 35
     Update 36 Cost 9751.3681640625

Train Data: 0.183208 0.335708507422
valid Data: 0.268159 0.0818600158463
Test  Data: 0.268159 0.0818600158463 

Epoch 36
     Update 37 Cost 9505.8125

Train Data: 0.150787 0.39258923574
valid Data: 0.196624 0.096345471366
Test  Data: 0.196624 0.096345471366 

Epoch 37
     Update 38 Cost 8311.58984375

Train Data: 0.14124 0.539477240697
valid Data: 0.216758 0.181598519326
Test  Data: 0.216758 0.181598519326 

Epoch 38
     Update 39 Cost 7279.65869140625

Train Data: 0.133973 0.59606577469
valid Data: 0.193449 0.23628547589
Test  Data: 0.193449 0.23628547589 

Epoch 39
     Update 40 Cost 7155.814453125

Train Data: 0.147424 0.575818530977
valid Data: 0.236011 0.242539969124
Test  Data: 0.236011 0.242539969124 

Epoch 40
     Update 41 Cost 7586.11767578125

Train Data: 0.177588 0.391089911362
valid Data: 0.195625 0.113425119969
Test  Data: 0.195625 0.113425119969 

Epoch 41
     Update 42 Cost 10008.96484375

Train Data: 0.154166 0.414507237812
valid Data: 0.224935 0.0829155032868
Test  Data: 0.224935 0.0829155032868 

Epoch 42
     Update 43 Cost 8053.30517578125

Train Data: 0.133822 0.588239145571
valid Data: 0.204679 0.162648078838
Test  Data: 0.204679 0.162648078838 

Epoch 43
     Update 44 Cost 7023.576171875

Train Data: 0.125857 0.667958119189
valid Data: 0.205049 0.251100113857
Test  Data: 0.205049 0.251100113857 

Epoch 44
     Update 45 Cost 6459.30126953125

Train Data: 0.119775 0.708827226536
valid Data: 0.189272 0.320088104263
Test  Data: 0.189272 0.320088104263 

Save model
Saving ccc model
Epoch 45
     Update 46 Cost 6261.333984375

Train Data: 0.124488 0.691956248582
valid Data: 0.216743 0.275607766211
Test  Data: 0.216743 0.275607766211 

Epoch 46
     Update 47 Cost 6368.22705078125

Train Data: 0.154914 0.58720689311
valid Data: 0.193055 0.25662352088
Test  Data: 0.193055 0.25662352088 

Epoch 47
     Update 48 Cost 8604.841796875

Train Data: 0.181652 0.414374979366
valid Data: 0.268447 0.14051318429
Test  Data: 0.268447 0.14051318429 

Epoch 48
     Update 49 Cost 9365.8408203125

Train Data: 0.162963 0.379299831387
valid Data: 0.189697 0.0887039617583
Test  Data: 0.189697 0.0887039617583 

Epoch 49
     Update 50 Cost 9204.388671875

Train Data: 0.137641 0.567724698981
valid Data: 0.218772 0.159515851432
Test  Data: 0.218772 0.159515851432 

Epoch 50
     Update 51 Cost 7052.828125

Train Data: 0.12362 0.680693966221
valid Data: 0.18902 0.296045529276
Test  Data: 0.18902 0.296045529276 

Epoch 51
     Update 52 Cost 6474.37841796875

Train Data: 0.129945 0.674051598645
valid Data: 0.218004 0.274494659303
Test  Data: 0.218004 0.274494659303 

Epoch 52
     Update 53 Cost 6634.744140625

Train Data: 0.131752 0.638601182988
valid Data: 0.181741 0.296694909842
Test  Data: 0.181741 0.296694909842 

Save model
Saving rmse model
Epoch 53
     Update 54 Cost 7115.9013671875

Train Data: 0.142366 0.630983843113
valid Data: 0.247931 0.238489723957
Test  Data: 0.247931 0.238489723957 

Epoch 54
     Update 55 Cost 7370.15576171875

Train Data: 0.146655 0.576516733892
valid Data: 0.183343 0.257693512032
Test  Data: 0.183343 0.257693512032 

Epoch 55
     Update 56 Cost 8157.49951171875

Train Data: 0.123024 0.688378346543
valid Data: 0.212732 0.290008469054
Test  Data: 0.212732 0.290008469054 

Epoch 56
     Update 57 Cost 6254.0732421875

Train Data: 0.112278 0.753147449751
valid Data: 0.184984 0.368342865668
Test  Data: 0.184984 0.368342865668 

Save model
Saving ccc model
Epoch 57
     Update 58 Cost 5880.974609375

Train Data: 0.120688 0.720418579664
valid Data: 0.225026 0.296294313093
Test  Data: 0.225026 0.296294313093 

Epoch 58
     Update 59 Cost 6145.6787109375

Train Data: 0.127466 0.691419049668
valid Data: 0.178999 0.34176689493
Test  Data: 0.178999 0.34176689493 

Save model
Saving rmse model
Epoch 59
     Update 60 Cost 6881.57177734375

Train Data: 0.126223 0.700588988046
valid Data: 0.238184 0.261269330102
Test  Data: 0.238184 0.261269330102 

Epoch 60
     Update 61 Cost 6396.6552734375

Train Data: 0.126033 0.692316819386
valid Data: 0.180819 0.314697094657
Test  Data: 0.180819 0.314697094657 

Epoch 61
     Update 62 Cost 6815.14599609375

Train Data: 0.120943 0.718530014283
valid Data: 0.226781 0.284306118475
Test  Data: 0.226781 0.284306118475 

Epoch 62
     Update 63 Cost 6117.7021484375

Train Data: 0.111764 0.752411793662
valid Data: 0.180307 0.390784181692
Test  Data: 0.180307 0.390784181692 

Save model
Saving ccc model
Epoch 63
     Update 64 Cost 5955.1435546875

Train Data: 0.119886 0.737907480789
valid Data: 0.235401 0.285638629617
Test  Data: 0.235401 0.285638629617 

Epoch 64
     Update 65 Cost 6126.0595703125

Train Data: 0.12777 0.691071305168
valid Data: 0.180013 0.332688872324
Test  Data: 0.180013 0.332688872324 

Epoch 65
     Update 66 Cost 6976.9365234375

Train Data: 0.121226 0.711392797039
valid Data: 0.225859 0.289537614678
Test  Data: 0.225859 0.289537614678 

Epoch 66
     Update 67 Cost 6139.2138671875

Train Data: 0.111913 0.76324302626
valid Data: 0.17739 0.404869568678
Test  Data: 0.17739 0.404869568678 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 67
     Update 68 Cost 6025.8115234375

Train Data: 0.116422 0.755053327108
valid Data: 0.229924 0.309601953287
Test  Data: 0.229924 0.309601953287 

Epoch 68
     Update 69 Cost 5898.1279296875

Train Data: 0.122831 0.704541214302
valid Data: 0.179101 0.354805401235
Test  Data: 0.179101 0.354805401235 

Epoch 69
     Update 70 Cost 6684.03515625

Train Data: 0.118481 0.738391709064
valid Data: 0.235007 0.283527411685
Test  Data: 0.235007 0.283527411685 

Epoch 70
     Update 71 Cost 6064.263671875

Train Data: 0.114934 0.757257688321
valid Data: 0.182334 0.366032471117
Test  Data: 0.182334 0.366032471117 

Epoch 71
     Update 72 Cost 6151.7900390625

Train Data: 0.107486 0.786388768744
valid Data: 0.222503 0.310209907603
Test  Data: 0.222503 0.310209907603 

Epoch 72
     Update 73 Cost 5439.40625

Train Data: 0.103906 0.792896710837
valid Data: 0.182291 0.389121720166
Test  Data: 0.182291 0.389121720166 

Epoch 73
     Update 74 Cost 5478.6669921875

Train Data: 0.113896 0.781229556177
valid Data: 0.243197 0.278732964453
Test  Data: 0.243197 0.278732964453 

Epoch 74
     Update 75 Cost 5802.3388671875

Train Data: 0.133947 0.655782321507
valid Data: 0.184467 0.29353560419
Test  Data: 0.184467 0.29353560419 

Epoch 75
     Update 76 Cost 7268.158203125

Train Data: 0.121924 0.694792146043
valid Data: 0.219111 0.274404958239
Test  Data: 0.219111 0.274404958239 

Epoch 76
     Update 77 Cost 6228.36279296875

Train Data: 0.107719 0.789254406588
valid Data: 0.183183 0.380069719358
Test  Data: 0.183183 0.380069719358 

Epoch 77
     Update 78 Cost 5713.48828125

Train Data: 0.11967 0.727651090047
valid Data: 0.23554 0.281830413961
Test  Data: 0.23554 0.281830413961 

Epoch 78
     Update 79 Cost 6096.1650390625

Train Data: 0.114591 0.759132112692
valid Data: 0.183306 0.382388018996
Test  Data: 0.183306 0.382388018996 

Epoch 79
     Update 80 Cost 6112.1865234375

Train Data: 0.113247 0.771654155698
valid Data: 0.235403 0.280291164353
Test  Data: 0.235403 0.280291164353 

Epoch 80
     Update 81 Cost 5628.5654296875

Train Data: 0.125126 0.696873649224
valid Data: 0.183895 0.319316190009
Test  Data: 0.183895 0.319316190009 

Epoch 81
     Update 82 Cost 6724.63720703125

Train Data: 0.108602 0.768199434732
valid Data: 0.212971 0.318534532648
Test  Data: 0.212971 0.318534532648 

Epoch 82
     Update 83 Cost 5559.9306640625

Train Data: 0.107083 0.810066916778
valid Data: 0.181656 0.417940507376
Test  Data: 0.181656 0.417940507376 

Save model
Saving ccc model
Epoch 83
     Update 84 Cost 5642.9326171875

Train Data: 0.118573 0.728090878318
valid Data: 0.236817 0.262208438311
Test  Data: 0.236817 0.262208438311 

Epoch 84
     Update 85 Cost 6082.2294921875

Train Data: 0.099658 0.8117631867
valid Data: 0.185083 0.385090961986
Test  Data: 0.185083 0.385090961986 

Epoch 85
     Update 86 Cost 5241.47021484375

Train Data: 0.0984703 0.844254462543
valid Data: 0.215289 0.354033541642
Test  Data: 0.215289 0.354033541642 

Epoch 86
     Update 87 Cost 5044.373046875

Train Data: 0.103855 0.782877040083
valid Data: 0.179487 0.406380354668
Test  Data: 0.179487 0.406380354668 

Epoch 87
     Update 88 Cost 5458.76611328125

Train Data: 0.103494 0.809639272439
valid Data: 0.236356 0.295128040626
Test  Data: 0.236356 0.295128040626 

Epoch 88
     Update 89 Cost 5237.49951171875

Train Data: 0.108583 0.776198285908
valid Data: 0.179211 0.403515265378
Test  Data: 0.179211 0.403515265378 

Epoch 89
     Update 90 Cost 5657.5458984375

Train Data: 0.111219 0.772895673391
valid Data: 0.233503 0.300005849722
Test  Data: 0.233503 0.300005849722 

Epoch 90
     Update 91 Cost 5597.255859375

Train Data: 0.123269 0.744616439586
valid Data: 0.184547 0.380814093756
Test  Data: 0.184547 0.380814093756 

Epoch 91
     Update 92 Cost 6624.3544921875

Train Data: 0.109204 0.767397376283
valid Data: 0.21568 0.313979381683
Test  Data: 0.21568 0.313979381683 

Epoch 92
     Update 93 Cost 5561.58984375

Train Data: 0.0941336 0.839757853052
valid Data: 0.18904 0.399749549577
Test  Data: 0.18904 0.399749549577 

Epoch 93
     Update 94 Cost 4847.1064453125

Train Data: 0.0894445 0.86506608451
valid Data: 0.20497 0.38323964362
Test  Data: 0.20497 0.38323964362 

Epoch 94
     Update 95 Cost 4556.76171875

Train Data: 0.098462 0.820173802652
valid Data: 0.182493 0.388896141749
Test  Data: 0.182493 0.388896141749 

Epoch 95
     Update 96 Cost 5077.74658203125

Train Data: 0.100857 0.824951448186
valid Data: 0.232018 0.299059648252
Test  Data: 0.232018 0.299059648252 

Epoch 96
     Update 97 Cost 5146.4638671875

Train Data: 0.110339 0.786733226382
valid Data: 0.179394 0.401774728466
Test  Data: 0.179394 0.401774728466 

Epoch 97
     Update 98 Cost 5814.6171875

Train Data: 0.119072 0.739639393375
valid Data: 0.240339 0.271401530458
Test  Data: 0.240339 0.271401530458 

Epoch 98
     Update 99 Cost 6065.71728515625

Train Data: 0.104963 0.795139783119
valid Data: 0.183085 0.358751438103
Test  Data: 0.183085 0.358751438103 

Epoch 99
     Update 100 Cost 5593.8486328125

Train Data: 0.0924255 0.850864786827
valid Data: 0.207914 0.357914890716
Test  Data: 0.207914 0.357914890716 

Epoch 100
     Update 101 Cost 4695.4677734375

Train Data: 0.0926525 0.853383394521
valid Data: 0.207703 0.324154115835
Test  Data: 0.207703 0.324154115835 

Epoch 101
     Update 102 Cost 4700.2509765625

Train Data: 0.0957048 0.827282411109
valid Data: 0.205075 0.358423106553
Test  Data: 0.205075 0.358423106553 

Epoch 102
     Update 103 Cost 4845.89892578125

Train Data: 0.0882997 0.876213741226
valid Data: 0.195618 0.405532313097
Test  Data: 0.195618 0.405532313097 

Early Stop!

The Best test rmse: 0.177389755845
The Best test ccc: 0.417940507376
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.111913 0.76324302626
valid Data: 0.17739 0.404869568678
Test  Data: 0.17739 0.404869568678 


The src run for 103 epochs, with 43.485124 sec/epochs
Training took 4479s
Stage 1:  ((0.111913, 0.76324302625958051), (0.17738976, 0.40486956867792229), (0.17738976, 0.40486956867792229))

Process finished with exit code 0

