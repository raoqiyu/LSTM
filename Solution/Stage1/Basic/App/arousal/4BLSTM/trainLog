/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'dispFreq': 1, 'L2_penalty': None, 'optimizer': <optimizer.ADADELTA object at 0x7f3945668d30>, 'L1_penalty': None, 'learning_rate': 1e-05, 'shuffle': False, 'epochs': 2000, 'patience': 20, 'valid_batch_size': 5, 'validFreq': -1, 'saveFreq': 1110, 'saveto': 'Stage1/Basic/App/arousal/4BLSTM/', 'batch_size': 15, 'reload_model': None}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.188469 -0.00437704544462
valid Data: 0.205408 -0.00614307918867
Test  Data: 0.205408 -0.00614307918867
Epoch 0
     Update 1 Cost 10620.89453125

Train Data: 0.175419 0.119918063587
valid Data: 0.204467 0.0381297764022
Test  Data: 0.204467 0.0381297764022 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 2 Cost 9680.4130859375

Train Data: 0.177467 0.172234636141
valid Data: 0.233422 -0.0600082178749
Test  Data: 0.233422 -0.0600082178749 

Epoch 2
     Update 3 Cost 9321.671875

Train Data: 0.160361 0.345765401256
valid Data: 0.217434 0.0413280877277
Test  Data: 0.217434 0.0413280877277 

Save model
Saving ccc model
Epoch 3
     Update 4 Cost 8393.6875

Train Data: 0.173685 0.33551620757
valid Data: 0.253955 -0.0893285276366
Test  Data: 0.253955 -0.0893285276366 

Epoch 4
     Update 5 Cost 8499.76953125

Train Data: 0.156737 0.502563617902
valid Data: 0.215673 0.131101162861
Test  Data: 0.215673 0.131101162861 

Save model
Saving ccc model
Epoch 5
     Update 6 Cost 7835.0

Train Data: 0.18941 0.375521890819
valid Data: 0.285864 -0.11307391593
Test  Data: 0.285864 -0.11307391593 

Epoch 6
     Update 7 Cost 8755.4990234375

Train Data: 0.135443 0.585793748088
valid Data: 0.211742 0.0618224632287
Test  Data: 0.211742 0.0618224632287 

Epoch 7
     Update 8 Cost 6962.5869140625

Train Data: 0.136005 0.649706579748
valid Data: 0.253615 -0.0312685228854
Test  Data: 0.253615 -0.0312685228854 

Epoch 8
     Update 9 Cost 6566.8486328125

Train Data: 0.144231 0.618179319211
valid Data: 0.21011 0.152425441495
Test  Data: 0.21011 0.152425441495 

Save model
Saving ccc model
Epoch 9
     Update 10 Cost 7044.37109375

Train Data: 0.134833 0.674051155362
valid Data: 0.258909 -0.0368859119383
Test  Data: 0.258909 -0.0368859119383 

Epoch 10
     Update 11 Cost 6381.5654296875

Train Data: 0.133837 0.685536322054
valid Data: 0.213024 0.143274418425
Test  Data: 0.213024 0.143274418425 

Epoch 11
     Update 12 Cost 6373.26171875

Train Data: 0.111679 0.769526465439
valid Data: 0.242135 0.0119048133927
Test  Data: 0.242135 0.0119048133927 

Epoch 12
     Update 13 Cost 5354.5830078125

Train Data: 0.112338 0.772500088482
valid Data: 0.21264 0.115416691396
Test  Data: 0.21264 0.115416691396 

Epoch 13
     Update 14 Cost 5309.46630859375

Train Data: 0.112072 0.786975145337
valid Data: 0.255446 -0.0226889746741
Test  Data: 0.255446 -0.0226889746741 

Epoch 14
     Update 15 Cost 5249.02734375

Train Data: 0.122145 0.746384018508
valid Data: 0.211305 0.134808814895
Test  Data: 0.211305 0.134808814895 

Epoch 15
     Update 16 Cost 5804.0595703125

Train Data: 0.0991076 0.826407695354
valid Data: 0.242201 0.0153699468467
Test  Data: 0.242201 0.0153699468467 

Epoch 16
     Update 17 Cost 4697.255859375

Train Data: 0.0898003 0.853228505034
valid Data: 0.215291 0.0644904841253
Test  Data: 0.215291 0.0644904841253 

Epoch 17
     Update 18 Cost 4390.5537109375

Train Data: 0.0861249 0.880727000813
valid Data: 0.242497 0.0458176685861
Test  Data: 0.242497 0.0458176685861 

Epoch 18
     Update 19 Cost 4366.99609375

Train Data: 0.0897678 0.842402237157
valid Data: 0.212119 0.0419788371817
Test  Data: 0.212119 0.0419788371817 

Epoch 19
     Update 20 Cost 4655.99462890625

Train Data: 0.0773946 0.911659091627
valid Data: 0.239689 0.0662979778576
Test  Data: 0.239689 0.0662979778576 

Epoch 20
     Update 21 Cost 3934.54638671875

Train Data: 0.0916858 0.824324128925
valid Data: 0.21995 -0.004514341695
Test  Data: 0.21995 -0.004514341695 

Epoch 21
     Update 22 Cost 4635.5263671875

Train Data: 0.0999738 0.876318903676
valid Data: 0.238406 0.127812362557
Test  Data: 0.238406 0.127812362557 

Epoch 22
     Update 23 Cost 4883.35498046875

Train Data: 0.105062 0.759870824882
valid Data: 0.229858 -0.0296119595119
Test  Data: 0.229858 -0.0296119595119 

Epoch 23
     Update 24 Cost 5231.12744140625

Train Data: 0.0823705 0.90411774064
valid Data: 0.231881 0.0923253348403
Test  Data: 0.231881 0.0923253348403 

Epoch 24
     Update 25 Cost 3959.28662109375

Train Data: 0.0826995 0.859256932453
valid Data: 0.227679 0.00799677529692
Test  Data: 0.227679 0.00799677529692 

Epoch 25
     Update 26 Cost 4040.313720703125

Train Data: 0.0727982 0.929429376179
valid Data: 0.236074 0.0788722222704
Test  Data: 0.236074 0.0788722222704 

Epoch 26
     Update 27 Cost 3716.00927734375

Train Data: 0.0946642 0.81573250201
valid Data: 0.234368 -0.0328936024457
Test  Data: 0.234368 -0.0328936024457 

Epoch 27
     Update 28 Cost 4598.39013671875

Train Data: 0.0798684 0.913409065468
valid Data: 0.232654 0.106561729649
Test  Data: 0.232654 0.106561729649 

Epoch 28
     Update 29 Cost 3813.86962890625

Train Data: 0.0813536 0.871733602009
valid Data: 0.234075 -0.0189958987523
Test  Data: 0.234075 -0.0189958987523 

Epoch 29
     Update 30 Cost 3802.423828125

Train Data: 0.0690944 0.935083132313
valid Data: 0.232787 0.0906667232803
Test  Data: 0.232787 0.0906667232803 

Epoch 30
     Update 31 Cost 3395.62744140625

Train Data: 0.0765683 0.881259631459
valid Data: 0.226214 0.00968319928453
Test  Data: 0.226214 0.00968319928453 

Epoch 31
     Update 32 Cost 3768.349609375

Train Data: 0.066416 0.941306948808
valid Data: 0.237279 0.0722157520269
Test  Data: 0.237279 0.0722157520269 

Epoch 32
     Update 33 Cost 3363.939697265625

Train Data: 0.075896 0.881166015111
valid Data: 0.220195 0.0254863074256
Test  Data: 0.220195 0.0254863074256 

Epoch 33
     Update 34 Cost 3925.775390625

Train Data: 0.0681987 0.936443206631
valid Data: 0.244594 0.0364129714228
Test  Data: 0.244594 0.0364129714228 

Epoch 34
     Update 35 Cost 3351.849609375

Train Data: 0.0853374 0.861157920412
valid Data: 0.209614 0.110440581254
Test  Data: 0.209614 0.110440581254 

Epoch 35
     Update 36 Cost 4442.37548828125

Train Data: 0.0822251 0.905295310846
valid Data: 0.257574 -0.0153103114143
Test  Data: 0.257574 -0.0153103114143 

Epoch 36
     Update 37 Cost 3884.74755859375

Train Data: 0.109924 0.812342912354
valid Data: 0.215287 0.167286466794
Test  Data: 0.215287 0.167286466794 

Save model
Saving ccc model
Epoch 37
     Update 38 Cost 5088.95703125

Train Data: 0.0749675 0.913696465484
valid Data: 0.232067 0.108200325002
Test  Data: 0.232067 0.108200325002 

Epoch 38
     Update 39 Cost 3706.906494140625

Train Data: 0.0810676 0.889009824777
valid Data: 0.239747 -0.0268965591842
Test  Data: 0.239747 -0.0268965591842 

Epoch 39
     Update 40 Cost 3655.73193359375

Train Data: 0.0730157 0.920716687148
valid Data: 0.232476 0.106191332307
Test  Data: 0.232476 0.106191332307 

Epoch 40
     Update 41 Cost 3543.1005859375

Train Data: 0.073551 0.904980064941
valid Data: 0.230754 -0.0111389742682
Test  Data: 0.230754 -0.0111389742682 

Epoch 41
     Update 42 Cost 3516.247802734375

Train Data: 0.0718774 0.927374934118
valid Data: 0.237062 0.102153120552
Test  Data: 0.237062 0.102153120552 

Epoch 42
     Update 43 Cost 3518.134033203125

Train Data: 0.0993364 0.824101091807
valid Data: 0.245019 -0.072016157555
Test  Data: 0.245019 -0.072016157555 

Epoch 43
     Update 44 Cost 4438.9931640625

Train Data: 0.0853462 0.905871110021
valid Data: 0.233413 0.137918770079
Test  Data: 0.233413 0.137918770079 

Epoch 44
     Update 45 Cost 3874.532958984375

Train Data: 0.0778574 0.87908427379
valid Data: 0.232022 -0.0080618387952
Test  Data: 0.232022 -0.0080618387952 

Epoch 45
     Update 46 Cost 3919.036376953125

Train Data: 0.0702085 0.93617060007
valid Data: 0.233451 0.112490625942
Test  Data: 0.233451 0.112490625942 

Epoch 46
     Update 47 Cost 3443.667236328125

Train Data: 0.0814714 0.859346681154
valid Data: 0.226131 0.00564525306712
Test  Data: 0.226131 0.00564525306712 

Epoch 47
     Update 48 Cost 4203.1435546875

Train Data: 0.0640807 0.945331872657
valid Data: 0.238161 0.0764095301947
Test  Data: 0.238161 0.0764095301947 

Epoch 48
     Update 49 Cost 3114.33837890625

Train Data: 0.0823704 0.861698628545
valid Data: 0.227175 0.0010155143605
Test  Data: 0.227175 0.0010155143605 

Epoch 49
     Update 50 Cost 4041.9130859375

Train Data: 0.0784849 0.922843368258
valid Data: 0.239311 0.0706744342053
Test  Data: 0.239311 0.0706744342053 

Epoch 50
     Update 51 Cost 3445.54296875

Train Data: 0.0774761 0.877943807878
valid Data: 0.228172 0.00656822585855
Test  Data: 0.228172 0.00656822585855 

Epoch 51
     Update 52 Cost 3919.8115234375

Train Data: 0.0581626 0.952443070751
valid Data: 0.237714 0.0561064209899
Test  Data: 0.237714 0.0561064209899 

Epoch 52
     Update 53 Cost 2794.649658203125

Train Data: 0.0651781 0.917997414819
valid Data: 0.222769 0.0291980849822
Test  Data: 0.222769 0.0291980849822 

Epoch 53
     Update 54 Cost 3373.59912109375

Train Data: 0.0617546 0.951310925236
valid Data: 0.24597 0.0406091322076
Test  Data: 0.24597 0.0406091322076 

Epoch 54
     Update 55 Cost 3144.26953125

Train Data: 0.0756858 0.880677408315
valid Data: 0.215121 0.0617628865882
Test  Data: 0.215121 0.0617628865882 

Epoch 55
     Update 56 Cost 3995.34326171875

Train Data: 0.0530965 0.961306867554
valid Data: 0.243182 0.0353951176874
Test  Data: 0.243182 0.0353951176874 

Epoch 56
     Update 57 Cost 2584.4404296875

Train Data: 0.0620602 0.925575572093
valid Data: 0.217684 0.0611512105705
Test  Data: 0.217684 0.0611512105705 

Early Stop!

The Best test rmse: 0.204467117786
The Best test ccc: 0.167286466794
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.175419 0.119918063587
valid Data: 0.204467 0.0381297764022
Test  Data: 0.204467 0.0381297764022 


The src run for 57 epochs, with 53.281470 sec/epochs
Training took 3037s
Stage 1:  ((0.17541866, 0.11991806358655208), (0.20446712, 0.038129776402174388), (0.20446712, 0.038129776402174388))

Process finished with exit code 0

