/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 316
Hidden Layer : 128 hidden layer
Hidden Layer : 128 BLSTM
Hidden Layer : 128 BLSTM
Hidden Layer : 128 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'learning_rate': 1e-05, 'validFreq': -1, 'patience': 10, 'valid_batch_size': 5, 'epochs': 2000, 'batch_size': 15, 'dispFreq': 1, 'saveto': 'Stage1/Range/Geo/arousal/Basic/128/model/', 'L2_penalty': None, 'saveFreq': 1110, 'reload_model': None, 'L1_penalty': None, 'optimizer': <optimizer.ADADELTA object at 0x7fbddb548710>, 'shuffle': False}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.187413 0.0362262534455
valid Data: 0.209655 -0.017900348274
Test  Data: 0.209655 -0.017900348274
Epoch 0
     Update 1 Cost 10469.4609375

Train Data: 0.198063 -0.0488714212144
valid Data: 0.227198 -0.0507255525314
Test  Data: 0.227198 -0.0507255525314 

Save model
Saving rmse model
Epoch 1
     Update 2 Cost 10925.267578125

Train Data: 0.192601 -0.0364176435169
valid Data: 0.208461 -0.00653435002133
Test  Data: 0.208461 -0.00653435002133 

Save model
Saving rmse model
Epoch 2
     Update 3 Cost 10665.79296875

Train Data: 0.219863 0.0405992785254
valid Data: 0.279851 -0.019410159225
Test  Data: 0.279851 -0.019410159225 

Epoch 3
     Update 4 Cost 11568.517578125

Train Data: 0.326355 0.00917001549284
valid Data: 0.281134 0.0131266549709
Test  Data: 0.281134 0.0131266549709 

Save model
Saving ccc model
Epoch 4
     Update 5 Cost 19198.171875

Train Data: 0.376908 0.0290967144252
valid Data: 0.428994 0.0167354474274
Test  Data: 0.428994 0.0167354474274 

Save model
Saving ccc model
Epoch 5
     Update 6 Cost 21589.94921875

Train Data: 0.424635 -0.00661463171843
valid Data: 0.381538 -0.0994354632362
Test  Data: 0.381538 -0.0994354632362 

Epoch 6
     Update 7 Cost 25444.96875

Train Data: 0.328996 0.0208721633217
valid Data: 0.395376 0.0212989264844
Test  Data: 0.395376 0.0212989264844 

Save model
Saving ccc model
Epoch 7
     Update 8 Cost 18857.53125

Train Data: 0.469117 -0.0108533563815
valid Data: 0.41428 -0.0613185166342
Test  Data: 0.41428 -0.0613185166342 

Epoch 8
     Update 9 Cost 28590.3046875

Train Data: 0.468342 0.0127469362711
valid Data: 0.536686 0.0334884533904
Test  Data: 0.536686 0.0334884533904 

Save model
Saving ccc model
Epoch 9
     Update 10 Cost 28473.126953125

Train Data: 0.311554 0.0195720664341
valid Data: 0.278968 -0.0871438934568
Test  Data: 0.278968 -0.0871438934568 

Epoch 10
     Update 11 Cost 18083.953125

Train Data: 0.257958 0.0810032707155
valid Data: 0.324428 0.0146872881062
Test  Data: 0.324428 0.0146872881062 

Epoch 11
     Update 12 Cost 13905.296875

Train Data: 0.291788 0.0149420608812
valid Data: 0.264648 -0.101033672509
Test  Data: 0.264648 -0.101033672509 

Epoch 12
     Update 13 Cost 16792.6875

Train Data: 0.291991 0.0413272953079
valid Data: 0.361039 0.0367703601074
Test  Data: 0.361039 0.0367703601074 

Save model
Saving ccc model
Epoch 13
     Update 14 Cost 16079.4013671875

Train Data: 0.270496 0.0240735171247
valid Data: 0.238071 -0.0521553291135
Test  Data: 0.238071 -0.0521553291135 

Epoch 14
     Update 15 Cost 15577.62109375

Train Data: 0.217818 0.036741209889
valid Data: 0.27212 0.0476775229932
Test  Data: 0.27212 0.0476775229932 

Save model
Saving ccc model
Epoch 15
     Update 16 Cost 11336.4169921875

Train Data: 0.241709 0.0278425778201
valid Data: 0.22079 -0.0673672411529
Test  Data: 0.22079 -0.0673672411529 

Epoch 16
     Update 17 Cost 13824.466796875

Train Data: 0.238209 0.0448001826338
valid Data: 0.304774 0.0462187387986
Test  Data: 0.304774 0.0462187387986 

Epoch 17
     Update 18 Cost 12388.8310546875

Train Data: 0.209756 0.0444218845457
valid Data: 0.205637 -0.0617741037588
Test  Data: 0.205637 -0.0617741037588 

Save model
Saving rmse model
Epoch 18
     Update 19 Cost 12069.14453125

Train Data: 0.21134 0.08167536138
valid Data: 0.274959 0.0168850359354
Test  Data: 0.274959 0.0168850359354 

Epoch 19
     Update 20 Cost 10920.4638671875

Train Data: 0.197993 0.0771918879432
valid Data: 0.204371 -0.0611232841944
Test  Data: 0.204371 -0.0611232841944 

Save model
Saving rmse model
Epoch 20
     Update 21 Cost 11365.6953125

Train Data: 0.187543 0.120312168265
valid Data: 0.248411 -0.00192558712828
Test  Data: 0.248411 -0.00192558712828 

Epoch 21
     Update 22 Cost 9820.587890625

Train Data: 0.174869 0.125410035005
valid Data: 0.212492 -0.0446808181761
Test  Data: 0.212492 -0.0446808181761 

Epoch 22
     Update 23 Cost 9829.3955078125

Train Data: 0.181679 0.153461475032
valid Data: 0.243677 -0.017327965993
Test  Data: 0.243677 -0.017327965993 

Epoch 23
     Update 24 Cost 9576.3583984375

Train Data: 0.170928 0.173421486294
valid Data: 0.216061 -0.0551360890809
Test  Data: 0.216061 -0.0551360890809 

Epoch 24
     Update 25 Cost 9520.083984375

Train Data: 0.179664 0.173866254118
valid Data: 0.245677 -0.0326839763693
Test  Data: 0.245677 -0.0326839763693 

Epoch 25
     Update 26 Cost 9436.0791015625

Train Data: 0.170749 0.198509796851
valid Data: 0.218416 -0.0782017856656
Test  Data: 0.218416 -0.0782017856656 

Epoch 26
     Update 27 Cost 9500.7119140625

Train Data: 0.181251 0.170088811136
valid Data: 0.249922 -0.040915039518
Test  Data: 0.249922 -0.040915039518 

Early Stop!

The Best test rmse: 0.204371199012
The Best test ccc: 0.0476775229932
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.197993 0.0771918879432
valid Data: 0.204371 -0.0611232841944
Test  Data: 0.204371 -0.0611232841944 


The src run for 27 epochs, with 53.593110 sec/epochs
Training took 1447s
Stage 1:  ((0.1979934, 0.07719188794323259), (0.2043712, -0.061123284194430895), (0.2043712, -0.061123284194430895))

Process finished with exit code 0

