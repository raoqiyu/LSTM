/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.9_150_45.pkl
45 generated train examples : 45 6750
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'valid_batch_size': 5, 'validFreq': -1, 'saveto': 'Stage1/Range/App/0.9/150/model/', 'patience': 10, 'shuffle': False, 'saveFreq': 1110, 'dispFreq': 1, 'optimizer': <optimizer.ADADELTA object at 0x7f84787a99b0>, 'reload_model': None, 'L1_penalty': None, 'epochs': 2000, 'L2_penalty': None, 'learning_rate': 1e-05, 'batch_size': 15}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.184228 0.00376761352415
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 15884.69921875
     Update 2 Cost 26677.61328125
     Update 3 Cost 17137.986328125

Train Data: 0.199031 0.0095583853647
valid Data: 0.194969 0.00614401863664
Test  Data: 0.248123 -0.00598594535682 

Save model
Saving rmse model
Epoch 1
     Update 4 Cost 14858.494140625
     Update 5 Cost 15081.6533203125
     Update 6 Cost 16762.97265625

Train Data: 0.219218 0.0349858871951
valid Data: 0.214974 0.0290051974984
Test  Data: 0.28141 -0.000946631271029 

Epoch 2
     Update 7 Cost 15400.3271484375
     Update 8 Cost 14814.009765625
     Update 9 Cost 15350.75390625

Train Data: 0.182125 0.0743005036075
valid Data: 0.179491 0.0655707208912
Test  Data: 0.221571 0.0174858763288 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 3
     Update 10 Cost 14576.9296875
     Update 11 Cost 18132.0703125
     Update 12 Cost 19890.27734375

Train Data: 0.187729 0.0544937858915
valid Data: 0.183882 0.0539255101162
Test  Data: 0.234847 -0.00218659126216 

Epoch 4
     Update 13 Cost 14525.662109375
     Update 14 Cost 15750.576171875
     Update 15 Cost 16324.623046875

Train Data: 0.181222 0.137646126335
valid Data: 0.177648 0.135429133263
Test  Data: 0.23106 0.0236050780601 

Save model
Saving ccc model
Epoch 5
     Update 16 Cost 13979.57421875
     Update 17 Cost 15012.259765625
     Update 18 Cost 16168.744140625

Train Data: 0.179343 0.240856478511
valid Data: 0.175942 0.237661324357
Test  Data: 0.238897 0.0779844518764 

Save model
Saving ccc model
Epoch 6
     Update 19 Cost 13072.8671875
     Update 20 Cost 12783.7890625
     Update 21 Cost 13804.3447265625

Train Data: 0.167678 0.401885716165
valid Data: 0.167354 0.381467206058
Test  Data: 0.248203 0.120897939399 

Save model
Saving ccc model
Epoch 7
     Update 22 Cost 11867.2421875
     Update 23 Cost 12341.12109375
     Update 24 Cost 13746.001953125

Train Data: 0.160289 0.431587271943
valid Data: 0.161764 0.413871995819
Test  Data: 0.183505 0.25789144123 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 8
     Update 25 Cost 14205.80078125
     Update 26 Cost 19592.36328125
     Update 27 Cost 21197.26953125

Train Data: 0.18199 0.0698787778511
valid Data: 0.178757 0.0670460142165
Test  Data: 0.220469 0.0294734132367 

Epoch 9
     Update 28 Cost 14510.9873046875
     Update 29 Cost 15357.513671875
     Update 30 Cost 15426.171875

Train Data: 0.174263 0.246470530415
valid Data: 0.170391 0.253723536952
Test  Data: 0.248821 0.0304250944477 

Epoch 10
     Update 31 Cost 13084.943359375
     Update 32 Cost 12670.689453125
     Update 33 Cost 13990.048828125

Train Data: 0.176415 0.344407378167
valid Data: 0.172252 0.349864618888
Test  Data: 0.274085 0.0464520063477 

Epoch 11
     Update 34 Cost 12605.15234375
     Update 35 Cost 12425.4453125
     Update 36 Cost 13525.017578125

Train Data: 0.152738 0.457246114627
valid Data: 0.15337 0.444333743718
Test  Data: 0.183172 0.210836296152 

Save model
Saving rmse model
Epoch 12
     Update 37 Cost 13192.544921875
     Update 38 Cost 13273.1826171875
     Update 39 Cost 15186.455078125

Train Data: 0.162015 0.435258486664
valid Data: 0.160204 0.428187506432
Test  Data: 0.248511 0.141959571548 

Epoch 13
     Update 40 Cost 11436.056640625
     Update 41 Cost 11509.9033203125
     Update 42 Cost 11614.400390625

Train Data: 0.134169 0.621008085921
valid Data: 0.135114 0.606093601406
Test  Data: 0.195907 0.302141229914 

Save model
Saving ccc model
Epoch 14
     Update 43 Cost 10337.3916015625
     Update 44 Cost 11309.46484375
     Update 45 Cost 11934.65625

Train Data: 0.155477 0.523530697984
valid Data: 0.154399 0.519429487549
Test  Data: 0.262156 0.17368628615 

Epoch 15
     Update 46 Cost 11226.794921875
     Update 47 Cost 12868.603515625
     Update 48 Cost 12793.275390625

Train Data: 0.138508 0.557138079282
valid Data: 0.138145 0.549080455008
Test  Data: 0.184879 0.265228444014 

Epoch 16
     Update 49 Cost 11384.111328125
     Update 50 Cost 11178.7109375
     Update 51 Cost 11130.951171875

Train Data: 0.139191 0.622858682043
valid Data: 0.139205 0.6101978606
Test  Data: 0.237356 0.243254361422 

Epoch 17
     Update 52 Cost 10213.31640625
     Update 53 Cost 11263.6865234375
     Update 54 Cost 11989.919921875

Train Data: 0.142344 0.608458817603
valid Data: 0.146098 0.584457813383
Test  Data: 0.171056 0.410320344148 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 18
     Update 55 Cost 11736.744140625
     Update 56 Cost 13948.80859375
     Update 57 Cost 14100.4140625

Train Data: 0.145302 0.556549309866
valid Data: 0.144426 0.548420971607
Test  Data: 0.234893 0.189251291028 

Epoch 19
     Update 58 Cost 10695.5419921875
     Update 59 Cost 10512.9609375
     Update 60 Cost 10276.875

Train Data: 0.12077 0.722792621458
valid Data: 0.125051 0.698248168203
Test  Data: 0.179743 0.432853538065 

Save model
Saving ccc model
Epoch 20
     Update 61 Cost 9215.6962890625
     Update 62 Cost 9722.3603515625
     Update 63 Cost 9584.564453125

Train Data: 0.135502 0.673400439861
valid Data: 0.136958 0.65699164359
Test  Data: 0.243825 0.235273293735 

Epoch 21
     Update 64 Cost 10289.978515625
     Update 65 Cost 11677.9765625
     Update 66 Cost 10324.80859375

Train Data: 0.118905 0.732231306254
valid Data: 0.122891 0.709124263903
Test  Data: 0.177402 0.416213082545 

Epoch 22
     Update 67 Cost 9334.95703125
     Update 68 Cost 9924.6494140625
     Update 69 Cost 9443.28125

Train Data: 0.125833 0.731192511935
valid Data: 0.127907 0.714636929106
Test  Data: 0.24609 0.271334889381 

Epoch 23
     Update 70 Cost 9782.0849609375
     Update 71 Cost 10507.6953125
     Update 72 Cost 9038.3515625

Train Data: 0.117923 0.778372958267
valid Data: 0.125369 0.746062534028
Test  Data: 0.181051 0.478288577786 

Save model
Saving ccc model
Epoch 24
     Update 73 Cost 9042.439453125
     Update 74 Cost 10663.837890625
     Update 75 Cost 11415.919921875

Train Data: 0.136933 0.680313292117
valid Data: 0.136821 0.673139046671
Test  Data: 0.274863 0.197814620253 

Epoch 25
     Update 76 Cost 10486.193359375
     Update 77 Cost 10470.3232421875
     Update 78 Cost 8790.0283203125

Train Data: 0.107786 0.80027734472
valid Data: 0.110238 0.786656152535
Test  Data: 0.197278 0.41427263024 

Epoch 26
     Update 79 Cost 8241.8662109375
     Update 80 Cost 8830.88671875
     Update 81 Cost 8424.2109375

Train Data: 0.11036 0.785560529546
valid Data: 0.113245 0.769290266093
Test  Data: 0.214548 0.352254334948 

Epoch 27
     Update 82 Cost 8266.81640625
     Update 83 Cost 8264.49609375
     Update 84 Cost 8459.5302734375

Train Data: 0.124792 0.759833242028
valid Data: 0.130602 0.732659802189
Test  Data: 0.177788 0.530768220041 

Save model
Saving ccc model
Epoch 28
     Update 85 Cost 9646.03515625
     Update 86 Cost 11144.125
     Update 87 Cost 10260.70703125

Train Data: 0.133043 0.708738929782
valid Data: 0.133412 0.70174864786
Test  Data: 0.263924 0.241831630922 

Epoch 29
     Update 88 Cost 10290.421875
     Update 89 Cost 9943.2421875
     Update 90 Cost 8185.740234375

Train Data: 0.101278 0.836690414864
valid Data: 0.104845 0.821169966192
Test  Data: 0.194458 0.450077924827 

Epoch 30
     Update 91 Cost 7869.1103515625
     Update 92 Cost 7737.3095703125
     Update 93 Cost 7810.72705078125

Train Data: 0.115617 0.757988452539
valid Data: 0.116102 0.749757652148
Test  Data: 0.243112 0.258682227448 

Epoch 31
     Update 94 Cost 8940.1591796875
     Update 95 Cost 8286.9892578125
     Update 96 Cost 8514.8681640625

Train Data: 0.112739 0.802037343618
valid Data: 0.11645 0.784924961114
Test  Data: 0.178059 0.493701555742 

Epoch 32
     Update 97 Cost 8631.810546875
     Update 98 Cost 8589.53515625
     Update 99 Cost 8825.9677734375

Train Data: 0.122418 0.742390052934
valid Data: 0.123259 0.73326009752
Test  Data: 0.266057 0.213273204673 

Epoch 33
     Update 100 Cost 9291.275390625
     Update 101 Cost 9262.904296875
     Update 102 Cost 8203.2939453125

Train Data: 0.103208 0.817596525772
valid Data: 0.105971 0.803568450861
Test  Data: 0.194444 0.409737756231 

Epoch 34
     Update 103 Cost 8027.748046875
     Update 104 Cost 8250.3427734375
     Update 105 Cost 8466.361328125

Train Data: 0.10862 0.801511529938
valid Data: 0.110705 0.78881429991
Test  Data: 0.236923 0.320544081533 

Epoch 35
     Update 106 Cost 8486.29296875
     Update 107 Cost 8598.9033203125
     Update 108 Cost 8429.302734375

Train Data: 0.0940266 0.849843757021
valid Data: 0.0965733 0.837930666038
Test  Data: 0.196929 0.42801897294 

Epoch 36
     Update 109 Cost 7326.166015625
     Update 110 Cost 7297.642578125
     Update 111 Cost 7963.69677734375

Train Data: 0.109368 0.797242634021
valid Data: 0.110382 0.789947994331
Test  Data: 0.259352 0.234998654375 

Epoch 37
     Update 112 Cost 8517.1796875
     Update 113 Cost 9460.359375
     Update 114 Cost 8680.3115234375

Train Data: 0.101855 0.818934595307
valid Data: 0.108008 0.792232919124
Test  Data: 0.174892 0.508548059627 

Early Stop!

The Best test rmse: 0.171055719256
The Best test ccc: 0.530768220041
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.142344 0.608458817603
valid Data: 0.146098 0.584457813383
Test  Data: 0.171056 0.410320344148 


The src run for 38 epochs, with 94.731801 sec/epochs
Training took 3600s
Stage 1:  ((0.14234354, 0.60845881760326026), (0.14609779, 0.58445781338292158), (0.17105572, 0.41032034414796248))

Process finished with exit code 0

