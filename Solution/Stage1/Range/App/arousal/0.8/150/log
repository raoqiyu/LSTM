/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.8_150_90.pkl
90 generated train examples : 90 6000
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'saveto': 'Stage1/Range/App/0.8/150/model/', 'optimizer': <optimizer.ADADELTA object at 0x7f91614eaf28>, 'validFreq': -1, 'batch_size': 15, 'learning_rate': 1e-05, 'L2_penalty': None, 'valid_batch_size': 5, 'epochs': 2000, 'shuffle': False, 'saveFreq': 1110, 'patience': 10, 'reload_model': None, 'L1_penalty': None, 'dispFreq': 1}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.186066 0.00190972076383
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 13680.951171875
     Update 2 Cost 15140.306640625
     Update 3 Cost 17278.40625
     Update 4 Cost 17714.765625
     Update 5 Cost 13703.0859375
     Update 6 Cost 14743.8154296875

Train Data: 0.183146 0.0330131127797
valid Data: 0.179155 0.0281499276024
Test  Data: 0.206917 -0.00408430460427 

Save model
Saving rmse model
Epoch 1
     Update 7 Cost 13334.560546875
     Update 8 Cost 12479.9814453125
     Update 9 Cost 13345.931640625
     Update 10 Cost 18322.17578125
     Update 11 Cost 13573.8564453125
     Update 12 Cost 14119.6396484375

Train Data: 0.174647 0.150857213197
valid Data: 0.172481 0.136624083538
Test  Data: 0.195102 0.0588114733104 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 2
     Update 13 Cost 12993.80078125
     Update 14 Cost 12016.484375
     Update 15 Cost 13530.53515625
     Update 16 Cost 15148.1240234375
     Update 17 Cost 12080.70703125
     Update 18 Cost 13414.404296875

Train Data: 0.161225 0.340395159677
valid Data: 0.160578 0.315100971675
Test  Data: 0.197612 0.148063318659 

Save model
Saving ccc model
Epoch 3
     Update 19 Cost 11576.3515625
     Update 20 Cost 11072.224609375
     Update 21 Cost 13040.900390625
     Update 22 Cost 14510.521484375
     Update 23 Cost 12329.38671875
     Update 24 Cost 12663.0439453125

Train Data: 0.163027 0.329873057923
valid Data: 0.162238 0.308207016305
Test  Data: 0.186715 0.17837703037 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 25 Cost 11991.8515625
     Update 26 Cost 10861.6015625
     Update 27 Cost 12963.662109375
     Update 28 Cost 13060.9560546875
     Update 29 Cost 11043.951171875
     Update 30 Cost 11991.337890625

Train Data: 0.152976 0.457973622601
valid Data: 0.154358 0.427809526592
Test  Data: 0.182474 0.273359000718 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 5
     Update 31 Cost 11218.38671875
     Update 32 Cost 12046.8955078125
     Update 33 Cost 14763.69921875
     Update 34 Cost 12957.228515625
     Update 35 Cost 10518.8681640625
     Update 36 Cost 11284.5419921875

Train Data: 0.141897 0.592908830558
valid Data: 0.144567 0.556811890965
Test  Data: 0.205046 0.307764987923 

Save model
Saving ccc model
Epoch 6
     Update 37 Cost 9744.919921875
     Update 38 Cost 9817.7265625
     Update 39 Cost 13526.603515625
     Update 40 Cost 12795.1728515625
     Update 41 Cost 10247.4775390625
     Update 42 Cost 11382.6875

Train Data: 0.146425 0.57461411835
valid Data: 0.148727 0.537440995909
Test  Data: 0.222915 0.251185181842 

Epoch 7
     Update 43 Cost 10091.7685546875
     Update 44 Cost 9656.1708984375
     Update 45 Cost 10365.171875
     Update 46 Cost 9510.0556640625
     Update 47 Cost 9017.388671875
     Update 48 Cost 10029.705078125

Train Data: 0.129466 0.689984361291
valid Data: 0.136166 0.640067465403
Test  Data: 0.21586 0.31887758911 

Save model
Saving ccc model
Epoch 8
     Update 49 Cost 8754.4140625
     Update 50 Cost 9863.6220703125
     Update 51 Cost 11180.396484375
     Update 52 Cost 9938.150390625
     Update 53 Cost 9879.0703125
     Update 54 Cost 10891.005859375

Train Data: 0.143597 0.610074141269
valid Data: 0.146659 0.570839654759
Test  Data: 0.229219 0.257286794608 

Epoch 9
     Update 55 Cost 9481.0205078125
     Update 56 Cost 8890.576171875
     Update 57 Cost 9158.8115234375
     Update 58 Cost 8831.994140625
     Update 59 Cost 8477.2265625
     Update 60 Cost 8319.72265625

Train Data: 0.112877 0.795314421708
valid Data: 0.122815 0.746144010403
Test  Data: 0.206751 0.41242909513 

Save model
Saving ccc model
Epoch 10
     Update 61 Cost 7592.89599609375
     Update 62 Cost 6761.095703125
     Update 63 Cost 8430.4921875
     Update 64 Cost 8134.1953125
     Update 65 Cost 7761.1376953125
     Update 66 Cost 7710.5419921875

Train Data: 0.149253 0.656139324941
valid Data: 0.157656 0.61191762891
Test  Data: 0.178546 0.506767307307 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 11
     Update 67 Cost 10336.365234375
     Update 68 Cost 12330.5634765625
     Update 69 Cost 11232.9912109375
     Update 70 Cost 9261.8408203125
     Update 71 Cost 9104.40625
     Update 72 Cost 9179.6318359375

Train Data: 0.111589 0.777248522254
valid Data: 0.119671 0.732546215895
Test  Data: 0.184862 0.428261811626 

Epoch 12
     Update 73 Cost 7529.9775390625
     Update 74 Cost 6683.0654296875
     Update 75 Cost 8238.5234375
     Update 76 Cost 7460.400390625
     Update 77 Cost 7340.86328125
     Update 78 Cost 7505.2353515625

Train Data: 0.103473 0.833442000912
valid Data: 0.112297 0.794149337266
Test  Data: 0.183357 0.504943764843 

Epoch 13
     Update 79 Cost 6698.41162109375
     Update 80 Cost 7307.037109375
     Update 81 Cost 8897.12109375
     Update 82 Cost 9084.294921875
     Update 83 Cost 7766.4462890625
     Update 84 Cost 7444.92138671875

Train Data: 0.105362 0.820007998318
valid Data: 0.111508 0.78769025699
Test  Data: 0.186668 0.481130514539 

Epoch 14
     Update 85 Cost 6885.958984375
     Update 86 Cost 5914.529296875
     Update 87 Cost 7316.8017578125
     Update 88 Cost 6870.056640625
     Update 89 Cost 6992.970703125
     Update 90 Cost 7919.8466796875

Train Data: 0.125678 0.730233711413
valid Data: 0.130219 0.694241763341
Test  Data: 0.245781 0.28159768621 

Epoch 15
     Update 91 Cost 8310.8134765625
     Update 92 Cost 7401.7431640625
     Update 93 Cost 7754.57275390625
     Update 94 Cost 7583.9013671875
     Update 95 Cost 6714.802734375
     Update 96 Cost 6473.4814453125

Train Data: 0.0939656 0.867313067783
valid Data: 0.10053 0.840050120723
Test  Data: 0.196672 0.483601755679 

Epoch 16
     Update 97 Cost 5987.2958984375
     Update 98 Cost 5469.4013671875
     Update 99 Cost 6683.8408203125
     Update 100 Cost 6790.1484375
     Update 101 Cost 6332.73291015625
     Update 102 Cost 7664.4873046875

Train Data: 0.1292 0.709355310477
valid Data: 0.132029 0.678945416397
Test  Data: 0.265927 0.196014881323 

Epoch 17
     Update 103 Cost 8645.6357421875
     Update 104 Cost 8328.5673828125
     Update 105 Cost 7475.13037109375
     Update 106 Cost 7572.98681640625
     Update 107 Cost 6905.95654296875
     Update 108 Cost 6371.5185546875

Train Data: 0.0943233 0.85169491456
valid Data: 0.099728 0.824837663237
Test  Data: 0.217552 0.378158150204 

Epoch 18
     Update 109 Cost 6001.86083984375
     Update 110 Cost 5865.79541015625
     Update 111 Cost 6964.7587890625
     Update 112 Cost 6637.1875
     Update 113 Cost 5882.521484375
     Update 114 Cost 5530.0107421875

Train Data: 0.0873621 0.886814738072
valid Data: 0.092516 0.866289117947
Test  Data: 0.217767 0.414150108778 

Epoch 19
     Update 115 Cost 5616.6787109375
     Update 116 Cost 5494.4560546875
     Update 117 Cost 6378.9228515625
     Update 118 Cost 6549.70458984375
     Update 119 Cost 6074.41455078125
     Update 120 Cost 6870.4482421875

Train Data: 0.113999 0.762282097316
valid Data: 0.116554 0.736142020886
Test  Data: 0.232912 0.275271074746 

Epoch 20
     Update 121 Cost 7366.87060546875
     Update 122 Cost 5543.4609375
     Update 123 Cost 7021.99462890625
     Update 124 Cost 6955.4033203125
     Update 125 Cost 5359.5576171875
     Update 126 Cost 5033.5087890625

Train Data: 0.0779233 0.908866852164
valid Data: 0.084338 0.887326576389
Test  Data: 0.197101 0.469037658224 

Epoch 21
     Update 127 Cost 4957.55810546875
     Update 128 Cost 4802.45556640625
     Update 129 Cost 6104.4736328125
     Update 130 Cost 6387.212890625
     Update 131 Cost 5486.49951171875
     Update 132 Cost 5322.46923828125

Train Data: 0.0818815 0.900704476822
valid Data: 0.0883407 0.87840731124
Test  Data: 0.193317 0.455499106705 

Epoch 22
     Update 133 Cost 5368.91259765625
     Update 134 Cost 5761.431640625
     Update 135 Cost 6968.521484375
     Update 136 Cost 6489.466796875
     Update 137 Cost 6229.6171875
     Update 138 Cost 5342.2470703125

Train Data: 0.0799904 0.899998285353
valid Data: 0.0874126 0.875333778572
Test  Data: 0.202738 0.441382362263 

Epoch 23
     Update 139 Cost 5039.0380859375
     Update 140 Cost 4500.005859375
     Update 141 Cost 6019.748046875
     Update 142 Cost 5652.2275390625
     Update 143 Cost 5197.3994140625
     Update 144 Cost 5680.5322265625

Train Data: 0.0903491 0.895201576017
valid Data: 0.0981581 0.870945984217
Test  Data: 0.19571 0.514346086279 

Save model
Saving ccc model
Epoch 24
     Update 145 Cost 5794.0205078125
     Update 146 Cost 5642.09228515625
     Update 147 Cost 5694.05126953125
     Update 148 Cost 5542.638671875
     Update 149 Cost 4929.32568359375
     Update 150 Cost 4634.83837890625

Train Data: 0.0701583 0.919442047637
valid Data: 0.075626 0.901186472065
Test  Data: 0.19935 0.430066991903 

Epoch 25
     Update 151 Cost 4390.18603515625
     Update 152 Cost 4148.7353515625
     Update 153 Cost 5319.58056640625
     Update 154 Cost 5030.64111328125
     Update 155 Cost 4510.4306640625
     Update 156 Cost 4260.84521484375

Train Data: 0.069172 0.920671504483
valid Data: 0.0739042 0.904832915782
Test  Data: 0.189512 0.454194368168 

Epoch 26
     Update 157 Cost 4473.5595703125
     Update 158 Cost 4588.0048828125
     Update 159 Cost 6871.9033203125
     Update 160 Cost 6435.9765625
     Update 161 Cost 6073.5029296875
     Update 162 Cost 6394.3681640625

Train Data: 0.0829415 0.901710839762
valid Data: 0.0882226 0.883355836617
Test  Data: 0.186003 0.517441447 

Save model
Saving ccc model
Epoch 27
     Update 163 Cost 5337.5400390625
     Update 164 Cost 4846.9541015625
     Update 165 Cost 5245.287109375
     Update 166 Cost 4995.3583984375
     Update 167 Cost 4283.837890625
     Update 168 Cost 4307.36962890625

Train Data: 0.0697152 0.917651948929
valid Data: 0.0734014 0.903337634769
Test  Data: 0.210489 0.370831502875 

Epoch 28
     Update 169 Cost 4326.2783203125
     Update 170 Cost 3776.687744140625
     Update 171 Cost 4976.06640625
     Update 172 Cost 4733.27392578125
     Update 173 Cost 4238.994140625
     Update 174 Cost 4667.32763671875

Train Data: 0.0802718 0.904409227383
valid Data: 0.0846729 0.887782833276
Test  Data: 0.232683 0.371684822675 

Epoch 29
     Update 175 Cost 5376.44970703125
     Update 176 Cost 5560.71875
     Update 177 Cost 6360.9228515625
     Update 178 Cost 5860.7802734375
     Update 179 Cost 4573.75
     Update 180 Cost 4418.83203125

Train Data: 0.0762952 0.907086180943
valid Data: 0.0801677 0.891268694029
Test  Data: 0.219146 0.376838339562 

Epoch 30
     Update 181 Cost 4703.4921875
     Update 182 Cost 4072.900390625
     Update 183 Cost 5023.68017578125
     Update 184 Cost 4973.888671875
     Update 185 Cost 4345.39013671875
     Update 186 Cost 4688.38134765625

Train Data: 0.0962949 0.843940390928
valid Data: 0.100721 0.819592310038
Test  Data: 0.212844 0.392178194524 

Epoch 31
     Update 187 Cost 6092.14892578125
     Update 188 Cost 4763.3505859375
     Update 189 Cost 5576.0205078125
     Update 190 Cost 5688.859375
     Update 191 Cost 4651.91796875
     Update 192 Cost 4980.2314453125

Train Data: 0.0810084 0.889180573314
valid Data: 0.0857779 0.868887270377
Test  Data: 0.227761 0.329378457487 

Epoch 32
     Update 193 Cost 5055.2392578125
     Update 194 Cost 4155.845703125
     Update 195 Cost 5283.384765625
     Update 196 Cost 5374.99609375
     Update 197 Cost 4463.3984375
     Update 198 Cost 4490.4638671875

Train Data: 0.0819462 0.889662680214
valid Data: 0.0867411 0.868997303028
Test  Data: 0.224894 0.356950855286 

Epoch 33
     Update 199 Cost 5230.71923828125
     Update 200 Cost 4535.626953125
     Update 201 Cost 5053.47705078125
     Update 202 Cost 5067.7099609375
     Update 203 Cost 4335.5224609375
     Update 204 Cost 4332.759765625

Train Data: 0.0814794 0.908848767753
valid Data: 0.0878589 0.889702954025
Test  Data: 0.192034 0.505223858245 

Epoch 34
     Update 205 Cost 5120.4853515625
     Update 206 Cost 4775.880859375
     Update 207 Cost 5002.107421875
     Update 208 Cost 6752.564453125
     Update 209 Cost 5266.212890625
     Update 210 Cost 4697.560546875

Train Data: 0.0695283 0.929436996744
valid Data: 0.0753551 0.91309067909
Test  Data: 0.199435 0.458373826 

Epoch 35
     Update 211 Cost 4509.57568359375
     Update 212 Cost 4199.33203125
     Update 213 Cost 4745.625
     Update 214 Cost 4601.2314453125
     Update 215 Cost 4361.8251953125
     Update 216 Cost 4088.8974609375

Train Data: 0.066711 0.938651692709
valid Data: 0.0735759 0.921562642021
Test  Data: 0.204687 0.449349053079 

Epoch 36
     Update 217 Cost 4282.8134765625
     Update 218 Cost 3941.7236328125
     Update 219 Cost 4504.521484375
     Update 220 Cost 4638.8349609375
     Update 221 Cost 4368.0595703125
     Update 222 Cost 4553.30712890625

Train Data: 0.0702033 0.934759573065
valid Data: 0.0757703 0.920385523689
Test  Data: 0.226455 0.405183699148 

Early Stop!

The Best test rmse: 0.178546473384
The Best test ccc: 0.517441447
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.149253 0.656139324941
valid Data: 0.157656 0.61191762891
Test  Data: 0.178546 0.506767307307 


The src run for 37 epochs, with 160.239378 sec/epochs
Training took 5929s
Stage 1:  ((0.14925259, 0.65613932494062188), (0.15765552, 0.61191762891043389), (0.17854647, 0.50676730730655906))

Process finished with exit code 0

