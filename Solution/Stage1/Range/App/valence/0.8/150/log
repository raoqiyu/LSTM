/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.8_150_90.pkl
90 generated train examples : 90 6000
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'L1_penalty': None, 'saveFreq': 1110, 'patience': 10, 'dispFreq': 1, 'optimizer': <optimizer.ADADELTA object at 0x7f796a895a90>, 'reload_model': None, 'learning_rate': 1e-05, 'validFreq': -1, 'shuffle': False, 'valid_batch_size': 5, 'batch_size': 15, 'epochs': 2000, 'L2_penalty': None, 'saveto': 'Stage1/Range/App/valence/0.8/150/model/'}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.163246 -0.00889717367166
valid Data: 0.163816 -0.00446069534567
Test  Data: 0.14471 -0.0118041662292
Epoch 0
     Update 1 Cost 11576.29296875
     Update 2 Cost 13746.40625
     Update 3 Cost 11860.861328125
     Update 4 Cost 12983.96875
     Update 5 Cost 7554.935546875
     Update 6 Cost 8992.73046875

Train Data: 0.132849 0.0145714026306
valid Data: 0.133107 0.021787614371
Test  Data: 0.125494 -0.00539823450325 

Save model
Saving rmse model
Epoch 1
     Update 7 Cost 9468.3828125
     Update 8 Cost 8338.162109375
     Update 9 Cost 8666.2109375
     Update 10 Cost 9695.3857421875
     Update 11 Cost 7500.9111328125
     Update 12 Cost 9010.966796875

Train Data: 0.139963 0.0353442892932
valid Data: 0.140507 0.0382544547555
Test  Data: 0.12849 0.0119647639883 

Save model
Saving ccc model
Epoch 2
     Update 13 Cost 9736.8515625
     Update 14 Cost 9223.8037109375
     Update 15 Cost 9794.00390625
     Update 16 Cost 10882.017578125
     Update 17 Cost 7195.3701171875
     Update 18 Cost 9204.158203125

Train Data: 0.130165 0.0825180455055
valid Data: 0.130156 0.0924375238871
Test  Data: 0.129093 0.0293654798082 

Save model
Saving ccc model
Epoch 3
     Update 19 Cost 9497.033203125
     Update 20 Cost 8974.849609375
     Update 21 Cost 9909.876953125
     Update 22 Cost 9936.0107421875
     Update 23 Cost 10172.8359375
     Update 24 Cost 12651.068359375

Train Data: 0.130076 0.073224327137
valid Data: 0.130866 0.0719201132129
Test  Data: 0.13022 0.0308863776053 

Save model
Saving ccc model
Epoch 4
     Update 25 Cost 9508.224609375
     Update 26 Cost 8256.986328125
     Update 27 Cost 8997.09375
     Update 28 Cost 9181.65234375
     Update 29 Cost 8127.9267578125
     Update 30 Cost 10776.705078125

Train Data: 0.124072 0.246556700157
valid Data: 0.12557 0.235108188878
Test  Data: 0.128847 0.0900393267919 

Save model
Saving ccc model
Epoch 5
     Update 31 Cost 9068.640625
     Update 32 Cost 8019.75
     Update 33 Cost 8268.8515625
     Update 34 Cost 8473.19140625
     Update 35 Cost 7223.19580078125
     Update 36 Cost 9242.2841796875

Train Data: 0.124706 0.413478877432
valid Data: 0.12627 0.40012067026
Test  Data: 0.132844 0.236736187741 

Save model
Saving ccc model
Epoch 6
     Update 37 Cost 9559.232421875
     Update 38 Cost 9927.91796875
     Update 39 Cost 8458.59765625
     Update 40 Cost 8279.103515625
     Update 41 Cost 6808.333984375
     Update 42 Cost 8518.2158203125

Train Data: 0.109131 0.577881785196
valid Data: 0.110377 0.572975163239
Test  Data: 0.131684 0.362252967942 

Save model
Saving ccc model
Epoch 7
     Update 43 Cost 8063.74169921875
     Update 44 Cost 8848.875
     Update 45 Cost 7089.50927734375
     Update 46 Cost 6950.62109375
     Update 47 Cost 5492.736328125
     Update 48 Cost 6105.787109375

Train Data: 0.0895837 0.69406802413
valid Data: 0.0916111 0.684112863171
Test  Data: 0.122593 0.414391573213 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 8
     Update 49 Cost 6133.4169921875
     Update 50 Cost 7610.48046875
     Update 51 Cost 7885.279296875
     Update 52 Cost 8665.12109375
     Update 53 Cost 6069.92236328125
     Update 54 Cost 6503.390625

Train Data: 0.0881812 0.701290541564
valid Data: 0.089604 0.696622340883
Test  Data: 0.117994 0.428705646292 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 9
     Update 55 Cost 6186.69775390625
     Update 56 Cost 6307.8056640625
     Update 57 Cost 7286.1279296875
     Update 58 Cost 8270.1259765625
     Update 59 Cost 5937.087890625
     Update 60 Cost 6286.12158203125

Train Data: 0.0950915 0.67468623962
valid Data: 0.0966232 0.669544896322
Test  Data: 0.124539 0.417318940328 

Epoch 10
     Update 61 Cost 6809.71484375
     Update 62 Cost 10706.90234375
     Update 63 Cost 6527.521484375
     Update 64 Cost 6772.7060546875
     Update 65 Cost 5738.1416015625
     Update 66 Cost 7372.91357421875

Train Data: 0.108484 0.656381390121
valid Data: 0.111196 0.644078766019
Test  Data: 0.157103 0.3534391174 

Epoch 11
     Update 67 Cost 8104.6318359375
     Update 68 Cost 8356.6875
     Update 69 Cost 5920.7587890625
     Update 70 Cost 6028.091796875
     Update 71 Cost 4909.95751953125
     Update 72 Cost 5411.9794921875

Train Data: 0.0770401 0.781486900991
valid Data: 0.0800609 0.766189911599
Test  Data: 0.10903 0.513413260232 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 73 Cost 5257.9619140625
     Update 74 Cost 5319.904296875
     Update 75 Cost 6780.30859375
     Update 76 Cost 6720.1318359375
     Update 77 Cost 5236.48046875
     Update 78 Cost 5213.3310546875

Train Data: 0.0774826 0.774403636832
valid Data: 0.0804603 0.758551905523
Test  Data: 0.105662 0.532084890285 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 13
     Update 79 Cost 5342.11767578125
     Update 80 Cost 5141.20654296875
     Update 81 Cost 6386.26171875
     Update 82 Cost 6853.580078125
     Update 83 Cost 6496.8115234375
     Update 84 Cost 5728.6337890625

Train Data: 0.0843079 0.724184785664
valid Data: 0.085505 0.718654343086
Test  Data: 0.106384 0.502799659456 

Epoch 14
     Update 85 Cost 5780.19140625
     Update 86 Cost 7405.96337890625
     Update 87 Cost 8673.6708984375
     Update 88 Cost 6158.951171875
     Update 89 Cost 4720.3759765625
     Update 90 Cost 5052.11376953125

Train Data: 0.0744816 0.815646506549
valid Data: 0.0773671 0.803261850995
Test  Data: 0.124822 0.477443874197 

Epoch 15
     Update 91 Cost 5173.259765625
     Update 92 Cost 5394.33984375
     Update 93 Cost 6634.921875
     Update 94 Cost 7325.69921875
     Update 95 Cost 4893.5947265625
     Update 96 Cost 5239.80712890625

Train Data: 0.0759204 0.817572849132
valid Data: 0.0796569 0.802430376821
Test  Data: 0.130162 0.47070160725 

Epoch 16
     Update 97 Cost 5434.66162109375
     Update 98 Cost 5408.6611328125
     Update 99 Cost 5137.70458984375
     Update 100 Cost 5474.78125
     Update 101 Cost 4577.34375
     Update 102 Cost 4783.546875

Train Data: 0.070196 0.840135623701
valid Data: 0.0734272 0.827568349675
Test  Data: 0.125813 0.480537485862 

Epoch 17
     Update 103 Cost 4971.5859375
     Update 104 Cost 5221.3232421875
     Update 105 Cost 5443.0224609375
     Update 106 Cost 6212.9384765625
     Update 107 Cost 4562.7333984375
     Update 108 Cost 4933.3837890625

Train Data: 0.0716064 0.842492376227
valid Data: 0.0754767 0.827166416198
Test  Data: 0.126439 0.490180340726 

Epoch 18
     Update 109 Cost 5052.74267578125
     Update 110 Cost 5236.662109375
     Update 111 Cost 5044.5322265625
     Update 112 Cost 5468.5595703125
     Update 113 Cost 4320.0625
     Update 114 Cost 4394.955078125

Train Data: 0.066247 0.855576800018
valid Data: 0.0702148 0.839766074832
Test  Data: 0.12161 0.494468068375 

Epoch 19
     Update 115 Cost 4513.064453125
     Update 116 Cost 4492.0380859375
     Update 117 Cost 4492.89453125
     Update 118 Cost 4870.419921875
     Update 119 Cost 4070.692138671875
     Update 120 Cost 4119.78564453125

Train Data: 0.0609951 0.880438453859
valid Data: 0.0649974 0.865868177945
Test  Data: 0.121202 0.502811890864 

Epoch 20
     Update 121 Cost 4177.998046875
     Update 122 Cost 4314.74462890625
     Update 123 Cost 5039.25146484375
     Update 124 Cost 5865.19091796875
     Update 125 Cost 4409.49951171875
     Update 126 Cost 4297.60302734375

Train Data: 0.063133 0.876511585662
valid Data: 0.0680041 0.85902224007
Test  Data: 0.127145 0.503411057171 

Epoch 21
     Update 127 Cost 4308.04248046875
     Update 128 Cost 4542.8935546875
     Update 129 Cost 4527.3720703125
     Update 130 Cost 4767.287109375
     Update 131 Cost 3994.17626953125
     Update 132 Cost 4007.7841796875

Train Data: 0.0603911 0.880924279364
valid Data: 0.0648725 0.864204792706
Test  Data: 0.120181 0.507583253239 

Epoch 22
     Update 133 Cost 4144.83544921875
     Update 134 Cost 4049.55322265625
     Update 135 Cost 4712.46875
     Update 136 Cost 5213.1796875
     Update 137 Cost 4136.40625
     Update 138 Cost 3897.95654296875

Train Data: 0.0587931 0.894924247867
valid Data: 0.0632958 0.87970479035
Test  Data: 0.122832 0.522616243783 

Epoch 23
     Update 139 Cost 4127.3828125
     Update 140 Cost 4450.0283203125
     Update 141 Cost 4667.990234375
     Update 142 Cost 4807.6796875
     Update 143 Cost 3754.80322265625
     Update 144 Cost 3557.191650390625

Train Data: 0.0535489 0.908783505589
valid Data: 0.0582229 0.893473446366
Test  Data: 0.116657 0.532828211434 

Save model
Saving ccc model
Epoch 24
     Update 145 Cost 3603.005859375
     Update 146 Cost 3434.552490234375
     Update 147 Cost 3860.87109375
     Update 148 Cost 4344.056640625
     Update 149 Cost 3571.71923828125
     Update 150 Cost 3555.724609375

Train Data: 0.0676351 0.865100896965
valid Data: 0.0723574 0.846864103245
Test  Data: 0.132297 0.46226780721 

Epoch 25
     Update 151 Cost 4794.6533203125
     Update 152 Cost 6119.9521484375
     Update 153 Cost 4797.12158203125
     Update 154 Cost 5460.921875
     Update 155 Cost 4426.220703125
     Update 156 Cost 4668.7060546875

Train Data: 0.0659214 0.868041521008
valid Data: 0.0705146 0.851008649749
Test  Data: 0.12901 0.472317471207 

Epoch 26
     Update 157 Cost 4611.822265625
     Update 158 Cost 5141.63525390625
     Update 159 Cost 3985.542236328125
     Update 160 Cost 4062.502685546875
     Update 161 Cost 3471.921142578125
     Update 162 Cost 3689.658203125

Train Data: 0.0537007 0.913303190625
valid Data: 0.0586579 0.897915048645
Test  Data: 0.120868 0.529564532522 

Epoch 27
     Update 163 Cost 3655.529541015625
     Update 164 Cost 3396.662353515625
     Update 165 Cost 3806.76708984375
     Update 166 Cost 4147.68115234375
     Update 167 Cost 4072.37548828125
     Update 168 Cost 3874.5078125

Train Data: 0.0567963 0.904607329669
valid Data: 0.0618328 0.888201416457
Test  Data: 0.123079 0.528727623304 

Epoch 28
     Update 169 Cost 3973.6123046875
     Update 170 Cost 4205.8154296875
     Update 171 Cost 4241.50927734375
     Update 172 Cost 4271.76318359375
     Update 173 Cost 3886.966552734375
     Update 174 Cost 3496.4580078125

Train Data: 0.053707 0.917728931512
valid Data: 0.0590187 0.901404824534
Test  Data: 0.125951 0.528945691259 

Epoch 29
     Update 175 Cost 3673.03564453125
     Update 176 Cost 4640.27392578125
     Update 177 Cost 4075.36767578125
     Update 178 Cost 4799.1689453125
     Update 179 Cost 4292.392578125
     Update 180 Cost 3843.44580078125

Train Data: 0.0523279 0.91492828764
valid Data: 0.0557243 0.904319671008
Test  Data: 0.115592 0.548041658456 

Save model
Saving ccc model
Epoch 30
     Update 181 Cost 3601.941162109375
     Update 182 Cost 3654.21533203125
     Update 183 Cost 5609.62158203125
     Update 184 Cost 4713.03759765625
     Update 185 Cost 4476.1162109375
     Update 186 Cost 4135.1318359375

Train Data: 0.0602567 0.875736598987
valid Data: 0.0620071 0.869653292653
Test  Data: 0.109633 0.550179580954 

Save model
Saving ccc model
Epoch 31
     Update 187 Cost 4346.498046875
     Update 188 Cost 4695.48046875
     Update 189 Cost 6066.45458984375
     Update 190 Cost 4077.74853515625
     Update 191 Cost 3457.500732421875
     Update 192 Cost 3057.487548828125

Train Data: 0.0467507 0.931774560694
valid Data: 0.0504028 0.921841492625
Test  Data: 0.118653 0.537698814617 

Epoch 32
     Update 193 Cost 3177.108154296875
     Update 194 Cost 2873.307373046875
     Update 195 Cost 3401.285888671875
     Update 196 Cost 3880.9638671875
     Update 197 Cost 4030.21923828125
     Update 198 Cost 4153.3017578125

Train Data: 0.0811036 0.830078871873
valid Data: 0.0845939 0.817596219936
Test  Data: 0.155769 0.403726690245 

Epoch 33
     Update 199 Cost 6332.1474609375
     Update 200 Cost 6450.39599609375
     Update 201 Cost 4160.365234375
     Update 202 Cost 4172.94921875
     Update 203 Cost 3579.17333984375
     Update 204 Cost 3097.8603515625

Train Data: 0.0500519 0.929744089619
valid Data: 0.0550292 0.916073296132
Test  Data: 0.129371 0.512227157596 

Epoch 34
     Update 205 Cost 3462.217041015625
     Update 206 Cost 3887.1103515625
     Update 207 Cost 3819.20068359375
     Update 208 Cost 3974.77734375
     Update 209 Cost 3418.698974609375
     Update 210 Cost 2987.12744140625

Train Data: 0.0473673 0.936345834106
valid Data: 0.0520012 0.923721731477
Test  Data: 0.126654 0.510990234083 

Epoch 35
     Update 211 Cost 3253.7783203125
     Update 212 Cost 3508.121337890625
     Update 213 Cost 3987.48583984375
     Update 214 Cost 4142.208984375
     Update 215 Cost 3262.685546875
     Update 216 Cost 2789.20703125

Train Data: 0.0460385 0.939228600743
valid Data: 0.0509768 0.925583713881
Test  Data: 0.122023 0.528386317728 

Epoch 36
     Update 217 Cost 3171.6591796875
     Update 218 Cost 2877.96484375
     Update 219 Cost 3303.26318359375
     Update 220 Cost 3535.16455078125
     Update 221 Cost 3096.69384765625
     Update 222 Cost 3277.388671875

Train Data: 0.0470572 0.933278481787
valid Data: 0.0503437 0.923692156958
Test  Data: 0.119453 0.511326824604 

Epoch 37
     Update 223 Cost 3095.109375
     Update 224 Cost 3026.33056640625
     Update 225 Cost 3670.69482421875
     Update 226 Cost 4349.806640625
     Update 227 Cost 3964.90087890625
     Update 228 Cost 3600.72900390625

Train Data: 0.0481156 0.932277631541
valid Data: 0.051569 0.922602701692
Test  Data: 0.12037 0.539526830109 

Epoch 38
     Update 229 Cost 3293.35546875
     Update 230 Cost 3216.36767578125
     Update 231 Cost 4240.1796875
     Update 232 Cost 3890.2734375
     Update 233 Cost 3351.4384765625
     Update 234 Cost 3182.88330078125

Train Data: 0.0497314 0.920855022275
valid Data: 0.0532999 0.909861594023
Test  Data: 0.114815 0.523948603728 

Epoch 39
     Update 235 Cost 3372.778076171875
     Update 236 Cost 3980.082275390625
     Update 237 Cost 5163.70703125
     Update 238 Cost 3542.55859375
     Update 239 Cost 3195.2744140625
     Update 240 Cost 2807.519287109375

Train Data: 0.0439689 0.944149972829
valid Data: 0.0482678 0.933432300051
Test  Data: 0.12321 0.524041430446 

Epoch 40
     Update 241 Cost 2907.154296875
     Update 242 Cost 2897.834716796875
     Update 243 Cost 3137.3525390625
     Update 244 Cost 3434.35693359375
     Update 245 Cost 3194.06884765625
     Update 246 Cost 2682.816162109375

Train Data: 0.0457108 0.94402021498
valid Data: 0.0491497 0.935953659262
Test  Data: 0.130138 0.504521343612 

Early Stop!

The Best test rmse: 0.105661541224
The Best test ccc: 0.550179580954
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0774826 0.774403636832
valid Data: 0.0804603 0.758551905523
Test  Data: 0.105662 0.532084890285 


The src run for 41 epochs, with 164.038571 sec/epochs
Training took 6726s
Stage 1:  ((0.077482574, 0.77440363683204827), (0.080460258, 0.75855190552252472), (0.10566154, 0.5320848902854951))

Process finished with exit code 0

