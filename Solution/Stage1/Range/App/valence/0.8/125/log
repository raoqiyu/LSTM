/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.8_125_108.pkl
108 generated train examples : 108 6000
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'dispFreq': 1, 'validFreq': -1, 'reload_model': None, 'batch_size': 15, 'L1_penalty': None, 'optimizer': <optimizer.ADADELTA object at 0x7f3041bc1518>, 'saveFreq': 1110, 'valid_batch_size': 5, 'shuffle': False, 'patience': 10, 'L2_penalty': None, 'epochs': 2000, 'learning_rate': 1e-05, 'saveto': 'Stage1/Range/App/valence/0.8/125/model/'}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.163251 -0.00901985064001
valid Data: 0.163816 -0.00446069534567
Test  Data: 0.14471 -0.0118041662292
Epoch 0
     Update 1 Cost 10146.2587890625
     Update 2 Cost 14912.2080078125
     Update 3 Cost 15153.6650390625
     Update 4 Cost 13722.08984375
     Update 5 Cost 10610.708984375
     Update 6 Cost 10421.7548828125
     Update 7 Cost 12705.80859375
     Update 8 Cost 2151.80859375

Train Data: 0.146154 -0.021209624073
valid Data: 0.146343 -0.0125567900238
Test  Data: 0.150092 -0.00184437807625 

Save model
Saving rmse model
Epoch 1
     Update 9 Cost 11909.08203125
     Update 10 Cost 10186.228515625
     Update 11 Cost 10456.169921875
     Update 12 Cost 9442.830078125
     Update 13 Cost 8926.7412109375
     Update 14 Cost 7793.740234375
     Update 15 Cost 8408.5283203125
     Update 16 Cost 1808.5968017578125

Train Data: 0.131073 0.0376148103068
valid Data: 0.13152 0.0420320023104
Test  Data: 0.130281 0.00574570222742 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 2
     Update 17 Cost 9941.9912109375
     Update 18 Cost 9066.9111328125
     Update 19 Cost 9972.8447265625
     Update 20 Cost 9503.6328125
     Update 21 Cost 8578.9765625
     Update 22 Cost 7378.458984375
     Update 23 Cost 8291.533203125
     Update 24 Cost 1769.401611328125

Train Data: 0.128991 0.093944662293
valid Data: 0.130013 0.0948453652153
Test  Data: 0.130604 0.0277160764101 

Save model
Saving ccc model
Epoch 3
     Update 25 Cost 9816.5625
     Update 26 Cost 8834.8935546875
     Update 27 Cost 9761.5283203125
     Update 28 Cost 8567.353515625
     Update 29 Cost 8148.5419921875
     Update 30 Cost 7388.9755859375
     Update 31 Cost 8717.77734375
     Update 32 Cost 1677.086181640625

Train Data: 0.123182 0.189605828031
valid Data: 0.12504 0.17515722066
Test  Data: 0.125705 0.0921960656348 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 33 Cost 9076.828125
     Update 34 Cost 8144.759765625
     Update 35 Cost 10502.8955078125
     Update 36 Cost 8182.9951171875
     Update 37 Cost 7532.97265625
     Update 38 Cost 6796.859375
     Update 39 Cost 8225.7578125
     Update 40 Cost 2505.0126953125

Train Data: 0.126155 0.230160596254
valid Data: 0.127791 0.215672886366
Test  Data: 0.122697 0.141078602231 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 5
     Update 41 Cost 7830.8359375
     Update 42 Cost 6982.0927734375
     Update 43 Cost 9236.20703125
     Update 44 Cost 12918.447265625
     Update 45 Cost 9837.986328125
     Update 46 Cost 7387.66064453125
     Update 47 Cost 8166.92041015625
     Update 48 Cost 1664.03173828125

Train Data: 0.117594 0.246326099432
valid Data: 0.118943 0.23677120518
Test  Data: 0.121558 0.107034868809 

Save model
Saving rmse model
Epoch 6
     Update 49 Cost 8680.2451171875
     Update 50 Cost 8717.58984375
     Update 51 Cost 8528.6875
     Update 52 Cost 7850.8486328125
     Update 53 Cost 11041.837890625
     Update 54 Cost 11894.49609375
     Update 55 Cost 10604.169921875
     Update 56 Cost 1516.345947265625

Train Data: 0.110403 0.379711416513
valid Data: 0.11116 0.375587766362
Test  Data: 0.12 0.172182310389 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 7
     Update 57 Cost 7949.748046875
     Update 58 Cost 7458.24755859375
     Update 59 Cost 8616.853515625
     Update 60 Cost 6984.7939453125
     Update 61 Cost 6286.20654296875
     Update 62 Cost 5927.0888671875
     Update 63 Cost 6334.22802734375
     Update 64 Cost 1532.226318359375

Train Data: 0.0932104 0.634494884712
valid Data: 0.0965066 0.608787177351
Test  Data: 0.118259 0.295189619898 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 8
     Update 65 Cost 5990.6650390625
     Update 66 Cost 5708.9169921875
     Update 67 Cost 6313.06005859375
     Update 68 Cost 5888.263671875
     Update 69 Cost 7413.4365234375
     Update 70 Cost 7279.07666015625
     Update 71 Cost 9211.2451171875
     Update 72 Cost 1229.216064453125

Train Data: 0.092373 0.628375653281
valid Data: 0.0948537 0.613083680254
Test  Data: 0.115296 0.329848789346 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 9
     Update 73 Cost 6809.423828125
     Update 74 Cost 5764.2802734375
     Update 75 Cost 6453.45751953125
     Update 76 Cost 6484.39599609375
     Update 77 Cost 5576.2109375
     Update 78 Cost 5095.26171875
     Update 79 Cost 5752.6083984375
     Update 80 Cost 1394.1678466796875

Train Data: 0.0884202 0.695815633984
valid Data: 0.0919282 0.67192675769
Test  Data: 0.117797 0.332994903437 

Save model
Saving ccc model
Epoch 10
     Update 81 Cost 5652.271484375
     Update 82 Cost 5066.9990234375
     Update 83 Cost 5923.64111328125
     Update 84 Cost 6875.69775390625
     Update 85 Cost 7379.197265625
     Update 86 Cost 5242.2158203125
     Update 87 Cost 5786.0791015625
     Update 88 Cost 1128.08544921875

Train Data: 0.0759166 0.786292089476
valid Data: 0.0799986 0.765332514532
Test  Data: 0.117454 0.413181719977 

Save model
Saving ccc model
Epoch 11
     Update 89 Cost 5372.22412109375
     Update 90 Cost 5323.86328125
     Update 91 Cost 6416.85498046875
     Update 92 Cost 6168.84033203125
     Update 93 Cost 5278.5
     Update 94 Cost 4589.10595703125
     Update 95 Cost 4913.419921875
     Update 96 Cost 1060.3212890625

Train Data: 0.0702752 0.816591770143
valid Data: 0.0747177 0.793002654065
Test  Data: 0.113327 0.412232237512 

Save model
Saving rmse model
Epoch 12
     Update 97 Cost 4719.16357421875
     Update 98 Cost 4236.3203125
     Update 99 Cost 4838.3525390625
     Update 100 Cost 4598.7490234375
     Update 101 Cost 4793.83349609375
     Update 102 Cost 6219.935546875
     Update 103 Cost 8712.681640625
     Update 104 Cost 1050.6595458984375

Train Data: 0.0776559 0.758763465642
valid Data: 0.0810192 0.740453763516
Test  Data: 0.113018 0.369678539892 

Save model
Saving rmse model
Epoch 13
     Update 105 Cost 5380.6748046875
     Update 106 Cost 4732.5810546875
     Update 107 Cost 5476.37744140625
     Update 108 Cost 5036.8232421875
     Update 109 Cost 4848.4580078125
     Update 110 Cost 5291.9677734375
     Update 111 Cost 5006.31298828125
     Update 112 Cost 1043.343017578125

Train Data: 0.0709839 0.818409140767
valid Data: 0.0746693 0.801408124054
Test  Data: 0.116966 0.424816153621 

Save model
Saving ccc model
Epoch 14
     Update 113 Cost 4764.72900390625
     Update 114 Cost 4331.6494140625
     Update 115 Cost 4914.548828125
     Update 116 Cost 5055.74853515625
     Update 117 Cost 5481.140625
     Update 118 Cost 6165.95458984375
     Update 119 Cost 4810.9287109375
     Update 120 Cost 994.838134765625

Train Data: 0.069516 0.824969450209
valid Data: 0.0727061 0.810335643573
Test  Data: 0.114372 0.417657184754 

Epoch 15
     Update 121 Cost 4533.66650390625
     Update 122 Cost 4179.30615234375
     Update 123 Cost 4939.86474609375
     Update 124 Cost 5780.52880859375
     Update 125 Cost 6190.3896484375
     Update 126 Cost 5104.3046875
     Update 127 Cost 4807.88623046875
     Update 128 Cost 939.3073120117188

Train Data: 0.0664176 0.852926615491
valid Data: 0.0703678 0.836931863394
Test  Data: 0.120481 0.438053403134 

Save model
Saving ccc model
Epoch 16
     Update 129 Cost 4558.23291015625
     Update 130 Cost 4190.0712890625
     Update 131 Cost 5015.12353515625
     Update 132 Cost 5087.51025390625
     Update 133 Cost 4246.90478515625
     Update 134 Cost 4324.12890625
     Update 135 Cost 4429.1884765625
     Update 136 Cost 1032.02685546875

Train Data: 0.0654743 0.847661432252
valid Data: 0.0699437 0.827095158812
Test  Data: 0.115331 0.388366886932 

Epoch 17
     Update 137 Cost 4305.31640625
     Update 138 Cost 4123.6318359375
     Update 139 Cost 5236.10791015625
     Update 140 Cost 5529.04541015625
     Update 141 Cost 5259.140625
     Update 142 Cost 4458.9052734375
     Update 143 Cost 5428.49560546875
     Update 144 Cost 883.0458984375

Train Data: 0.0623178 0.870587193729
valid Data: 0.0662461 0.854189117678
Test  Data: 0.121432 0.427111122901 

Epoch 18
     Update 145 Cost 4228.15234375
     Update 146 Cost 4015.94482421875
     Update 147 Cost 4858.7568359375
     Update 148 Cost 4431.7568359375
     Update 149 Cost 3956.361328125
     Update 150 Cost 4216.228515625
     Update 151 Cost 4363.6015625
     Update 152 Cost 956.401611328125

Train Data: 0.0618033 0.865962088373
valid Data: 0.06635 0.846535821614
Test  Data: 0.115531 0.403846971779 

Epoch 19
     Update 153 Cost 4040.89990234375
     Update 154 Cost 3925.761962890625
     Update 155 Cost 4633.693359375
     Update 156 Cost 4978.0869140625
     Update 157 Cost 6276.8134765625
     Update 158 Cost 4354.21142578125
     Update 159 Cost 4873.876953125
     Update 160 Cost 922.755615234375

Train Data: 0.0648941 0.856224983485
valid Data: 0.0683721 0.842034355137
Test  Data: 0.12149 0.397171159751 

Epoch 20
     Update 161 Cost 4461.2080078125
     Update 162 Cost 3941.5009765625
     Update 163 Cost 4459.25634765625
     Update 164 Cost 4599.3447265625
     Update 165 Cost 4105.91845703125
     Update 166 Cost 4151.41015625
     Update 167 Cost 4281.5244140625
     Update 168 Cost 900.2052001953125

Train Data: 0.060618 0.87233289527
valid Data: 0.0653007 0.852496746938
Test  Data: 0.117479 0.379771020789 

Epoch 21
     Update 169 Cost 3918.72265625
     Update 170 Cost 3609.404296875
     Update 171 Cost 4448.89013671875
     Update 172 Cost 4780.3994140625
     Update 173 Cost 4331.7041015625
     Update 174 Cost 3863.79833984375
     Update 175 Cost 4118.701171875
     Update 176 Cost 816.16943359375

Train Data: 0.057368 0.896304178644
valid Data: 0.0621206 0.878533739481
Test  Data: 0.125062 0.420868872544 

Epoch 22
     Update 177 Cost 3767.296875
     Update 178 Cost 4173.453125
     Update 179 Cost 4152.86669921875
     Update 180 Cost 4050.29833984375
     Update 181 Cost 4008.71484375
     Update 182 Cost 3760.62255859375
     Update 183 Cost 4575.9541015625
     Update 184 Cost 917.875

Train Data: 0.0612118 0.880951643655
valid Data: 0.0652314 0.867019403107
Test  Data: 0.125365 0.435373472073 

Epoch 23
     Update 185 Cost 4021.12158203125
     Update 186 Cost 3720.72119140625
     Update 187 Cost 4605.2958984375
     Update 188 Cost 5149.9697265625
     Update 189 Cost 3885.906494140625
     Update 190 Cost 4168.765625
     Update 191 Cost 4421.67236328125
     Update 192 Cost 1021.4179077148438

Train Data: 0.0657152 0.850239512283
valid Data: 0.070146 0.830213955872
Test  Data: 0.118635 0.376743603037 

Epoch 24
     Update 193 Cost 4244.615234375
     Update 194 Cost 3567.351806640625
     Update 195 Cost 4248.83203125
     Update 196 Cost 4640.337890625
     Update 197 Cost 4568.86181640625
     Update 198 Cost 3876.859130859375
     Update 199 Cost 4493.671875
     Update 200 Cost 896.54736328125

Train Data: 0.0643644 0.862627772705
valid Data: 0.067961 0.847807093518
Test  Data: 0.120603 0.435134224348 

Epoch 25
     Update 201 Cost 4324.32861328125
     Update 202 Cost 4736.3623046875
     Update 203 Cost 4633.935546875
     Update 204 Cost 4609.041015625
     Update 205 Cost 3659.047607421875
     Update 206 Cost 3449.270263671875
     Update 207 Cost 3749.318603515625
     Update 208 Cost 671.0421142578125

Train Data: 0.0529228 0.905783759168
valid Data: 0.0570346 0.891194376943
Test  Data: 0.110822 0.456517122714 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 26
     Update 209 Cost 3484.84375
     Update 210 Cost 3356.390869140625
     Update 211 Cost 3672.338623046875
     Update 212 Cost 3376.83642578125
     Update 213 Cost 3130.77685546875
     Update 214 Cost 2942.58154296875
     Update 215 Cost 3556.380859375
     Update 216 Cost 718.269775390625

Train Data: 0.0513141 0.917694268986
valid Data: 0.0555254 0.904172967741
Test  Data: 0.119337 0.464439083103 

Save model
Saving ccc model
Epoch 27
     Update 217 Cost 3414.8291015625
     Update 218 Cost 3161.552734375
     Update 219 Cost 4047.235595703125
     Update 220 Cost 4569.94482421875
     Update 221 Cost 3140.21875
     Update 222 Cost 3056.27880859375
     Update 223 Cost 3355.279296875
     Update 224 Cost 784.3233032226562

Train Data: 0.0523821 0.907427558344
valid Data: 0.0574313 0.889272018024
Test  Data: 0.112674 0.419056724816 

Epoch 28
     Update 225 Cost 3367.44482421875
     Update 226 Cost 3121.171875
     Update 227 Cost 4164.56689453125
     Update 228 Cost 4221.84375
     Update 229 Cost 4175.4091796875
     Update 230 Cost 3886.302001953125
     Update 231 Cost 3898.37841796875
     Update 232 Cost 782.8983154296875

Train Data: 0.0527055 0.912638205213
valid Data: 0.0563299 0.900423994055
Test  Data: 0.118564 0.448351846842 

Epoch 29
     Update 233 Cost 3454.99462890625
     Update 234 Cost 2984.485107421875
     Update 235 Cost 3448.124755859375
     Update 236 Cost 3442.08935546875
     Update 237 Cost 3315.99658203125
     Update 238 Cost 3362.2392578125
     Update 239 Cost 3691.82421875
     Update 240 Cost 942.7304077148438

Train Data: 0.0643228 0.856524470879
valid Data: 0.0687609 0.837618033985
Test  Data: 0.117288 0.341304460335 

Epoch 30
     Update 241 Cost 3925.57275390625
     Update 242 Cost 3036.7060546875
     Update 243 Cost 3791.5654296875
     Update 244 Cost 3917.655517578125
     Update 245 Cost 3936.875
     Update 246 Cost 3418.202880859375
     Update 247 Cost 3533.53271484375
     Update 248 Cost 683.7105712890625

Train Data: 0.0490513 0.926411399935
valid Data: 0.0524112 0.916427173349
Test  Data: 0.117897 0.479472829948 

Save model
Saving ccc model
Epoch 31
     Update 249 Cost 3261.78076171875
     Update 250 Cost 2867.707763671875
     Update 251 Cost 3288.6787109375
     Update 252 Cost 3217.88623046875
     Update 253 Cost 3132.466796875
     Update 254 Cost 3386.68017578125
     Update 255 Cost 3080.744384765625
     Update 256 Cost 665.8109130859375

Train Data: 0.0470623 0.930757577577
valid Data: 0.0524826 0.91423083569
Test  Data: 0.115006 0.460670083379 

Epoch 32
     Update 257 Cost 3010.6962890625
     Update 258 Cost 2790.38525390625
     Update 259 Cost 3838.985107421875
     Update 260 Cost 4412.9423828125
     Update 261 Cost 4265.3330078125
     Update 262 Cost 3356.89111328125
     Update 263 Cost 3753.246826171875
     Update 264 Cost 709.8834228515625

Train Data: 0.0485256 0.927736352057
valid Data: 0.0526421 0.915686654862
Test  Data: 0.122493 0.453486801013 

Epoch 33
     Update 265 Cost 3165.732421875
     Update 266 Cost 2696.043212890625
     Update 267 Cost 3081.35400390625
     Update 268 Cost 3151.60693359375
     Update 269 Cost 2929.6572265625
     Update 270 Cost 2804.466796875
     Update 271 Cost 3323.613525390625
     Update 272 Cost 715.6119384765625

Train Data: 0.0544214 0.903338249757
valid Data: 0.0579453 0.89048578411
Test  Data: 0.117561 0.433714037289 

Epoch 34
     Update 273 Cost 3826.5341796875
     Update 274 Cost 3156.128173828125
     Update 275 Cost 3663.453857421875
     Update 276 Cost 3606.493408203125
     Update 277 Cost 3395.2177734375
     Update 278 Cost 3052.29638671875
     Update 279 Cost 3531.904541015625
     Update 280 Cost 707.7843017578125

Train Data: 0.046705 0.931438090261
valid Data: 0.0509496 0.918607609381
Test  Data: 0.119657 0.4464999638 

Epoch 35
     Update 281 Cost 3128.443359375
     Update 282 Cost 3469.71337890625
     Update 283 Cost 3456.619140625
     Update 284 Cost 3445.29736328125
     Update 285 Cost 3303.648681640625
     Update 286 Cost 3285.05126953125
     Update 287 Cost 3706.143798828125
     Update 288 Cost 754.9585571289062

Train Data: 0.0492842 0.920472943816
valid Data: 0.0552656 0.899864133117
Test  Data: 0.111673 0.448192511722 

Epoch 36
     Update 289 Cost 3222.080078125
     Update 290 Cost 2800.11474609375
     Update 291 Cost 3687.9345703125
     Update 292 Cost 4393.7099609375
     Update 293 Cost 4397.1416015625
     Update 294 Cost 3424.349609375
     Update 295 Cost 3500.81298828125
     Update 296 Cost 623.4846801757812

Train Data: 0.0461145 0.935530860208
valid Data: 0.0505811 0.922707269801
Test  Data: 0.119006 0.477153081434 

Epoch 37
     Update 297 Cost 3027.05517578125
     Update 298 Cost 2735.720947265625
     Update 299 Cost 2977.71630859375
     Update 300 Cost 2863.263671875
     Update 301 Cost 2943.05419921875
     Update 302 Cost 2950.134033203125
     Update 303 Cost 3135.70703125
     Update 304 Cost 720.574462890625

Train Data: 0.0464452 0.930457406964
valid Data: 0.0519907 0.912489775706
Test  Data: 0.11234 0.443257655143 

Epoch 38
     Update 305 Cost 3011.491455078125
     Update 306 Cost 2692.55615234375
     Update 307 Cost 3450.52490234375
     Update 308 Cost 3706.5517578125
     Update 309 Cost 3547.750244140625
     Update 310 Cost 2868.544921875
     Update 311 Cost 3267.310302734375
     Update 312 Cost 643.7147216796875

Train Data: 0.0424495 0.9446310875
valid Data: 0.0471122 0.931935912934
Test  Data: 0.116773 0.447942937196 

Epoch 39
     Update 313 Cost 2784.14892578125
     Update 314 Cost 2565.411376953125
     Update 315 Cost 3068.558349609375
     Update 316 Cost 2845.07568359375
     Update 317 Cost 2822.70361328125
     Update 318 Cost 2952.775390625
     Update 319 Cost 3231.35302734375
     Update 320 Cost 678.4468994140625

Train Data: 0.0438385 0.939587738955
valid Data: 0.0503155 0.919962198212
Test  Data: 0.11257 0.430444574957 

Epoch 40
     Update 321 Cost 2786.69921875
     Update 322 Cost 2499.24072265625
     Update 323 Cost 3480.5849609375
     Update 324 Cost 3881.164794921875
     Update 325 Cost 3152.94384765625
     Update 326 Cost 2530.78515625
     Update 327 Cost 2896.09619140625
     Update 328 Cost 642.8338623046875

Train Data: 0.0421533 0.946549442963
valid Data: 0.0474626 0.932027868743
Test  Data: 0.11909 0.458994098303 

Early Stop!

The Best test rmse: 0.11082162708
The Best test ccc: 0.479472829948
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0529228 0.905783759168
valid Data: 0.0570346 0.891194376943
Test  Data: 0.110822 0.456517122714 


The src run for 41 epochs, with 212.026371 sec/epochs
Training took 8693s
Stage 1:  ((0.052922763, 0.90578375916796483), (0.057034634, 0.89119437694308379), (0.11082163, 0.45651712271403355))

Process finished with exit code 0

