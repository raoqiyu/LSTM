/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.9_150_45.pkl
45 generated train examples : 45 6750
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'validFreq': -1, 'optimizer': <optimizer.ADADELTA object at 0x7f32df4b5898>, 'valid_batch_size': 5, 'L1_penalty': None, 'L2_penalty': None, 'learning_rate': 1e-05, 'reload_model': None, 'patience': 10, 'dispFreq': 1, 'saveFreq': 1110, 'batch_size': 15, 'epochs': 2000, 'shuffle': False, 'saveto': 'Stage1/Range/App/valence/0.9/150/model/'}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.163696 -0.00811107569193
valid Data: 0.163816 -0.00446069534567
Test  Data: 0.14471 -0.0118041662292
Epoch 0
     Update 1 Cost 12717.419921875
     Update 2 Cost 17892.03515625
     Update 3 Cost 15678.51171875

Train Data: 0.156702 0.0279650756443
valid Data: 0.157677 0.0278600366279
Test  Data: 0.166572 0.00556633699915 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 4 Cost 13095.4228515625
     Update 5 Cost 9252.337890625
     Update 6 Cost 11843.498046875

Train Data: 0.146091 0.00637394637116
valid Data: 0.14679 0.00147976428924
Test  Data: 0.131366 -0.00156672483549 

Save model
Saving rmse model
Epoch 2
     Update 7 Cost 11277.662109375
     Update 8 Cost 10205.2314453125
     Update 9 Cost 14469.33984375

Train Data: 0.160524 -0.00746233911446
valid Data: 0.161076 -0.00290131348559
Test  Data: 0.175658 -0.00531480570285 

Epoch 3
     Update 10 Cost 13578.384765625
     Update 11 Cost 8734.44140625
     Update 12 Cost 11471.4970703125

Train Data: 0.132024 0.0410148658918
valid Data: 0.133421 0.0279434892118
Test  Data: 0.132043 0.00146178467098 

Epoch 4
     Update 13 Cost 10697.02734375
     Update 14 Cost 8735.353515625
     Update 15 Cost 11247.4326171875

Train Data: 0.135559 0.0666699481086
valid Data: 0.136206 0.0688420182076
Test  Data: 0.14213 0.00712664753514 

Save model
Saving ccc model
Epoch 5
     Update 16 Cost 11171.736328125
     Update 17 Cost 8539.44921875
     Update 18 Cost 10459.0341796875

Train Data: 0.124064 0.157722407579
valid Data: 0.125009 0.15098493564
Test  Data: 0.120554 0.0927166557933 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 6
     Update 19 Cost 9784.650390625
     Update 20 Cost 8152.1171875
     Update 21 Cost 11721.431640625

Train Data: 0.167723 0.097989538371
valid Data: 0.170583 0.0852709344211
Test  Data: 0.175007 0.059018175723 

Epoch 7
     Update 22 Cost 13993.46484375
     Update 23 Cost 8507.447265625
     Update 24 Cost 10936.654296875

Train Data: 0.126158 0.153086166772
valid Data: 0.126846 0.151556642851
Test  Data: 0.132345 0.0485071241521 

Epoch 8
     Update 25 Cost 10232.140625
     Update 26 Cost 8053.1357421875
     Update 27 Cost 9532.9697265625

Train Data: 0.115094 0.317942662471
valid Data: 0.11622 0.309825903209
Test  Data: 0.123133 0.148449373925 

Save model
Saving ccc model
Epoch 9
     Update 28 Cost 9146.4775390625
     Update 29 Cost 7881.59130859375
     Update 30 Cost 8457.21484375

Train Data: 0.110024 0.434668150801
valid Data: 0.111161 0.425954259594
Test  Data: 0.115894 0.273939814426 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 10
     Update 31 Cost 8561.91796875
     Update 32 Cost 11687.671875
     Update 33 Cost 12422.712890625

Train Data: 0.120046 0.283128234052
valid Data: 0.121181 0.275604179
Test  Data: 0.128704 0.126721048179 

Epoch 11
     Update 34 Cost 9672.509765625
     Update 35 Cost 7481.53515625
     Update 36 Cost 8395.21484375

Train Data: 0.104499 0.50771521369
valid Data: 0.105735 0.498197615811
Test  Data: 0.115876 0.307560084224 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 37 Cost 8173.91015625
     Update 38 Cost 7030.75439453125
     Update 39 Cost 7709.95947265625

Train Data: 0.114034 0.466727229302
valid Data: 0.11483 0.461279605381
Test  Data: 0.126731 0.252387547515 

Epoch 13
     Update 40 Cost 9086.7373046875
     Update 41 Cost 10510.1328125
     Update 42 Cost 11651.1015625

Train Data: 0.107478 0.470577806647
valid Data: 0.108844 0.461258171792
Test  Data: 0.119629 0.25517923214 

Epoch 14
     Update 43 Cost 8550.30078125
     Update 44 Cost 6869.724609375
     Update 45 Cost 7272.0458984375

Train Data: 0.0929442 0.645206655144
valid Data: 0.0941502 0.637121928473
Test  Data: 0.112881 0.370109417511 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 15
     Update 46 Cost 7215.0302734375
     Update 47 Cost 6553.2490234375
     Update 48 Cost 7593.21337890625

Train Data: 0.0984708 0.67514671388
valid Data: 0.099993 0.665258358215
Test  Data: 0.128448 0.399756673922 

Save model
Saving ccc model
Epoch 16
     Update 49 Cost 8240.966796875
     Update 50 Cost 7515.72265625
     Update 51 Cost 7076.32421875

Train Data: 0.0887845 0.682473242939
valid Data: 0.0900543 0.673799114056
Test  Data: 0.112595 0.39395298375 

Save model
Saving rmse model
Epoch 17
     Update 52 Cost 6992.8896484375
     Update 53 Cost 6671.13525390625
     Update 54 Cost 8332.05859375

Train Data: 0.0983128 0.670343966102
valid Data: 0.0998951 0.66108579474
Test  Data: 0.130705 0.368491575554 

Epoch 18
     Update 55 Cost 8060.2041015625
     Update 56 Cost 6981.31298828125
     Update 57 Cost 6789.5107421875

Train Data: 0.0865719 0.704468173358
valid Data: 0.0881908 0.693939577277
Test  Data: 0.114338 0.399262557649 

Epoch 19
     Update 58 Cost 6706.7763671875
     Update 59 Cost 6021.20166015625
     Update 60 Cost 6900.4638671875

Train Data: 0.0888724 0.738247437951
valid Data: 0.0900518 0.732210389936
Test  Data: 0.128748 0.411711083118 

Save model
Saving ccc model
Epoch 20
     Update 61 Cost 7049.96533203125
     Update 62 Cost 6352.0
     Update 63 Cost 6522.9462890625

Train Data: 0.0849127 0.739370432895
valid Data: 0.0866074 0.728807709623
Test  Data: 0.117173 0.428511474071 

Save model
Saving ccc model
Epoch 21
     Update 64 Cost 6773.189453125
     Update 65 Cost 6365.24072265625
     Update 66 Cost 8343.7880859375

Train Data: 0.0930914 0.726347551926
valid Data: 0.0943277 0.719993932654
Test  Data: 0.136322 0.390197666815 

Epoch 22
     Update 67 Cost 7422.28271484375
     Update 68 Cost 6625.72705078125
     Update 69 Cost 6274.58349609375

Train Data: 0.077711 0.776469944205
valid Data: 0.0795902 0.765564859546
Test  Data: 0.116081 0.437815882881 

Save model
Saving ccc model
Epoch 23
     Update 70 Cost 6046.03125
     Update 71 Cost 5667.6044921875
     Update 72 Cost 7063.87109375

Train Data: 0.0863992 0.769204208029
valid Data: 0.0886422 0.758192677051
Test  Data: 0.133467 0.417875302872 

Epoch 24
     Update 73 Cost 6940.1630859375
     Update 74 Cost 6213.4853515625
     Update 75 Cost 6143.94677734375

Train Data: 0.0773041 0.776695371418
valid Data: 0.0796964 0.762302410054
Test  Data: 0.112368 0.440670533541 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 25
     Update 76 Cost 6013.537109375
     Update 77 Cost 5967.06591796875
     Update 78 Cost 7369.71875

Train Data: 0.100912 0.620492997718
valid Data: 0.102447 0.613069071304
Test  Data: 0.125806 0.36908132022 

Epoch 26
     Update 79 Cost 7903.9658203125
     Update 80 Cost 6714.47900390625
     Update 81 Cost 6681.0419921875

Train Data: 0.0890938 0.699641020935
valid Data: 0.0905623 0.689979738308
Test  Data: 0.113184 0.423802956709 

Epoch 27
     Update 82 Cost 7083.90185546875
     Update 83 Cost 6690.3642578125
     Update 84 Cost 6955.01416015625

Train Data: 0.0841981 0.783006051656
valid Data: 0.0864951 0.773416191309
Test  Data: 0.133827 0.43876847058 

Epoch 28
     Update 85 Cost 6883.16796875
     Update 86 Cost 6096.3583984375
     Update 87 Cost 5776.4384765625

Train Data: 0.0718353 0.817861332766
valid Data: 0.0743841 0.805844338553
Test  Data: 0.11423 0.488576196039 

Save model
Saving ccc model
Epoch 29
     Update 88 Cost 5602.2041015625
     Update 89 Cost 4881.0244140625
     Update 90 Cost 5391.671875

Train Data: 0.0716043 0.831677847725
valid Data: 0.0739931 0.820485197686
Test  Data: 0.122164 0.477949167217 

Epoch 30
     Update 91 Cost 5727.0068359375
     Update 92 Cost 5658.810546875
     Update 93 Cost 5872.4609375

Train Data: 0.0873215 0.700501788374
valid Data: 0.0890834 0.688650326378
Test  Data: 0.11237 0.416681688149 

Epoch 31
     Update 94 Cost 6761.4677734375
     Update 95 Cost 5617.28173828125
     Update 96 Cost 7264.3193359375

Train Data: 0.0814009 0.796951577445
valid Data: 0.0837757 0.785444169636
Test  Data: 0.130755 0.429182672686 

Epoch 32
     Update 97 Cost 6643.0546875
     Update 98 Cost 5842.35546875
     Update 99 Cost 5466.9931640625

Train Data: 0.0709312 0.815522644252
valid Data: 0.073858 0.799626677931
Test  Data: 0.111515 0.463600972412 

Save model
Saving rmse model
Epoch 33
     Update 100 Cost 5495.44140625
     Update 101 Cost 5260.2099609375
     Update 102 Cost 6076.20654296875

Train Data: 0.0774209 0.824381951851
valid Data: 0.08059 0.809857614914
Test  Data: 0.13453 0.445845050818 

Epoch 34
     Update 103 Cost 6262.88525390625
     Update 104 Cost 5498.4599609375
     Update 105 Cost 5257.546875

Train Data: 0.0669177 0.849813525445
valid Data: 0.0696426 0.836888220036
Test  Data: 0.115437 0.478310601761 

Epoch 35
     Update 106 Cost 5285.99560546875
     Update 107 Cost 4707.1376953125
     Update 108 Cost 5771.51171875

Train Data: 0.0757354 0.830826168831
valid Data: 0.0782362 0.818994433157
Test  Data: 0.141669 0.412743799769 

Epoch 36
     Update 109 Cost 6155.8359375
     Update 110 Cost 5688.4033203125
     Update 111 Cost 5664.8681640625

Train Data: 0.0661363 0.857392721506
valid Data: 0.0693059 0.842329901024
Test  Data: 0.116832 0.486222873329 

Epoch 37
     Update 112 Cost 5240.0029296875
     Update 113 Cost 4529.96875
     Update 114 Cost 5012.2197265625

Train Data: 0.0731395 0.845348589693
valid Data: 0.0760882 0.832023844801
Test  Data: 0.132893 0.45159597145 

Epoch 38
     Update 115 Cost 5814.857421875
     Update 116 Cost 5169.30859375
     Update 117 Cost 4997.50732421875

Train Data: 0.0650857 0.866034068191
valid Data: 0.0675052 0.855211731486
Test  Data: 0.11757 0.490597165802 

Save model
Saving ccc model
Epoch 39
     Update 118 Cost 5226.294921875
     Update 119 Cost 4591.580078125
     Update 120 Cost 5245.25

Train Data: 0.067622 0.870708514053
valid Data: 0.0706483 0.858901666091
Test  Data: 0.138674 0.438274402032 

Epoch 40
     Update 121 Cost 5476.8330078125
     Update 122 Cost 5153.80517578125
     Update 123 Cost 5148.5029296875

Train Data: 0.06701 0.855868980223
valid Data: 0.0692114 0.845986762687
Test  Data: 0.115453 0.503187035382 

Save model
Saving ccc model
Epoch 41
     Update 124 Cost 5290.33642578125
     Update 125 Cost 4657.447265625
     Update 126 Cost 5435.04248046875

Train Data: 0.0775302 0.836423924711
valid Data: 0.0806184 0.823514536752
Test  Data: 0.144574 0.421910693422 

Epoch 42
     Update 127 Cost 6415.255859375
     Update 128 Cost 5513.32421875
     Update 129 Cost 4799.076171875

Train Data: 0.0622213 0.874393241742
valid Data: 0.0649033 0.863191634498
Test  Data: 0.11751 0.475986939846 

Epoch 43
     Update 130 Cost 4958.3134765625
     Update 131 Cost 4470.7392578125
     Update 132 Cost 4977.2294921875

Train Data: 0.0659921 0.873868390273
valid Data: 0.0686911 0.863217863509
Test  Data: 0.136425 0.429127712198 

Epoch 44
     Update 133 Cost 5425.958984375
     Update 134 Cost 5266.818359375
     Update 135 Cost 4733.9208984375

Train Data: 0.062687 0.871446786264
valid Data: 0.0652428 0.860170560909
Test  Data: 0.114515 0.493569606851 

Epoch 45
     Update 136 Cost 5046.0966796875
     Update 137 Cost 4906.72216796875
     Update 138 Cost 5486.5966796875

Train Data: 0.0719728 0.854429941913
valid Data: 0.0746803 0.842718367016
Test  Data: 0.134302 0.445314086907 

Epoch 46
     Update 139 Cost 6052.8359375
     Update 140 Cost 5952.87890625
     Update 141 Cost 5072.9619140625

Train Data: 0.0611862 0.88271426042
valid Data: 0.0637116 0.872289228728
Test  Data: 0.119961 0.496082725464 

Epoch 47
     Update 142 Cost 4982.658203125
     Update 143 Cost 4184.8583984375
     Update 144 Cost 4744.3994140625

Train Data: 0.0645313 0.880759222121
valid Data: 0.0673288 0.870126259186
Test  Data: 0.130311 0.469869747979 

Epoch 48
     Update 145 Cost 5081.251953125
     Update 146 Cost 4729.09130859375
     Update 147 Cost 4419.2939453125

Train Data: 0.0572323 0.895005601797
valid Data: 0.0596801 0.885636880953
Test  Data: 0.113559 0.5016545641 

Epoch 49
     Update 148 Cost 4544.96826171875
     Update 149 Cost 3983.11328125
     Update 150 Cost 4615.1044921875

Train Data: 0.0687018 0.865686930245
valid Data: 0.0713911 0.854985893067
Test  Data: 0.130112 0.452785986172 

Epoch 50
     Update 151 Cost 5456.07421875
     Update 152 Cost 4889.07421875
     Update 153 Cost 4623.8876953125

Train Data: 0.0615938 0.871039566983
valid Data: 0.0646828 0.857440367081
Test  Data: 0.111619 0.474371209818 

Early Stop!

The Best test rmse: 0.111514844
The Best test ccc: 0.503187035382
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0709312 0.815522644252
valid Data: 0.073858 0.799626677931
Test  Data: 0.111515 0.463600972412 


The src run for 51 epochs, with 95.089302 sec/epochs
Training took 4850s
Stage 1:  ((0.070931233, 0.81552264425218612), (0.073857963, 0.79962667793056275), (0.11151484, 0.46360097241212095))

Process finished with exit code 0

