/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.75_150_117.pkl
117 generated train examples : 117 5625
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'learning_rate': 1e-05, 'L2_penalty': None, 'validFreq': -1, 'valid_batch_size': 5, 'dispFreq': 1, 'L1_penalty': None, 'shuffle': False, 'reload_model': None, 'saveFreq': 1110, 'epochs': 2000, 'optimizer': <optimizer.ADADELTA object at 0x7f9561287710>, 'batch_size': 15, 'patience': 10, 'saveto': 'Stage1/Range/App/valence/0.75/150/model/'}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.163377 -0.00935738100257
valid Data: 0.163816 -0.00446069534567
Test  Data: 0.14471 -0.0118041662292
Epoch 0
     Update 1 Cost 8501.41015625
     Update 2 Cost 13733.296875
     Update 3 Cost 13337.412109375
     Update 4 Cost 12265.919921875
     Update 5 Cost 13708.6181640625
     Update 6 Cost 10849.708984375
     Update 7 Cost 10173.037109375
     Update 8 Cost 7908.6904296875

Train Data: 0.135404 0.048184954783
valid Data: 0.135293 0.0584422131768
Test  Data: 0.140347 0.00770385335877 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 9 Cost 9656.13671875
     Update 10 Cost 13597.314453125
     Update 11 Cost 9353.0859375
     Update 12 Cost 9152.435546875
     Update 13 Cost 9127.939453125
     Update 14 Cost 7425.20703125
     Update 15 Cost 8140.8203125
     Update 16 Cost 10042.56640625

Train Data: 0.140742 0.0538264745674
valid Data: 0.140679 0.0603711784431
Test  Data: 0.148219 -0.0172524638176 

Epoch 2
     Update 17 Cost 10457.505859375
     Update 18 Cost 10366.517578125
     Update 19 Cost 9504.115234375
     Update 20 Cost 8120.955078125
     Update 21 Cost 8069.6240234375
     Update 22 Cost 7444.95654296875
     Update 23 Cost 7434.51904296875
     Update 24 Cost 7912.74560546875

Train Data: 0.125338 0.158076126093
valid Data: 0.126228 0.153880499056
Test  Data: 0.129526 0.0245718137031 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 3
     Update 25 Cost 8191.8369140625
     Update 26 Cost 8178.36083984375
     Update 27 Cost 8469.75
     Update 28 Cost 7488.4443359375
     Update 29 Cost 7469.3125
     Update 30 Cost 6946.79736328125
     Update 31 Cost 7569.30419921875
     Update 32 Cost 7165.26025390625

Train Data: 0.115569 0.322949063229
valid Data: 0.116613 0.317896552951
Test  Data: 0.125047 0.0428282750336 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 33 Cost 7140.32470703125
     Update 34 Cost 7458.92822265625
     Update 35 Cost 7978.43701171875
     Update 36 Cost 6997.7060546875
     Update 37 Cost 6900.96533203125
     Update 38 Cost 6066.71826171875
     Update 39 Cost 6272.97705078125
     Update 40 Cost 7862.53271484375

Train Data: 0.110871 0.550299163895
valid Data: 0.111549 0.549618084509
Test  Data: 0.129889 0.26065862703 

Save model
Saving ccc model
Epoch 5
     Update 41 Cost 7360.5029296875
     Update 42 Cost 8178.2080078125
     Update 43 Cost 7616.849609375
     Update 44 Cost 5930.126953125
     Update 45 Cost 6110.6328125
     Update 46 Cost 6383.2197265625
     Update 47 Cost 8456.25390625
     Update 48 Cost 6686.1630859375

Train Data: 0.107266 0.436451952081
valid Data: 0.109881 0.413255786048
Test  Data: 0.118903 0.138607146186 

Save model
Saving rmse model
Epoch 6
     Update 49 Cost 6310.0986328125
     Update 50 Cost 6434.935546875
     Update 51 Cost 6439.9609375
     Update 52 Cost 5529.66064453125
     Update 53 Cost 5747.98291015625
     Update 54 Cost 4765.63525390625
     Update 55 Cost 6141.703125
     Update 56 Cost 6597.67236328125

Train Data: 0.111875 0.447541925733
valid Data: 0.113712 0.431490457766
Test  Data: 0.118852 0.263772107978 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 7
     Update 57 Cost 6012.3095703125
     Update 58 Cost 5510.69970703125
     Update 59 Cost 5242.0966796875
     Update 60 Cost 5410.37744140625
     Update 61 Cost 6796.8974609375
     Update 62 Cost 5000.572265625
     Update 63 Cost 6294.2587890625
     Update 64 Cost 6067.748046875

Train Data: 0.102414 0.547939950677
valid Data: 0.103544 0.543035715242
Test  Data: 0.115253 0.346926596502 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 8
     Update 65 Cost 5619.9677734375
     Update 66 Cost 4781.40673828125
     Update 67 Cost 4952.99853515625
     Update 68 Cost 4616.9033203125
     Update 69 Cost 5003.2138671875
     Update 70 Cost 4096.884765625
     Update 71 Cost 4758.90234375
     Update 72 Cost 5549.2734375

Train Data: 0.0985368 0.589309477378
valid Data: 0.100516 0.57562726575
Test  Data: 0.115417 0.371039712131 

Save model
Saving ccc model
Epoch 9
     Update 73 Cost 5411.3515625
     Update 74 Cost 4495.091796875
     Update 75 Cost 4679.05322265625
     Update 76 Cost 4652.5224609375
     Update 77 Cost 5023.576171875
     Update 78 Cost 4260.74951171875
     Update 79 Cost 4659.1015625
     Update 80 Cost 5469.7392578125

Train Data: 0.0831817 0.8103853887
valid Data: 0.0868497 0.795845845911
Test  Data: 0.140027 0.435815231489 

Save model
Saving ccc model
Epoch 10
     Update 81 Cost 5053.04296875
     Update 82 Cost 5114.15380859375
     Update 83 Cost 5804.43115234375
     Update 84 Cost 5741.0927734375
     Update 85 Cost 4917.2734375
     Update 86 Cost 3871.38916015625
     Update 87 Cost 3905.388671875
     Update 88 Cost 4369.10205078125

Train Data: 0.0693856 0.852362439528
valid Data: 0.0738886 0.834505364877
Test  Data: 0.128843 0.445178224339 

Save model
Saving ccc model
Epoch 11
     Update 89 Cost 4195.5078125
     Update 90 Cost 4388.03955078125
     Update 91 Cost 4731.185546875
     Update 92 Cost 4628.7841796875
     Update 93 Cost 4768.9765625
     Update 94 Cost 3742.360595703125
     Update 95 Cost 3731.5380859375
     Update 96 Cost 4220.26904296875

Train Data: 0.0674282 0.863555869868
valid Data: 0.0716818 0.847005845106
Test  Data: 0.128888 0.460186224252 

Save model
Saving ccc model
Epoch 12
     Update 97 Cost 4070.531005859375
     Update 98 Cost 4126.099609375
     Update 99 Cost 4352.482421875
     Update 100 Cost 4773.453125
     Update 101 Cost 4633.099609375
     Update 102 Cost 3996.08154296875
     Update 103 Cost 4203.6650390625
     Update 104 Cost 4669.1357421875

Train Data: 0.0672262 0.870005090317
valid Data: 0.0709297 0.855979051696
Test  Data: 0.13328 0.451472885673 

Epoch 13
     Update 105 Cost 4036.019287109375
     Update 106 Cost 4088.975341796875
     Update 107 Cost 4239.10546875
     Update 108 Cost 4636.82373046875
     Update 109 Cost 4275.6796875
     Update 110 Cost 3810.4990234375
     Update 111 Cost 3740.20068359375
     Update 112 Cost 3982.38330078125

Train Data: 0.0612867 0.88866557593
valid Data: 0.0660054 0.8713272998
Test  Data: 0.129026 0.446326056731 

Epoch 14
     Update 113 Cost 3668.42529296875
     Update 114 Cost 3682.0556640625
     Update 115 Cost 4049.64794921875
     Update 116 Cost 4734.0751953125
     Update 117 Cost 4288.6103515625
     Update 118 Cost 3873.673828125
     Update 119 Cost 3754.7041015625
     Update 120 Cost 3996.21337890625

Train Data: 0.0669633 0.878091888541
valid Data: 0.0718506 0.860539709209
Test  Data: 0.137717 0.452113239098 

Epoch 15
     Update 121 Cost 3828.724609375
     Update 122 Cost 3770.79541015625
     Update 123 Cost 3834.861083984375
     Update 124 Cost 4818.42138671875
     Update 125 Cost 4228.6748046875
     Update 126 Cost 3669.52197265625
     Update 127 Cost 3665.94482421875
     Update 128 Cost 3870.593505859375

Train Data: 0.0636469 0.877180005269
valid Data: 0.0677711 0.860616046044
Test  Data: 0.127451 0.44826495967 

Epoch 16
     Update 129 Cost 3796.921875
     Update 130 Cost 3950.2353515625
     Update 131 Cost 4810.38525390625
     Update 132 Cost 4961.37744140625
     Update 133 Cost 3672.467041015625
     Update 134 Cost 3108.092041015625
     Update 135 Cost 3210.70458984375
     Update 136 Cost 4074.208740234375

Train Data: 0.0698062 0.821479621811
valid Data: 0.0736307 0.801461657128
Test  Data: 0.118655 0.428852466852 

Epoch 17
     Update 137 Cost 3973.673583984375
     Update 138 Cost 3494.45166015625
     Update 139 Cost 4025.8193359375
     Update 140 Cost 4440.1904296875
     Update 141 Cost 4598.96875
     Update 142 Cost 4395.6259765625
     Update 143 Cost 4991.46826171875
     Update 144 Cost 4005.288330078125

Train Data: 0.0679923 0.823081200445
valid Data: 0.0704105 0.811034064178
Test  Data: 0.115566 0.454440644069 

Epoch 18
     Update 145 Cost 3830.773193359375
     Update 146 Cost 3585.7734375
     Update 147 Cost 4078.892578125
     Update 148 Cost 4279.46875
     Update 149 Cost 4820.8916015625
     Update 150 Cost 4610.771484375
     Update 151 Cost 4230.07763671875
     Update 152 Cost 3773.6220703125

Train Data: 0.059276 0.874025341246
valid Data: 0.0626716 0.860229638906
Test  Data: 0.119552 0.427646875125 

Epoch 19
     Update 153 Cost 3346.388427734375
     Update 154 Cost 3285.271728515625
     Update 155 Cost 3514.218994140625
     Update 156 Cost 3899.48388671875
     Update 157 Cost 3711.52978515625
     Update 158 Cost 2989.771484375
     Update 159 Cost 3170.5244140625
     Update 160 Cost 3230.2412109375

Train Data: 0.0550135 0.898135985559
valid Data: 0.0586858 0.88481654773
Test  Data: 0.120518 0.443987756942 

Epoch 20
     Update 161 Cost 3032.375
     Update 162 Cost 2916.609375
     Update 163 Cost 3479.77978515625
     Update 164 Cost 3933.48291015625
     Update 165 Cost 4272.8564453125
     Update 166 Cost 3799.099365234375
     Update 167 Cost 3625.629150390625
     Update 168 Cost 3519.13037109375

Train Data: 0.058848 0.876480325914
valid Data: 0.062513 0.861364773819
Test  Data: 0.117563 0.445078330575 

Epoch 21
     Update 169 Cost 3404.89501953125
     Update 170 Cost 3048.84814453125
     Update 171 Cost 3261.4697265625
     Update 172 Cost 3398.598876953125
     Update 173 Cost 3590.84619140625
     Update 174 Cost 3010.6025390625
     Update 175 Cost 3210.8505859375
     Update 176 Cost 3182.582275390625

Train Data: 0.0504562 0.915228203006
valid Data: 0.0546005 0.901484797496
Test  Data: 0.124649 0.436221467048 

Epoch 22
     Update 177 Cost 2887.5810546875
     Update 178 Cost 2824.69287109375
     Update 179 Cost 3203.3505859375
     Update 180 Cost 3411.3125
     Update 181 Cost 3311.207763671875
     Update 182 Cost 2757.3134765625
     Update 183 Cost 2847.131591796875
     Update 184 Cost 2733.294921875

Train Data: 0.0459664 0.93559310606
valid Data: 0.0515119 0.919966426418
Test  Data: 0.127999 0.433965064162 

Epoch 23
     Update 185 Cost 2563.13232421875
     Update 186 Cost 2690.201904296875
     Update 187 Cost 3241.9638671875
     Update 188 Cost 3921.070556640625
     Update 189 Cost 3356.09521484375
     Update 190 Cost 3115.28955078125
     Update 191 Cost 2865.01220703125
     Update 192 Cost 3033.50732421875

Train Data: 0.0605818 0.909747787691
valid Data: 0.0645977 0.898017298721
Test  Data: 0.142996 0.431983559215 

Early Stop!

The Best test rmse: 0.115253411233
The Best test ccc: 0.460186224252
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.102414 0.547939950677
valid Data: 0.103544 0.543035715242
Test  Data: 0.115253 0.346926596502 


The src run for 24 epochs, with 200.265481 sec/epochs
Training took 4806s
Stage 1:  ((0.10241397, 0.54793995067726864), (0.10354405, 0.54303571524240191), (0.11525341, 0.34692659650246815))

Process finished with exit code 0

