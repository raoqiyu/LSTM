/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.75_125_135.pkl
135 generated train examples : 135 5625
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'optimizer': <optimizer.ADADELTA object at 0x7f86cd7a87b8>, 'epochs': 2000, 'patience': 10, 'shuffle': False, 'learning_rate': 1e-05, 'batch_size': 15, 'L2_penalty': None, 'reload_model': None, 'saveto': 'Stage1/Range/App/0.75/125/model/', 'valid_batch_size': 5, 'validFreq': -1, 'saveFreq': 1110, 'dispFreq': 1, 'L1_penalty': None}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.187213 0.00251374122706
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 13386.8359375
     Update 2 Cost 18994.0234375
     Update 3 Cost 14158.9365234375
     Update 4 Cost 13034.193359375
     Update 5 Cost 13510.38671875
     Update 6 Cost 12883.7978515625
     Update 7 Cost 12901.234375
     Update 8 Cost 14059.310546875
     Update 9 Cost 13511.01953125

Train Data: 0.183201 0.155540643234
valid Data: 0.177624 0.152796699463
Test  Data: 0.229298 0.0214025337994 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 10 Cost 12298.6806640625
     Update 11 Cost 12007.5849609375
     Update 12 Cost 11937.638671875
     Update 13 Cost 15997.1630859375
     Update 14 Cost 13019.873046875
     Update 15 Cost 12100.43359375
     Update 16 Cost 10922.3046875
     Update 17 Cost 14991.529296875
     Update 18 Cost 11897.19140625

Train Data: 0.160372 0.372753176585
valid Data: 0.157031 0.36658455715
Test  Data: 0.189217 0.139178125437 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 2
     Update 19 Cost 11341.294921875
     Update 20 Cost 11504.423828125
     Update 21 Cost 12548.7021484375
     Update 22 Cost 10965.837890625
     Update 23 Cost 10745.375
     Update 24 Cost 9805.845703125
     Update 25 Cost 9190.041015625
     Update 26 Cost 10532.3779296875
     Update 27 Cost 11673.4326171875

Train Data: 0.153399 0.56530468518
valid Data: 0.154975 0.530674513085
Test  Data: 0.220503 0.243938738516 

Save model
Saving ccc model
Epoch 3
     Update 28 Cost 9926.0263671875
     Update 29 Cost 10520.658203125
     Update 30 Cost 9676.3134765625
     Update 31 Cost 10695.73046875
     Update 32 Cost 9121.890625
     Update 33 Cost 10113.197265625
     Update 34 Cost 9437.7734375
     Update 35 Cost 10417.818359375
     Update 36 Cost 8933.390625

Train Data: 0.127426 0.704849044283
valid Data: 0.133858 0.658040706806
Test  Data: 0.186978 0.380253393267 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 37 Cost 8258.7763671875
     Update 38 Cost 8123.42578125
     Update 39 Cost 8263.45703125
     Update 40 Cost 8688.78515625
     Update 41 Cost 7640.0224609375
     Update 42 Cost 8080.3740234375
     Update 43 Cost 7995.6796875
     Update 44 Cost 8463.67578125
     Update 45 Cost 8351.1123046875

Train Data: 0.123665 0.743633122281
valid Data: 0.131348 0.694562221678
Test  Data: 0.218165 0.338752689782 

Epoch 5
     Update 46 Cost 8016.4501953125
     Update 47 Cost 10367.2080078125
     Update 48 Cost 9493.4443359375
     Update 49 Cost 9846.3544921875
     Update 50 Cost 8263.0166015625
     Update 51 Cost 8996.958984375
     Update 52 Cost 7999.0419921875
     Update 53 Cost 8239.6943359375
     Update 54 Cost 7804.3935546875

Train Data: 0.124494 0.740460743398
valid Data: 0.132474 0.692927772989
Test  Data: 0.178558 0.433300770999 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 6
     Update 55 Cost 8016.580078125
     Update 56 Cost 10077.44921875
     Update 57 Cost 9299.12890625
     Update 58 Cost 8577.4296875
     Update 59 Cost 8254.650390625
     Update 60 Cost 7869.353515625
     Update 61 Cost 7718.3193359375
     Update 62 Cost 8811.53515625
     Update 63 Cost 8899.474609375

Train Data: 0.119736 0.737562876281
valid Data: 0.123783 0.702175697537
Test  Data: 0.220559 0.298727057368 

Epoch 7
     Update 64 Cost 7665.76953125
     Update 65 Cost 7973.74560546875
     Update 66 Cost 7408.87158203125
     Update 67 Cost 7881.943359375
     Update 68 Cost 7732.96875
     Update 69 Cost 7852.11865234375
     Update 70 Cost 7188.666015625
     Update 71 Cost 7307.9814453125
     Update 72 Cost 6925.47265625

Train Data: 0.112967 0.790132442952
valid Data: 0.12189 0.743305166413
Test  Data: 0.176687 0.414698715739 

Save model
Saving rmse model
Epoch 8
     Update 73 Cost 7237.45703125
     Update 74 Cost 7516.38916015625
     Update 75 Cost 6493.90380859375
     Update 76 Cost 6464.251953125
     Update 77 Cost 6767.185546875
     Update 78 Cost 7156.6318359375
     Update 79 Cost 6559.8623046875
     Update 80 Cost 7280.2216796875
     Update 81 Cost 7544.56884765625

Train Data: 0.10645 0.8076726717
valid Data: 0.11265 0.771376325957
Test  Data: 0.2129 0.36149477064 

Epoch 9
     Update 82 Cost 6810.30078125
     Update 83 Cost 7633.70751953125
     Update 84 Cost 6714.0859375
     Update 85 Cost 6735.00341796875
     Update 86 Cost 6515.7578125
     Update 87 Cost 6821.9443359375
     Update 88 Cost 5958.54541015625
     Update 89 Cost 6269.57080078125
     Update 90 Cost 6523.6572265625

Train Data: 0.113881 0.808276137725
valid Data: 0.122487 0.767770453631
Test  Data: 0.171471 0.483300420913 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 10
     Update 91 Cost 7094.9326171875
     Update 92 Cost 7150.712890625
     Update 93 Cost 6241.64013671875
     Update 94 Cost 6603.79150390625
     Update 95 Cost 6668.3916015625
     Update 96 Cost 6471.39697265625
     Update 97 Cost 5852.544921875
     Update 98 Cost 7221.0966796875
     Update 99 Cost 7528.0859375

Train Data: 0.115384 0.763987813714
valid Data: 0.120659 0.727137002813
Test  Data: 0.212063 0.353643858097 

Epoch 11
     Update 100 Cost 7351.57275390625
     Update 101 Cost 7364.640625
     Update 102 Cost 6171.4501953125
     Update 103 Cost 6596.80078125
     Update 104 Cost 6380.86376953125
     Update 105 Cost 6182.966796875
     Update 106 Cost 5345.49609375
     Update 107 Cost 5542.67919921875
     Update 108 Cost 5573.10546875

Train Data: 0.0907502 0.866380052428
valid Data: 0.100031 0.828208455155
Test  Data: 0.177137 0.43193274213 

Epoch 12
     Update 109 Cost 5678.7216796875
     Update 110 Cost 6139.576171875
     Update 111 Cost 5520.8779296875
     Update 112 Cost 6054.72265625
     Update 113 Cost 6870.79296875
     Update 114 Cost 7951.5712890625
     Update 115 Cost 5501.3525390625
     Update 116 Cost 5454.6455078125
     Update 117 Cost 5317.82177734375

Train Data: 0.0856899 0.885644046401
valid Data: 0.0949412 0.850597838184
Test  Data: 0.205753 0.382920672093 

Epoch 13
     Update 118 Cost 5379.22607421875
     Update 119 Cost 6155.7880859375
     Update 120 Cost 5551.248046875
     Update 121 Cost 6270.78076171875
     Update 122 Cost 6598.1259765625
     Update 123 Cost 7580.412109375
     Update 124 Cost 5910.26220703125
     Update 125 Cost 5240.70068359375
     Update 126 Cost 5020.591796875

Train Data: 0.0863794 0.879208074721
valid Data: 0.0947083 0.846196437734
Test  Data: 0.180869 0.409293160965 

Epoch 14
     Update 127 Cost 5383.2919921875
     Update 128 Cost 5773.140625
     Update 129 Cost 5359.3447265625
     Update 130 Cost 5821.5966796875
     Update 131 Cost 6127.04150390625
     Update 132 Cost 6436.83203125
     Update 133 Cost 4874.6123046875
     Update 134 Cost 5281.0947265625
     Update 135 Cost 5477.30712890625

Train Data: 0.0899571 0.866711496397
valid Data: 0.0961141 0.837068322465
Test  Data: 0.206413 0.362833160513 

Epoch 15
     Update 136 Cost 5700.01220703125
     Update 137 Cost 5997.85546875
     Update 138 Cost 5204.8701171875
     Update 139 Cost 5347.35888671875
     Update 140 Cost 5511.97412109375
     Update 141 Cost 5507.1572265625
     Update 142 Cost 4862.1044921875
     Update 143 Cost 4878.2548828125
     Update 144 Cost 4844.93359375

Train Data: 0.088016 0.892076845485
valid Data: 0.0972452 0.860339549637
Test  Data: 0.184205 0.44959971253 

Epoch 16
     Update 145 Cost 5404.37939453125
     Update 146 Cost 5941.5869140625
     Update 147 Cost 4411.671875
     Update 148 Cost 4951.9365234375
     Update 149 Cost 6012.9716796875
     Update 150 Cost 6030.91943359375
     Update 151 Cost 5825.0380859375
     Update 152 Cost 6260.978515625
     Update 153 Cost 5714.0478515625

Train Data: 0.0842142 0.886584187678
valid Data: 0.0916286 0.856418601353
Test  Data: 0.206462 0.358434290004 

Epoch 17
     Update 154 Cost 5217.572265625
     Update 155 Cost 5402.21337890625
     Update 156 Cost 4512.48046875
     Update 157 Cost 4850.72265625
     Update 158 Cost 5093.5634765625
     Update 159 Cost 5459.1865234375
     Update 160 Cost 4992.197265625
     Update 161 Cost 4687.931640625
     Update 162 Cost 5420.71875

Train Data: 0.0818512 0.91544313686
valid Data: 0.0928839 0.884253029646
Test  Data: 0.196222 0.469261449019 

Epoch 18
     Update 163 Cost 5252.0107421875
     Update 164 Cost 6532.95703125
     Update 165 Cost 4170.5087890625
     Update 166 Cost 4399.146484375
     Update 167 Cost 4637.26220703125
     Update 168 Cost 5139.4990234375
     Update 169 Cost 4447.0361328125
     Update 170 Cost 5401.54443359375
     Update 171 Cost 5032.326171875

Train Data: 0.0888448 0.849534086893
valid Data: 0.0919636 0.82734121592
Test  Data: 0.196443 0.32884830045 

Epoch 19
     Update 172 Cost 5561.650390625
     Update 173 Cost 5230.8876953125
     Update 174 Cost 4328.455078125
     Update 175 Cost 4836.76171875
     Update 176 Cost 5560.185546875
     Update 177 Cost 4913.93505859375
     Update 178 Cost 4465.6552734375
     Update 179 Cost 5009.224609375
     Update 180 Cost 5083.0791015625

Train Data: 0.0718379 0.927549376126
valid Data: 0.0791649 0.906358985121
Test  Data: 0.207824 0.388655037001 

Epoch 20
     Update 181 Cost 4438.7900390625
     Update 182 Cost 4866.0986328125
     Update 183 Cost 4064.41357421875
     Update 184 Cost 5021.814453125
     Update 185 Cost 5363.80078125
     Update 186 Cost 5966.24853515625
     Update 187 Cost 5407.7236328125
     Update 188 Cost 4492.9775390625
     Update 189 Cost 4371.0439453125

Train Data: 0.0781599 0.905653226111
valid Data: 0.0881263 0.872826529909
Test  Data: 0.181505 0.429682360144 

Epoch 21
     Update 190 Cost 4986.0810546875
     Update 191 Cost 5056.81591796875
     Update 192 Cost 3896.069091796875
     Update 193 Cost 4329.8720703125
     Update 194 Cost 4850.64404296875
     Update 195 Cost 5316.5830078125
     Update 196 Cost 4294.91015625
     Update 197 Cost 4539.1259765625
     Update 198 Cost 4289.1240234375

Train Data: 0.0730544 0.908626078079
valid Data: 0.0797004 0.882990451136
Test  Data: 0.1952 0.356023233687 

Epoch 22
     Update 199 Cost 4449.8701171875
     Update 200 Cost 4518.24267578125
     Update 201 Cost 4118.572265625
     Update 202 Cost 4374.14453125
     Update 203 Cost 4641.1005859375
     Update 204 Cost 4725.6298828125
     Update 205 Cost 4022.45751953125
     Update 206 Cost 4511.25732421875
     Update 207 Cost 4465.537109375

Train Data: 0.072845 0.910178586228
valid Data: 0.0792466 0.88686172794
Test  Data: 0.1791 0.415162287926 

Epoch 23
     Update 208 Cost 4704.462890625
     Update 209 Cost 4546.48876953125
     Update 210 Cost 3970.58056640625
     Update 211 Cost 4168.3056640625
     Update 212 Cost 4880.8310546875
     Update 213 Cost 4322.5849609375
     Update 214 Cost 4624.0283203125
     Update 215 Cost 4442.9208984375
     Update 216 Cost 4944.5498046875

Train Data: 0.0743835 0.928409617247
valid Data: 0.0836868 0.903274047092
Test  Data: 0.203352 0.449149688482 

Early Stop!

The Best test rmse: 0.171470716596
The Best test ccc: 0.483300420913
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.113881 0.808276137725
valid Data: 0.122487 0.767770453631
Test  Data: 0.171471 0.483300420913 


The src run for 24 epochs, with 221.803417 sec/epochs
Training took 5323s
Stage 1:  ((0.1138814, 0.80827613772490647), (0.12248656, 0.76777045363149876), (0.17147072, 0.4833004209131781))

Process finished with exit code 0

