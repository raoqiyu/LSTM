/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.75_150_117.pkl
117 generated train examples : 117 5625
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'valid_batch_size': 5, 'reload_model': None, 'learning_rate': 1e-05, 'dispFreq': 1, 'L1_penalty': None, 'saveFreq': 1110, 'batch_size': 15, 'epochs': 2000, 'validFreq': -1, 'optimizer': <optimizer.ADADELTA object at 0x7f2dd064f6d8>, 'saveto': 'Stage1/Range/App/0.75/150/', 'patience': 10, 'L2_penalty': None, 'shuffle': False}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.187355 0.00151904290378
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 12451.583984375
     Update 2 Cost 17800.392578125
     Update 3 Cost 14015.2607421875
     Update 4 Cost 14138.697265625
     Update 5 Cost 15880.4453125
     Update 6 Cost 15910.0615234375
     Update 7 Cost 17214.70703125
     Update 8 Cost 11642.5146484375

Train Data: 0.186632 0.0168521363818
valid Data: 0.18135 0.0139650305951
Test  Data: 0.200619 0.0116834278794 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 9 Cost 12147.828125
     Update 10 Cost 15357.63671875
     Update 11 Cost 14243.8125
     Update 12 Cost 12839.048828125
     Update 13 Cost 12979.3212890625
     Update 14 Cost 13049.9921875
     Update 15 Cost 12545.28125
     Update 16 Cost 11170.162109375

Train Data: 0.181409 0.100337952956
valid Data: 0.175498 0.103018202459
Test  Data: 0.21455 0.00418918261186 

Epoch 2
     Update 17 Cost 11989.3046875
     Update 18 Cost 13628.33984375
     Update 19 Cost 12705.4814453125
     Update 20 Cost 12268.19140625
     Update 21 Cost 12242.564453125
     Update 22 Cost 11884.96484375
     Update 23 Cost 10985.57421875
     Update 24 Cost 9767.068359375

Train Data: 0.164186 0.442056423827
valid Data: 0.161975 0.424305430679
Test  Data: 0.221874 0.0905355928827 

Save model
Saving ccc model
Epoch 3
     Update 25 Cost 10999.0556640625
     Update 26 Cost 11745.7080078125
     Update 27 Cost 12269.3037109375
     Update 28 Cost 12064.509765625
     Update 29 Cost 17163.8203125
     Update 30 Cost 13033.8935546875
     Update 31 Cost 12684.513671875
     Update 32 Cost 9611.099609375

Train Data: 0.15723 0.390031819682
valid Data: 0.155453 0.364587715735
Test  Data: 0.219304 0.124268506582 

Save model
Saving ccc model
Epoch 4
     Update 33 Cost 10195.9345703125
     Update 34 Cost 10653.73046875
     Update 35 Cost 11307.4404296875
     Update 36 Cost 10907.19140625
     Update 37 Cost 11055.6416015625
     Update 38 Cost 10614.67578125
     Update 39 Cost 9728.873046875
     Update 40 Cost 9775.3828125

Train Data: 0.159721 0.504916643767
valid Data: 0.159775 0.473117871957
Test  Data: 0.244602 0.211790399297 

Save model
Saving ccc model
Epoch 5
     Update 41 Cost 10537.232421875
     Update 42 Cost 11541.669921875
     Update 43 Cost 10377.4189453125
     Update 44 Cost 9779.90625
     Update 45 Cost 9028.6484375
     Update 46 Cost 8818.87890625
     Update 47 Cost 8283.587890625
     Update 48 Cost 6957.10546875

Train Data: 0.132006 0.670342084413
valid Data: 0.137158 0.625128022718
Test  Data: 0.21335 0.324083176517 

Save model
Saving ccc model
Epoch 6
     Update 49 Cost 8171.6708984375
     Update 50 Cost 8951.982421875
     Update 51 Cost 10865.9365234375
     Update 52 Cost 10549.373046875
     Update 53 Cost 9693.150390625
     Update 54 Cost 8922.09765625
     Update 55 Cost 8251.294921875
     Update 56 Cost 6573.984375

Train Data: 0.130126 0.701129512782
valid Data: 0.136587 0.651425874298
Test  Data: 0.220877 0.355550800592 

Save model
Saving ccc model
Epoch 7
     Update 57 Cost 8012.01220703125
     Update 58 Cost 8408.076171875
     Update 59 Cost 8214.517578125
     Update 60 Cost 8068.9013671875
     Update 61 Cost 8219.162109375
     Update 62 Cost 8434.482421875
     Update 63 Cost 8899.40625
     Update 64 Cost 7143.82666015625

Train Data: 0.123263 0.706710099238
valid Data: 0.128307 0.664385231776
Test  Data: 0.206415 0.38476754929 

Save model
Saving ccc model
Epoch 8
     Update 65 Cost 7510.54736328125
     Update 66 Cost 7569.3955078125
     Update 67 Cost 7724.0517578125
     Update 68 Cost 7307.0048828125
     Update 69 Cost 7628.06103515625
     Update 70 Cost 7593.00390625
     Update 71 Cost 8152.68359375
     Update 72 Cost 7890.5302734375

Train Data: 0.150444 0.57023773532
valid Data: 0.150989 0.543807515769
Test  Data: 0.236799 0.302970240679 

Epoch 9
     Update 73 Cost 8873.197265625
     Update 74 Cost 8847.9931640625
     Update 75 Cost 7586.32421875
     Update 76 Cost 6831.4501953125
     Update 77 Cost 7269.3330078125
     Update 78 Cost 7129.3818359375
     Update 79 Cost 7444.064453125
     Update 80 Cost 5247.7490234375

Train Data: 0.108837 0.792150988496
valid Data: 0.115001 0.754337800893
Test  Data: 0.193812 0.44902190513 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 10
     Update 81 Cost 6822.91357421875
     Update 82 Cost 7205.80810546875
     Update 83 Cost 7726.962890625
     Update 84 Cost 8335.18359375
     Update 85 Cost 10209.7099609375
     Update 86 Cost 11357.16796875
     Update 87 Cost 8434.44921875
     Update 88 Cost 5796.79150390625

Train Data: 0.111156 0.791953550049
valid Data: 0.116489 0.756768661985
Test  Data: 0.199293 0.437921949917 

Epoch 11
     Update 89 Cost 6698.48095703125
     Update 90 Cost 7000.830078125
     Update 91 Cost 7183.943359375
     Update 92 Cost 6544.724609375
     Update 93 Cost 6754.08837890625
     Update 94 Cost 7213.3046875
     Update 95 Cost 8622.68359375
     Update 96 Cost 6564.53564453125

Train Data: 0.122241 0.744951126363
valid Data: 0.131278 0.690712240688
Test  Data: 0.162877 0.51726684791 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 97 Cost 7490.44677734375
     Update 98 Cost 6759.80859375
     Update 99 Cost 6820.65087890625
     Update 100 Cost 6220.068359375
     Update 101 Cost 6807.75244140625
     Update 102 Cost 6853.77783203125
     Update 103 Cost 8343.3876953125
     Update 104 Cost 6481.8349609375

Train Data: 0.112494 0.789091648133
valid Data: 0.120585 0.744944658149
Test  Data: 0.170901 0.519006561452 

Save model
Saving ccc model
Epoch 13
     Update 105 Cost 6687.0087890625
     Update 106 Cost 6603.7822265625
     Update 107 Cost 6345.4013671875
     Update 108 Cost 6799.8974609375
     Update 109 Cost 7113.00537109375
     Update 110 Cost 6520.6728515625
     Update 111 Cost 6546.1025390625
     Update 112 Cost 5174.34619140625

Train Data: 0.098295 0.837001283254
valid Data: 0.106645 0.797014603224
Test  Data: 0.165636 0.531991992519 

Save model
Saving ccc model
Epoch 14
     Update 113 Cost 6043.69189453125
     Update 114 Cost 6345.3837890625
     Update 115 Cost 6554.35400390625
     Update 116 Cost 6836.353515625
     Update 117 Cost 6820.2021484375
     Update 118 Cost 6001.591796875
     Update 119 Cost 6169.22802734375
     Update 120 Cost 5244.66552734375

Train Data: 0.114557 0.787262143481
valid Data: 0.121848 0.746275628405
Test  Data: 0.162799 0.562665405073 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 15
     Update 121 Cost 7299.1142578125
     Update 122 Cost 7267.3837890625
     Update 123 Cost 6553.80322265625
     Update 124 Cost 6117.1005859375
     Update 125 Cost 6273.2265625
     Update 126 Cost 5572.7041015625
     Update 127 Cost 5503.45556640625
     Update 128 Cost 4241.5380859375

Train Data: 0.0851924 0.87762382409
valid Data: 0.0927463 0.846378700636
Test  Data: 0.173733 0.513333051177 

Epoch 16
     Update 129 Cost 5043.6982421875
     Update 130 Cost 5225.70703125
     Update 131 Cost 5469.357421875
     Update 132 Cost 5321.01708984375
     Update 133 Cost 5799.6123046875
     Update 134 Cost 5345.6005859375
     Update 135 Cost 6427.2001953125
     Update 136 Cost 5998.298828125

Train Data: 0.0962337 0.837967619446
valid Data: 0.101249 0.809683539941
Test  Data: 0.199186 0.431225386244 

Epoch 17
     Update 137 Cost 5811.09375
     Update 138 Cost 5763.181640625
     Update 139 Cost 5973.328125
     Update 140 Cost 6163.8896484375
     Update 141 Cost 6456.146484375
     Update 142 Cost 5849.09765625
     Update 143 Cost 5525.56640625
     Update 144 Cost 4470.53564453125

Train Data: 0.0790133 0.90165148773
valid Data: 0.0851826 0.878183433177
Test  Data: 0.202639 0.436167689335 

Epoch 18
     Update 145 Cost 4619.365234375
     Update 146 Cost 5051.23046875
     Update 147 Cost 5506.99951171875
     Update 148 Cost 5589.7294921875
     Update 149 Cost 5516.2509765625
     Update 150 Cost 5158.79443359375
     Update 151 Cost 5468.06396484375
     Update 152 Cost 4095.210693359375

Train Data: 0.0819441 0.888156357464
valid Data: 0.085705 0.869955937376
Test  Data: 0.202789 0.426988356103 

Epoch 19
     Update 153 Cost 4830.2119140625
     Update 154 Cost 5348.146484375
     Update 155 Cost 5553.9296875
     Update 156 Cost 5171.7822265625
     Update 157 Cost 5044.0830078125
     Update 158 Cost 4782.4765625
     Update 159 Cost 5216.052734375
     Update 160 Cost 3907.83984375

Train Data: 0.0773191 0.911847344141
valid Data: 0.0830238 0.892234923902
Test  Data: 0.196147 0.483197834993 

Epoch 20
     Update 161 Cost 4345.986328125
     Update 162 Cost 4684.5166015625
     Update 163 Cost 4854.10498046875
     Update 164 Cost 4764.37255859375
     Update 165 Cost 5169.5771484375
     Update 166 Cost 5000.58544921875
     Update 167 Cost 4809.80224609375
     Update 168 Cost 3453.00927734375

Train Data: 0.0729906 0.920440417997
valid Data: 0.0816854 0.89438023536
Test  Data: 0.188453 0.492641569603 

Epoch 21
     Update 169 Cost 4103.310546875
     Update 170 Cost 4958.5986328125
     Update 171 Cost 5488.0244140625
     Update 172 Cost 6325.03955078125
     Update 173 Cost 6253.5849609375
     Update 174 Cost 5582.3662109375
     Update 175 Cost 6136.43896484375
     Update 176 Cost 4277.5166015625

Train Data: 0.0841434 0.884246632305
valid Data: 0.0900633 0.859195330817
Test  Data: 0.176558 0.508459803793 

Epoch 22
     Update 177 Cost 4664.380859375
     Update 178 Cost 5207.90576171875
     Update 179 Cost 5160.693359375
     Update 180 Cost 4713.51416015625
     Update 181 Cost 4990.59619140625
     Update 182 Cost 4366.1748046875
     Update 183 Cost 4663.376953125
     Update 184 Cost 3958.49072265625

Train Data: 0.0768701 0.903163815914
valid Data: 0.0829113 0.880079339637
Test  Data: 0.18222 0.456856810573 

Epoch 23
     Update 185 Cost 4386.5478515625
     Update 186 Cost 4510.3701171875
     Update 187 Cost 4489.29736328125
     Update 188 Cost 4043.342529296875
     Update 189 Cost 4566.68701171875
     Update 190 Cost 4151.61376953125
     Update 191 Cost 4869.45703125
     Update 192 Cost 4014.28173828125

Train Data: 0.0770544 0.89810832866
valid Data: 0.0821726 0.877549861564
Test  Data: 0.179663 0.450720031391 

Epoch 24
     Update 193 Cost 4040.528564453125
     Update 194 Cost 4195.466796875
     Update 195 Cost 4380.056640625
     Update 196 Cost 4198.7490234375
     Update 197 Cost 4617.3818359375
     Update 198 Cost 4268.4287109375
     Update 199 Cost 4726.5888671875
     Update 200 Cost 3268.7197265625

Train Data: 0.0683342 0.92362645531
valid Data: 0.0758514 0.899812538319
Test  Data: 0.201746 0.410995802639 

Epoch 25
     Update 201 Cost 3837.8818359375
     Update 202 Cost 4404.517578125
     Update 203 Cost 5516.71728515625
     Update 204 Cost 5133.9677734375
     Update 205 Cost 4914.11376953125
     Update 206 Cost 4377.3974609375
     Update 207 Cost 4535.6572265625
     Update 208 Cost 3557.58349609375

Train Data: 0.0651958 0.936628184279
valid Data: 0.071612 0.918632667568
Test  Data: 0.21316 0.406589977593 

Epoch 26
     Update 209 Cost 3572.0400390625
     Update 210 Cost 4210.1630859375
     Update 211 Cost 4883.8623046875
     Update 212 Cost 4577.482421875
     Update 213 Cost 4358.84619140625
     Update 214 Cost 3737.45166015625
     Update 215 Cost 3923.074951171875
     Update 216 Cost 3384.181884765625

Train Data: 0.0712948 0.921875101856
valid Data: 0.077868 0.900856731272
Test  Data: 0.211674 0.392607256031 

Epoch 27
     Update 217 Cost 3670.6005859375
     Update 218 Cost 4488.28125
     Update 219 Cost 4797.1552734375
     Update 220 Cost 4419.701171875
     Update 221 Cost 4688.8623046875
     Update 222 Cost 4548.15234375
     Update 223 Cost 4388.1416015625
     Update 224 Cost 3494.86474609375

Train Data: 0.0767976 0.91213889389
valid Data: 0.0810462 0.89644886789
Test  Data: 0.204538 0.436481391506 

Epoch 28
     Update 225 Cost 4348.9970703125
     Update 226 Cost 4272.1357421875
     Update 227 Cost 4575.72119140625
     Update 228 Cost 4517.087890625
     Update 229 Cost 4732.10400390625
     Update 230 Cost 5429.4814453125
     Update 231 Cost 5159.267578125
     Update 232 Cost 3920.182373046875

Train Data: 0.0793122 0.902581412954
valid Data: 0.0847612 0.880804426705
Test  Data: 0.186291 0.446499112666 

Early Stop!

The Best test rmse: 0.162798628211
The Best test ccc: 0.562665405073
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.114557 0.787262143481
valid Data: 0.121848 0.746275628405
Test  Data: 0.162799 0.562665405073 


The src run for 29 epochs, with 199.030635 sec/epochs
Training took 5772s
Stage 1:  ((0.1145575, 0.7872621434813396), (0.12184826, 0.74627562840517458), (0.16279863, 0.56266540507338036))

Process finished with exit code 0

