/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.6_150_180.pkl
180 generated train examples : 180 4500
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'L1_penalty': None, 'saveto': 'Stage1/Range/App/0.6/150/model/', 'epochs': 2000, 'batch_size': 15, 'shuffle': False, 'valid_batch_size': 5, 'optimizer': <optimizer.ADADELTA object at 0x7fc6c22c2cc0>, 'learning_rate': 1e-05, 'validFreq': -1, 'patience': 10, 'L2_penalty': None, 'reload_model': None, 'saveFreq': 1110, 'dispFreq': 1}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.191168 -0.00235670226443
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 11372.24609375
     Update 2 Cost 15143.369140625
     Update 3 Cost 10768.921875
     Update 4 Cost 11089.33984375
     Update 5 Cost 9880.8935546875
     Update 6 Cost 11031.650390625
     Update 7 Cost 10532.384765625
     Update 8 Cost 10407.666015625
     Update 9 Cost 10349.318359375
     Update 10 Cost 11076.4619140625
     Update 11 Cost 10171.615234375
     Update 12 Cost 9433.365234375

Train Data: 0.177442 0.331837891453
valid Data: 0.170514 0.32059807081
Test  Data: 0.248976 0.0762528590088 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 13 Cost 8836.439453125
     Update 14 Cost 12137.4892578125
     Update 15 Cost 17015.8125
     Update 16 Cost 11899.4462890625
     Update 17 Cost 10332.814453125
     Update 18 Cost 11299.0068359375
     Update 19 Cost 12304.73828125
     Update 20 Cost 12313.080078125
     Update 21 Cost 9854.4814453125
     Update 22 Cost 10056.8095703125
     Update 23 Cost 10061.369140625
     Update 24 Cost 9482.0478515625

Train Data: 0.168561 0.337625510517
valid Data: 0.164613 0.311940504953
Test  Data: 0.211551 0.0633439176776 

Save model
Saving rmse model
Epoch 2
     Update 25 Cost 9402.90625
     Update 26 Cost 9064.38671875
     Update 27 Cost 9154.3154296875
     Update 28 Cost 9042.962890625
     Update 29 Cost 9220.353515625
     Update 30 Cost 8806.9453125
     Update 31 Cost 8832.22265625
     Update 32 Cost 8248.1572265625
     Update 33 Cost 7867.38232421875
     Update 34 Cost 8624.5205078125
     Update 35 Cost 7805.0517578125
     Update 36 Cost 7436.8994140625

Train Data: 0.156999 0.574676680332
valid Data: 0.15483 0.552482194355
Test  Data: 0.258741 0.113846348699 

Save model
Saving ccc model
Epoch 3
     Update 37 Cost 7749.271484375
     Update 38 Cost 11246.7802734375
     Update 39 Cost 12330.6123046875
     Update 40 Cost 10528.625
     Update 41 Cost 8239.361328125
     Update 42 Cost 8149.97119140625
     Update 43 Cost 7706.80712890625
     Update 44 Cost 7052.6962890625
     Update 45 Cost 6697.31201171875
     Update 46 Cost 7657.384765625
     Update 47 Cost 6724.4833984375
     Update 48 Cost 8838.9189453125

Train Data: 0.170238 0.544236766503
valid Data: 0.175383 0.49898964578
Test  Data: 0.189193 0.315507483666 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 4
     Update 49 Cost 10133.265625
     Update 50 Cost 9010.83203125
     Update 51 Cost 7943.126953125
     Update 52 Cost 8112.2734375
     Update 53 Cost 8563.130859375
     Update 54 Cost 9541.755859375
     Update 55 Cost 8121.154296875
     Update 56 Cost 7216.6298828125
     Update 57 Cost 6207.328125
     Update 58 Cost 7207.0537109375
     Update 59 Cost 6790.05712890625
     Update 60 Cost 7585.83447265625

Train Data: 0.139898 0.659586336398
valid Data: 0.141575 0.629075547322
Test  Data: 0.190694 0.256094043564 

Epoch 5
     Update 61 Cost 7829.9208984375
     Update 62 Cost 7229.9052734375
     Update 63 Cost 7032.23046875
     Update 64 Cost 6904.328125
     Update 65 Cost 6629.6708984375
     Update 66 Cost 6451.603515625
     Update 67 Cost 5976.177734375
     Update 68 Cost 7062.0078125
     Update 69 Cost 6297.890625
     Update 70 Cost 7258.169921875
     Update 71 Cost 7141.078125
     Update 72 Cost 6280.474609375

Train Data: 0.112091 0.776829387531
valid Data: 0.115829 0.742122201949
Test  Data: 0.176903 0.359556496113 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 6
     Update 73 Cost 6112.92724609375
     Update 74 Cost 6209.86962890625
     Update 75 Cost 6238.646484375
     Update 76 Cost 5758.966796875
     Update 77 Cost 5494.671875
     Update 78 Cost 5851.60107421875
     Update 79 Cost 5357.95654296875
     Update 80 Cost 5943.55810546875
     Update 81 Cost 5027.509765625
     Update 82 Cost 5731.6044921875
     Update 83 Cost 6333.9599609375
     Update 84 Cost 5728.43603515625

Train Data: 0.101412 0.825326572976
valid Data: 0.106128 0.793747197123
Test  Data: 0.18425 0.404768614904 

Save model
Saving ccc model
Epoch 7
     Update 85 Cost 5524.69384765625
     Update 86 Cost 5405.52099609375
     Update 87 Cost 5677.240234375
     Update 88 Cost 5445.8154296875
     Update 89 Cost 4993.36767578125
     Update 90 Cost 5085.10400390625
     Update 91 Cost 4882.748046875
     Update 92 Cost 5044.7861328125
     Update 93 Cost 4937.453125
     Update 94 Cost 6187.08642578125
     Update 95 Cost 5907.10888671875
     Update 96 Cost 5756.130859375

Train Data: 0.102774 0.816847870797
valid Data: 0.10436 0.797899397005
Test  Data: 0.175133 0.341959903366 

Save model
Saving rmse model
Epoch 8
     Update 97 Cost 5652.74365234375
     Update 98 Cost 4909.46875
     Update 99 Cost 4808.7294921875
     Update 100 Cost 4666.44384765625
     Update 101 Cost 4559.4140625
     Update 102 Cost 5130.93896484375
     Update 103 Cost 4594.533203125
     Update 104 Cost 4549.02587890625
     Update 105 Cost 4483.5625
     Update 106 Cost 4766.90576171875
     Update 107 Cost 4495.8056640625
     Update 108 Cost 4634.1162109375

Train Data: 0.09403 0.854929014466
valid Data: 0.0967449 0.83512725371
Test  Data: 0.180862 0.411626151206 

Save model
Saving ccc model
Epoch 9
     Update 109 Cost 4990.0849609375
     Update 110 Cost 4753.13330078125
     Update 111 Cost 4852.7451171875
     Update 112 Cost 4610.6494140625
     Update 113 Cost 4337.1455078125
     Update 114 Cost 4467.59375
     Update 115 Cost 4025.433837890625
     Update 116 Cost 4275.318359375
     Update 117 Cost 3977.5078125
     Update 118 Cost 4307.84130859375
     Update 119 Cost 3909.034912109375
     Update 120 Cost 4124.1865234375

Train Data: 0.0826178 0.896658610783
valid Data: 0.0882205 0.871740446938
Test  Data: 0.182189 0.440585260412 

Save model
Saving ccc model
Epoch 10
     Update 121 Cost 4340.57177734375
     Update 122 Cost 4211.54150390625
     Update 123 Cost 4621.1181640625
     Update 124 Cost 4780.666015625
     Update 125 Cost 4743.29345703125
     Update 126 Cost 4950.1396484375
     Update 127 Cost 4196.6015625
     Update 128 Cost 4507.3994140625
     Update 129 Cost 4085.27734375
     Update 130 Cost 4461.3505859375
     Update 131 Cost 4782.1201171875
     Update 132 Cost 5199.90234375

Train Data: 0.0907334 0.862991610367
valid Data: 0.0930833 0.844833826894
Test  Data: 0.177306 0.408689406233 

Epoch 11
     Update 133 Cost 4867.20751953125
     Update 134 Cost 4351.36669921875
     Update 135 Cost 4477.29638671875
     Update 136 Cost 4169.16748046875
     Update 137 Cost 4044.64208984375
     Update 138 Cost 4170.44287109375
     Update 139 Cost 3922.55810546875
     Update 140 Cost 4083.80908203125
     Update 141 Cost 4225.4931640625
     Update 142 Cost 3930.60888671875
     Update 143 Cost 4216.8583984375
     Update 144 Cost 4255.873046875

Train Data: 0.0863041 0.885610556416
valid Data: 0.091215 0.861596476598
Test  Data: 0.175061 0.455855177739 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 145 Cost 4657.46484375
     Update 146 Cost 4185.75146484375
     Update 147 Cost 4532.220703125
     Update 148 Cost 4044.4599609375
     Update 149 Cost 3888.304443359375
     Update 150 Cost 4020.8076171875
     Update 151 Cost 3620.445068359375
     Update 152 Cost 3681.60302734375
     Update 153 Cost 3351.708984375
     Update 154 Cost 3452.540283203125
     Update 155 Cost 3313.955078125
     Update 156 Cost 3259.823974609375

Train Data: 0.0732013 0.918932614593
valid Data: 0.0815366 0.890397516131
Test  Data: 0.188307 0.407365492679 

Epoch 13
     Update 157 Cost 3819.875
     Update 158 Cost 4001.658935546875
     Update 159 Cost 4265.0537109375
     Update 160 Cost 3998.693359375
     Update 161 Cost 4498.6015625
     Update 162 Cost 4029.398193359375
     Update 163 Cost 3362.6083984375
     Update 164 Cost 3339.70166015625
     Update 165 Cost 3111.73828125
     Update 166 Cost 3271.94677734375
     Update 167 Cost 3337.06201171875
     Update 168 Cost 3340.21923828125

Train Data: 0.0753075 0.907612630985
valid Data: 0.0807681 0.883321753712
Test  Data: 0.177263 0.403572545182 

Epoch 14
     Update 169 Cost 3944.62939453125
     Update 170 Cost 3688.27099609375
     Update 171 Cost 3961.88232421875
     Update 172 Cost 3951.89013671875
     Update 173 Cost 3474.099365234375
     Update 174 Cost 3512.64892578125
     Update 175 Cost 3431.72802734375
     Update 176 Cost 3828.70361328125
     Update 177 Cost 3533.24462890625
     Update 178 Cost 3681.550048828125
     Update 179 Cost 4077.8046875
     Update 180 Cost 4188.24755859375

Train Data: 0.0788025 0.907177773499
valid Data: 0.085712 0.88061211527
Test  Data: 0.17641 0.458181563845 

Save model
Saving ccc model
Epoch 15
     Update 181 Cost 4104.88671875
     Update 182 Cost 3651.635009765625
     Update 183 Cost 3825.22802734375
     Update 184 Cost 3808.952880859375
     Update 185 Cost 3421.515869140625
     Update 186 Cost 3474.10546875
     Update 187 Cost 3069.29296875
     Update 188 Cost 3091.80224609375
     Update 189 Cost 3042.1640625
     Update 190 Cost 3430.68994140625
     Update 191 Cost 3278.5732421875
     Update 192 Cost 3374.581298828125

Train Data: 0.0686296 0.93827622119
valid Data: 0.0776159 0.913761298682
Test  Data: 0.207727 0.424108513048 

Epoch 16
     Update 193 Cost 3418.31982421875
     Update 194 Cost 3415.38037109375
     Update 195 Cost 3643.9482421875
     Update 196 Cost 3196.192626953125
     Update 197 Cost 3402.207763671875
     Update 198 Cost 3964.828857421875
     Update 199 Cost 3252.8916015625
     Update 200 Cost 3107.88623046875
     Update 201 Cost 3338.123046875
     Update 202 Cost 3357.727294921875
     Update 203 Cost 3596.5703125
     Update 204 Cost 3314.1728515625

Train Data: 0.0671642 0.935268518109
valid Data: 0.0741353 0.913318622775
Test  Data: 0.209533 0.375738290269 

Epoch 17
     Update 205 Cost 3362.07177734375
     Update 206 Cost 3490.7099609375
     Update 207 Cost 3811.1962890625
     Update 208 Cost 3920.6240234375
     Update 209 Cost 3769.10888671875
     Update 210 Cost 3871.091796875
     Update 211 Cost 3261.799072265625
     Update 212 Cost 3518.575927734375
     Update 213 Cost 3585.83984375
     Update 214 Cost 3442.80908203125
     Update 215 Cost 3296.09228515625
     Update 216 Cost 3517.1171875

Train Data: 0.0668896 0.938786507931
valid Data: 0.0738204 0.918209034079
Test  Data: 0.210848 0.392160100717 

Epoch 18
     Update 217 Cost 3327.488525390625
     Update 218 Cost 3171.8564453125
     Update 219 Cost 3284.59716796875
     Update 220 Cost 3256.446044921875
     Update 221 Cost 3141.69873046875
     Update 222 Cost 3345.858642578125
     Update 223 Cost 2998.0380859375
     Update 224 Cost 2827.252685546875
     Update 225 Cost 3132.50244140625
     Update 226 Cost 3199.693603515625
     Update 227 Cost 3176.2626953125
     Update 228 Cost 3229.97705078125

Train Data: 0.0619168 0.948090795552
valid Data: 0.0693653 0.92822224021
Test  Data: 0.204258 0.410556653539 

Epoch 19
     Update 229 Cost 3032.984375
     Update 230 Cost 3344.728515625
     Update 231 Cost 3933.06494140625
     Update 232 Cost 3559.627685546875
     Update 233 Cost 3584.316162109375
     Update 234 Cost 3878.3193359375
     Update 235 Cost 2881.476318359375
     Update 236 Cost 3171.148193359375
     Update 237 Cost 2825.772705078125
     Update 238 Cost 2891.67919921875
     Update 239 Cost 2958.773681640625
     Update 240 Cost 3062.518310546875

Train Data: 0.0593155 0.953187595314
valid Data: 0.068668 0.93180388108
Test  Data: 0.195427 0.458628867969 

Save model
Saving ccc model
Epoch 20
     Update 241 Cost 2945.6962890625
     Update 242 Cost 2809.88818359375
     Update 243 Cost 3116.6337890625
     Update 244 Cost 3554.379638671875
     Update 245 Cost 3328.4130859375
     Update 246 Cost 3559.84423828125
     Update 247 Cost 2722.236083984375
     Update 248 Cost 2667.896484375
     Update 249 Cost 2829.78076171875
     Update 250 Cost 3380.71240234375
     Update 251 Cost 2832.4248046875
     Update 252 Cost 2803.576171875

Train Data: 0.0605764 0.949676932176
valid Data: 0.0687146 0.928424138851
Test  Data: 0.202189 0.421798454325 

Epoch 21
     Update 253 Cost 3007.96484375
     Update 254 Cost 3082.6875
     Update 255 Cost 3409.177734375
     Update 256 Cost 3282.4111328125
     Update 257 Cost 3598.13916015625
     Update 258 Cost 4001.18212890625
     Update 259 Cost 3127.995361328125
     Update 260 Cost 3305.228515625
     Update 261 Cost 3219.638671875
     Update 262 Cost 2840.239501953125
     Update 263 Cost 2942.1943359375
     Update 264 Cost 2764.365966796875

Train Data: 0.0560931 0.957023532645
valid Data: 0.0643849 0.937417629546
Test  Data: 0.207317 0.397888528616 

Epoch 22
     Update 265 Cost 2759.4638671875
     Update 266 Cost 4197.740234375
     Update 267 Cost 5016.3359375
     Update 268 Cost 3354.6865234375
     Update 269 Cost 3080.461669921875
     Update 270 Cost 3106.57177734375
     Update 271 Cost 2503.181640625
     Update 272 Cost 2745.4072265625
     Update 273 Cost 3213.2705078125
     Update 274 Cost 3131.94921875
     Update 275 Cost 2580.3701171875
     Update 276 Cost 2363.380859375

Train Data: 0.0525037 0.962827910968
valid Data: 0.0622783 0.942334744686
Test  Data: 0.188442 0.469628530737 

Save model
Saving ccc model
Epoch 23
     Update 277 Cost 2576.387451171875
     Update 278 Cost 2713.560546875
     Update 279 Cost 2888.97998046875
     Update 280 Cost 3176.04833984375
     Update 281 Cost 2754.61376953125
     Update 282 Cost 2929.01220703125
     Update 283 Cost 2416.5771484375
     Update 284 Cost 2872.3447265625
     Update 285 Cost 2818.07373046875
     Update 286 Cost 2884.134765625
     Update 287 Cost 2614.57177734375
     Update 288 Cost 2610.39306640625

Train Data: 0.0549009 0.960552426542
valid Data: 0.0626841 0.943170410831
Test  Data: 0.199081 0.4472626362 

Epoch 24
     Update 289 Cost 2661.82177734375
     Update 290 Cost 2697.697265625
     Update 291 Cost 2979.8857421875
     Update 292 Cost 2865.794921875
     Update 293 Cost 2733.839111328125
     Update 294 Cost 3063.0556640625
     Update 295 Cost 2524.4228515625
     Update 296 Cost 2667.51171875
     Update 297 Cost 2825.751953125
     Update 298 Cost 3006.05029296875
     Update 299 Cost 2877.74755859375
     Update 300 Cost 2684.2265625

Train Data: 0.0541016 0.959366482546
valid Data: 0.0625395 0.939945671647
Test  Data: 0.205678 0.404095452369 

Epoch 25
     Update 301 Cost 2561.0537109375
     Update 302 Cost 2687.72021484375
     Update 303 Cost 3219.692626953125
     Update 304 Cost 2872.392578125
     Update 305 Cost 2793.015625
     Update 306 Cost 2962.69580078125
     Update 307 Cost 2397.4638671875
     Update 308 Cost 2587.7998046875
     Update 309 Cost 2788.31396484375
     Update 310 Cost 2794.99951171875
     Update 311 Cost 2545.685546875
     Update 312 Cost 2385.896484375

Train Data: 0.0519708 0.964410045584
valid Data: 0.0602163 0.947442145188
Test  Data: 0.19718 0.447767929089 

Epoch 26
     Update 313 Cost 2536.54443359375
     Update 314 Cost 2521.213134765625
     Update 315 Cost 2748.0126953125
     Update 316 Cost 2642.3623046875
     Update 317 Cost 2806.85546875
     Update 318 Cost 3312.8759765625
     Update 319 Cost 2447.35693359375
     Update 320 Cost 2649.594970703125
     Update 321 Cost 2777.08447265625
     Update 322 Cost 2782.1484375
     Update 323 Cost 2500.51611328125
     Update 324 Cost 2471.8486328125

Train Data: 0.058881 0.952934184963
valid Data: 0.0663696 0.93445508866
Test  Data: 0.215019 0.380072040515 

Epoch 27
     Update 325 Cost 2732.94140625
     Update 326 Cost 2942.87451171875
     Update 327 Cost 3269.985107421875
     Update 328 Cost 3501.5693359375
     Update 329 Cost 3185.7265625
     Update 330 Cost 3183.8115234375
     Update 331 Cost 2729.27001953125
     Update 332 Cost 2968.6513671875
     Update 333 Cost 3055.73974609375
     Update 334 Cost 2639.1083984375
     Update 335 Cost 2486.4580078125
     Update 336 Cost 2352.677978515625

Train Data: 0.051283 0.962811798693
valid Data: 0.0589886 0.945451852526
Test  Data: 0.203552 0.403712054579 

Epoch 28
     Update 337 Cost 2402.50830078125
     Update 338 Cost 2677.227783203125
     Update 339 Cost 2758.6728515625
     Update 340 Cost 2687.23095703125
     Update 341 Cost 3167.189208984375
     Update 342 Cost 3066.79345703125
     Update 343 Cost 2536.33154296875
     Update 344 Cost 2991.14404296875
     Update 345 Cost 3029.5791015625
     Update 346 Cost 2821.01806640625
     Update 347 Cost 2578.29833984375
     Update 348 Cost 2496.96728515625

Train Data: 0.0539819 0.959631877219
valid Data: 0.061342 0.942667349686
Test  Data: 0.204978 0.410602532634 

Epoch 29
     Update 349 Cost 2685.130859375
     Update 350 Cost 2443.0947265625
     Update 351 Cost 2568.9970703125
     Update 352 Cost 2402.05078125
     Update 353 Cost 2533.422119140625
     Update 354 Cost 2948.28515625
     Update 355 Cost 2172.7900390625
     Update 356 Cost 2518.0185546875
     Update 357 Cost 2499.344970703125
     Update 358 Cost 2658.76123046875
     Update 359 Cost 2456.0576171875
     Update 360 Cost 2450.439208984375

Train Data: 0.0500601 0.967832909314
valid Data: 0.0586152 0.95140723227
Test  Data: 0.195824 0.462034322282 

Epoch 30
     Update 361 Cost 2434.026123046875
     Update 362 Cost 2539.189697265625
     Update 363 Cost 2645.906982421875
     Update 364 Cost 2650.695556640625
     Update 365 Cost 2504.2021484375
     Update 366 Cost 3017.68359375
     Update 367 Cost 2145.93798828125
     Update 368 Cost 2473.8818359375
     Update 369 Cost 2510.5732421875
     Update 370 Cost 2557.42431640625
     Update 371 Cost 2513.552734375
     Update 372 Cost 2451.0400390625

Train Data: 0.0535346 0.961469724816
valid Data: 0.0613118 0.944791555737
Test  Data: 0.210685 0.400936311136 

Epoch 31
     Update 373 Cost 2565.570556640625
     Update 374 Cost 2592.78515625
     Update 375 Cost 2966.4599609375
     Update 376 Cost 2685.4794921875
     Update 377 Cost 2727.594482421875
     Update 378 Cost 2837.435302734375
     Update 379 Cost 2329.34521484375
     Update 380 Cost 2557.7998046875
     Update 381 Cost 2476.361083984375
     Update 382 Cost 2528.85009765625
     Update 383 Cost 2581.7763671875
     Update 384 Cost 2488.18310546875

Train Data: 0.0564062 0.957165885643
valid Data: 0.06497 0.937387623285
Test  Data: 0.216001 0.385598792815 

Epoch 32
     Update 385 Cost 2712.666015625
     Update 386 Cost 2716.93994140625
     Update 387 Cost 2600.259521484375
     Update 388 Cost 2350.765380859375
     Update 389 Cost 2538.741943359375
     Update 390 Cost 2835.78564453125
     Update 391 Cost 2218.15380859375
     Update 392 Cost 2159.18115234375
     Update 393 Cost 2421.9248046875
     Update 394 Cost 2701.904296875
     Update 395 Cost 2260.36669921875
     Update 396 Cost 2539.5888671875

Train Data: 0.0493175 0.968167931645
valid Data: 0.0577419 0.952006487489
Test  Data: 0.204928 0.427063810023 

Early Stop!

The Best test rmse: 0.175061315298
The Best test ccc: 0.469628530737
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0863041 0.885610556416
valid Data: 0.091215 0.861596476598
Test  Data: 0.175061 0.455855177739 


The src run for 33 epochs, with 234.852243 sec/epochs
Training took 7750s
Stage 1:  ((0.086304098, 0.88561055641615971), (0.091214977, 0.8615964765975751), (0.17506132, 0.45585517773922546))

Process finished with exit code 0

