/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/Exp/LSTM/Solution/AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
generated_train_0.8_125_108.pkl
108 generated train examples : 108 6000
9 original train examples : 9 7501
9 valid  examples : 9 7501

 -------------------- Building Model --------------------
Add a hidden layer
Add a BLSTM layer
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
6 layers
Input  Layer : 84
Hidden Layer : 64 hidden layer
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Hidden Layer : 64 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'learning_rate': 1e-05, 'epochs': 2000, 'optimizer': <optimizer.ADADELTA object at 0x7f1b18b6b4e0>, 'dispFreq': 1, 'reload_model': None, 'saveto': 'Stage1/Range/App/0.8/125/model/', 'shuffle': False, 'L1_penalty': None, 'validFreq': -1, 'batch_size': 15, 'valid_batch_size': 5, 'L2_penalty': None, 'patience': 10, 'saveFreq': 1110}
loss : abs

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.185968 0.00295569882488
valid Data: 0.18124 0.00656943764872
Test  Data: 0.208163 -0.0108587278174
Epoch 0
     Update 1 Cost 13630.955078125
     Update 2 Cost 19758.580078125
     Update 3 Cost 15796.52734375
     Update 4 Cost 14889.228515625
     Update 5 Cost 14010.58203125
     Update 6 Cost 15567.099609375
     Update 7 Cost 14611.4091796875
     Update 8 Cost 3614.9365234375

Train Data: 0.188729 0.0274302274322
valid Data: 0.186479 0.0178805035142
Test  Data: 0.194707 0.00718472332317 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 9 Cost 13488.0859375
     Update 10 Cost 13359.466796875
     Update 11 Cost 14891.1884765625
     Update 12 Cost 17958.3125
     Update 13 Cost 16681.90234375
     Update 14 Cost 13913.896484375
     Update 15 Cost 16301.458984375
     Update 16 Cost 3075.8837890625

Train Data: 0.199238 0.0656698244595
valid Data: 0.193026 0.0693587524631
Test  Data: 0.238456 0.00659273789239 

Epoch 2
     Update 17 Cost 14333.458984375
     Update 18 Cost 15326.34375
     Update 19 Cost 14068.51953125
     Update 20 Cost 13323.4892578125
     Update 21 Cost 12485.4423828125
     Update 22 Cost 11896.068359375
     Update 23 Cost 14814.654296875
     Update 24 Cost 3049.61328125

Train Data: 0.173291 0.306839192919
valid Data: 0.169878 0.297201571532
Test  Data: 0.216742 0.106618418529 

Save model
Saving ccc model
Epoch 3
     Update 25 Cost 12269.9423828125
     Update 26 Cost 11516.87890625
     Update 27 Cost 13064.248046875
     Update 28 Cost 14040.072265625
     Update 29 Cost 11843.0634765625
     Update 30 Cost 10394.49609375
     Update 31 Cost 10868.0859375
     Update 32 Cost 2563.22216796875

Train Data: 0.150631 0.519423315567
valid Data: 0.152234 0.488821079232
Test  Data: 0.20863 0.167320037622 

Save model
Saving ccc model
Epoch 4
     Update 33 Cost 10195.77734375
     Update 34 Cost 9350.69921875
     Update 35 Cost 10179.396484375
     Update 36 Cost 11113.90625
     Update 37 Cost 14172.888671875
     Update 38 Cost 13684.962890625
     Update 39 Cost 10814.0947265625
     Update 40 Cost 2135.9873046875

Train Data: 0.144674 0.531483933913
valid Data: 0.144826 0.508217555899
Test  Data: 0.200968 0.230294271314 

Save model
Saving ccc model
Epoch 5
     Update 41 Cost 10041.16015625
     Update 42 Cost 9404.009765625
     Update 43 Cost 10402.1923828125
     Update 44 Cost 9829.1123046875
     Update 45 Cost 9860.521484375
     Update 46 Cost 11059.580078125
     Update 47 Cost 12231.2421875
     Update 48 Cost 2506.623046875

Train Data: 0.145681 0.494228772365
valid Data: 0.144751 0.482647694294
Test  Data: 0.176114 0.297560068693 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 6
     Update 49 Cost 10106.951171875
     Update 50 Cost 8728.0859375
     Update 51 Cost 8887.501953125
     Update 52 Cost 8137.08154296875
     Update 53 Cost 8265.7939453125
     Update 54 Cost 7962.74072265625
     Update 55 Cost 8605.951171875
     Update 56 Cost 1754.817626953125

Train Data: 0.120013 0.759315171178
valid Data: 0.12199 0.739249312552
Test  Data: 0.201055 0.427488652522 

Save model
Saving ccc model
Epoch 7
     Update 57 Cost 7652.24560546875
     Update 58 Cost 8122.7294921875
     Update 59 Cost 8821.4765625
     Update 60 Cost 10676.7978515625
     Update 61 Cost 10121.6484375
     Update 62 Cost 8195.259765625
     Update 63 Cost 8246.6787109375
     Update 64 Cost 1501.229736328125

Train Data: 0.110493 0.774417774609
valid Data: 0.114073 0.748772009735
Test  Data: 0.188818 0.419916528319 

Epoch 8
     Update 65 Cost 7340.8447265625
     Update 66 Cost 7146.49609375
     Update 67 Cost 7976.78173828125
     Update 68 Cost 9698.421875
     Update 69 Cost 10583.65234375
     Update 70 Cost 9043.763671875
     Update 71 Cost 9706.87109375
     Update 72 Cost 1602.892578125

Train Data: 0.109763 0.796454884385
valid Data: 0.114299 0.76800766061
Test  Data: 0.207538 0.407518066829 

Epoch 9
     Update 73 Cost 7161.748046875
     Update 74 Cost 7146.6064453125
     Update 75 Cost 7431.8115234375
     Update 76 Cost 7435.7958984375
     Update 77 Cost 7359.259765625
     Update 78 Cost 8592.9697265625
     Update 79 Cost 8708.033203125
     Update 80 Cost 1571.5067138671875

Train Data: 0.107133 0.78539650567
valid Data: 0.111068 0.758814007888
Test  Data: 0.179991 0.463833302137 

Save model
Saving ccc model
Epoch 10
     Update 81 Cost 7450.9052734375
     Update 82 Cost 6830.4697265625
     Update 83 Cost 6525.16748046875
     Update 84 Cost 9851.31640625
     Update 85 Cost 9837.810546875
     Update 86 Cost 8762.5625
     Update 87 Cost 8065.552734375
     Update 88 Cost 1251.595703125

Train Data: 0.101121 0.834078314705
valid Data: 0.107768 0.803486153796
Test  Data: 0.200372 0.431929487596 

Epoch 11
     Update 89 Cost 7112.78759765625
     Update 90 Cost 6980.8916015625
     Update 91 Cost 7143.26416015625
     Update 92 Cost 9086.568359375
     Update 93 Cost 9693.3310546875
     Update 94 Cost 7480.080078125
     Update 95 Cost 7155.2421875
     Update 96 Cost 1257.7896728515625

Train Data: 0.0961838 0.83862512756
valid Data: 0.102801 0.807881575599
Test  Data: 0.187258 0.413504259751 

Epoch 12
     Update 97 Cost 6694.486328125
     Update 98 Cost 6677.783203125
     Update 99 Cost 6172.2197265625
     Update 100 Cost 6588.6884765625
     Update 101 Cost 7170.787109375
     Update 102 Cost 7563.6455078125
     Update 103 Cost 8930.2158203125
     Update 104 Cost 1522.9017333984375

Train Data: 0.110235 0.800076606504
valid Data: 0.114706 0.773799632787
Test  Data: 0.220301 0.357042843931 

Epoch 13
     Update 105 Cost 7298.64013671875
     Update 106 Cost 6868.73681640625
     Update 107 Cost 7258.4609375
     Update 108 Cost 7874.259765625
     Update 109 Cost 6853.9794921875
     Update 110 Cost 6265.5791015625
     Update 111 Cost 6483.486328125
     Update 112 Cost 1257.790771484375

Train Data: 0.0916376 0.852172609332
valid Data: 0.0978437 0.823007683156
Test  Data: 0.181441 0.422864885269 

Epoch 14
     Update 113 Cost 6299.5703125
     Update 114 Cost 6358.671875
     Update 115 Cost 7934.69921875
     Update 116 Cost 8121.46484375
     Update 117 Cost 8079.9111328125
     Update 118 Cost 7184.72900390625
     Update 119 Cost 7116.181640625
     Update 120 Cost 1517.39501953125

Train Data: 0.0983218 0.847811866657
valid Data: 0.106442 0.812948621443
Test  Data: 0.217501 0.398504202544 

Epoch 15
     Update 121 Cost 6452.630859375
     Update 122 Cost 6436.70947265625
     Update 123 Cost 6511.744140625
     Update 124 Cost 6886.0048828125
     Update 125 Cost 6363.03125
     Update 126 Cost 5941.1337890625
     Update 127 Cost 6026.7119140625
     Update 128 Cost 1095.203857421875

Train Data: 0.0824982 0.885821650299
valid Data: 0.0893328 0.858948362998
Test  Data: 0.18699 0.453446194477 

Epoch 16
     Update 129 Cost 5601.24755859375
     Update 130 Cost 5531.4462890625
     Update 131 Cost 5700.36279296875
     Update 132 Cost 7154.29443359375
     Update 133 Cost 7362.86279296875
     Update 134 Cost 6632.0009765625
     Update 135 Cost 6188.1962890625
     Update 136 Cost 1139.1038818359375

Train Data: 0.0829547 0.89289180462
valid Data: 0.0904992 0.865498786013
Test  Data: 0.198966 0.444049194264 

Epoch 17
     Update 137 Cost 5641.7138671875
     Update 138 Cost 5643.091796875
     Update 139 Cost 5953.0390625
     Update 140 Cost 6809.533203125
     Update 141 Cost 6593.189453125
     Update 142 Cost 5263.4736328125
     Update 143 Cost 5511.5634765625
     Update 144 Cost 1132.946533203125

Train Data: 0.0819361 0.887554514038
valid Data: 0.0883043 0.862842672361
Test  Data: 0.186471 0.452622071874 

Epoch 18
     Update 145 Cost 5436.1337890625
     Update 146 Cost 5188.439453125
     Update 147 Cost 5967.93505859375
     Update 148 Cost 7189.55712890625
     Update 149 Cost 6641.7353515625
     Update 150 Cost 5754.35107421875
     Update 151 Cost 6292.05126953125
     Update 152 Cost 1241.4765625

Train Data: 0.084308 0.889322474605
valid Data: 0.0908479 0.864751564336
Test  Data: 0.208773 0.416104905478 

Epoch 19
     Update 153 Cost 5576.515625
     Update 154 Cost 5688.5087890625
     Update 155 Cost 6030.93798828125
     Update 156 Cost 6751.6875
     Update 157 Cost 6135.099609375
     Update 158 Cost 5408.5498046875
     Update 159 Cost 5518.65380859375
     Update 160 Cost 954.92236328125

Train Data: 0.0754048 0.907940367892
valid Data: 0.0823948 0.884418735229
Test  Data: 0.198638 0.420304774814 

Epoch 20
     Update 161 Cost 4993.9736328125
     Update 162 Cost 4935.45751953125
     Update 163 Cost 4815.2060546875
     Update 164 Cost 5597.85400390625
     Update 165 Cost 5631.8095703125
     Update 166 Cost 5086.1416015625
     Update 167 Cost 6066.515625
     Update 168 Cost 1174.4957275390625

Train Data: 0.0863762 0.880876526291
valid Data: 0.0936079 0.852581760275
Test  Data: 0.213361 0.374189831718 

Epoch 21
     Update 169 Cost 5707.1298828125
     Update 170 Cost 5528.0166015625
     Update 171 Cost 5860.32763671875
     Update 172 Cost 6340.93310546875
     Update 173 Cost 5659.96630859375
     Update 174 Cost 4948.07080078125
     Update 175 Cost 5264.0068359375
     Update 176 Cost 930.6103515625

Train Data: 0.0744249 0.908820358789
valid Data: 0.0812051 0.885915724728
Test  Data: 0.191119 0.430725365537 

Epoch 22
     Update 177 Cost 4898.80224609375
     Update 178 Cost 4731.25439453125
     Update 179 Cost 4736.2451171875
     Update 180 Cost 5459.0595703125
     Update 181 Cost 5653.0986328125
     Update 182 Cost 4760.314453125
     Update 183 Cost 5504.56787109375
     Update 184 Cost 1019.2396240234375

Train Data: 0.0759105 0.912153264336
valid Data: 0.0835726 0.887813152866
Test  Data: 0.20322 0.431801072789 

Early Stop!

The Best test rmse: 0.176114022732
The Best test ccc: 0.463833302137
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.145681 0.494228772365
valid Data: 0.144751 0.482647694294
Test  Data: 0.176114 0.297560068693 


The src run for 23 epochs, with 207.871863 sec/epochs
Training took 4781s
Stage 1:  ((0.14568135, 0.4942287723651318), (0.14475144, 0.48264769429409732), (0.17611402, 0.29756006869253604))

Process finished with exit code 0

