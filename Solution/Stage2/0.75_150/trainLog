/home/admin1_417/anaconda3/bin/python /home/admin1_417/Raoqiyu/AVEC2015/LSTM/main.py
Using gpu device 0: GeForce GTX 780 Ti
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples
Test
Training BLSTM
Net  2

 -------------------- Building Model --------------------
Add a BLSTM layer
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
4 layers
Input  Layer : 1
Hidden Layer : 1 BLSTM
Hidden Layer : 1 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'reload_model': None, 'saveFreq': 1110, 'dispFreq': 1, 'saveto': 'model/best/model', 'epochs': 2000, 'validFreq': -1, 'valid_batch_size': 5, 'batch_size': 15, 'patience': 10, 'shuffle': False, 'learning_rate': 1e-05, 'optimizer': <optimizer.ADADELTA object at 0x7fee11b9cb38>, 'L1_penalty': None, 'L2_penalty': None}
loss : abs
pretraining
9 9 9

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.18242 0.00922038171469
valid Data: 0.199174 0.00368247161006
Test  Data: 0.199174 0.00368247161006
Epoch 0
     Update 1 Cost 10381.689453125

Train Data: 0.181452 0.0133368578306
valid Data: 0.200074 0.00533131786041
Test  Data: 0.200074 0.00533131786041 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 1
     Update 2 Cost 10307.6396484375

Train Data: 0.1805 0.0186168639472
valid Data: 0.200929 0.0075137176852
Test  Data: 0.200929 0.0075137176852 

Save model
Saving ccc model
Epoch 2
     Update 3 Cost 10234.2421875

Train Data: 0.179526 0.0254882928403
valid Data: 0.201647 0.0105019839066
Test  Data: 0.201647 0.0105019839066 

Save model
Saving ccc model
Epoch 3
     Update 4 Cost 10160.384765625

Train Data: 0.178467 0.0343996488916
valid Data: 0.202155 0.0146126322751
Test  Data: 0.202155 0.0146126322751 

Save model
Saving ccc model
Epoch 4
     Update 5 Cost 10082.4375

Train Data: 0.17727 0.0457646001924
valid Data: 0.202367 0.0201527668392
Test  Data: 0.202367 0.0201527668392 

Save model
Saving ccc model
Epoch 5
     Update 6 Cost 9997.404296875

Train Data: 0.175886 0.0599035102396
valid Data: 0.202201 0.0273344893988
Test  Data: 0.202201 0.0273344893988 

Save model
Saving ccc model
Epoch 6
     Update 7 Cost 9902.328125

Train Data: 0.174279 0.0769615774759
valid Data: 0.201651 0.0361888432295
Test  Data: 0.201651 0.0361888432295 

Save model
Saving ccc model
Epoch 7
     Update 8 Cost 9793.666015625

Train Data: 0.172425 0.097007016806
valid Data: 0.200741 0.0466821186149
Test  Data: 0.200741 0.0466821186149 

Save model
Saving ccc model
Epoch 8
     Update 9 Cost 9668.67578125

Train Data: 0.170291 0.120223217723
valid Data: 0.199531 0.0588601855711
Test  Data: 0.199531 0.0588601855711 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 9
     Update 10 Cost 9524.0654296875

Train Data: 0.167808 0.147252948525
valid Data: 0.198075 0.0730866124032
Test  Data: 0.198075 0.0730866124032 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 10
     Update 11 Cost 9354.0185546875

Train Data: 0.16486 0.179259457071
valid Data: 0.196345 0.0900986242048
Test  Data: 0.196345 0.0900986242048 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 11
     Update 12 Cost 9149.248046875

Train Data: 0.161322 0.217503577622
valid Data: 0.194314 0.110676794917
Test  Data: 0.194314 0.110676794917 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 13 Cost 8898.703125

Train Data: 0.157081 0.263056162836
valid Data: 0.192047 0.135465730127
Test  Data: 0.192047 0.135465730127 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 13
     Update 14 Cost 8592.580078125

Train Data: 0.152073 0.316443372982
valid Data: 0.189654 0.164724803769
Test  Data: 0.189654 0.164724803769 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 14
     Update 15 Cost 8230.603515625

Train Data: 0.146452 0.375853918084
valid Data: 0.187454 0.196690043612
Test  Data: 0.187454 0.196690043612 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 15
     Update 16 Cost 7837.322265625

Train Data: 0.140545 0.438210863811
valid Data: 0.186322 0.228412874822
Test  Data: 0.186322 0.228412874822 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 16
     Update 17 Cost 7434.345703125

Train Data: 0.134084 0.499212330764
valid Data: 0.184439 0.251831041372
Test  Data: 0.184439 0.251831041372 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 17
     Update 18 Cost 6990.271484375

Train Data: 0.132499 0.563199029632
valid Data: 0.196028 0.279603196053
Test  Data: 0.196028 0.279603196053 

Save model
Saving ccc model
Epoch 18
     Update 19 Cost 6896.4892578125

Train Data: 0.126065 0.578157539781
valid Data: 0.171712 0.311111282442
Test  Data: 0.171712 0.311111282442 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 19
     Update 20 Cost 7045.19189453125

Train Data: 0.119584 0.672946709055
valid Data: 0.191824 0.341540867383
Test  Data: 0.191824 0.341540867383 

Save model
Saving ccc model
Epoch 20
     Update 21 Cost 6181.3623046875

Train Data: 0.12134 0.633969099019
valid Data: 0.165864 0.360304977385
Test  Data: 0.165864 0.360304977385 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 21
     Update 22 Cost 6976.8310546875

Train Data: 0.102952 0.769675804344
valid Data: 0.182227 0.405255369872
Test  Data: 0.182227 0.405255369872 

Save model
Saving ccc model
Epoch 22
     Update 23 Cost 5171.26953125

Train Data: 0.110471 0.718433799137
valid Data: 0.162034 0.414793067873
Test  Data: 0.162034 0.414793067873 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 23
     Update 24 Cost 6429.9072265625

Train Data: 0.116812 0.783022856405
valid Data: 0.20376 0.438880696497
Test  Data: 0.20376 0.438880696497 

Save model
Saving ccc model
Epoch 24
     Update 25 Cost 6913.6142578125

Train Data: 0.128733 0.643481889282
valid Data: 0.163369 0.407785373035
Test  Data: 0.163369 0.407785373035 

Epoch 25
     Update 26 Cost 7694.63427734375

Train Data: 0.0979678 0.776961501308
valid Data: 0.161348 0.454119759092
Test  Data: 0.161348 0.454119759092 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 26
     Update 27 Cost 5109.1611328125

Train Data: 0.0843025 0.846063090512
valid Data: 0.165378 0.478753767784
Test  Data: 0.165378 0.478753767784 

Save model
Saving ccc model
Epoch 27
     Update 28 Cost 4261.5283203125

Train Data: 0.068464 0.911184116283
valid Data: 0.166298 0.521484797388
Test  Data: 0.166298 0.521484797388 

Save model
Saving ccc model
Epoch 28
     Update 29 Cost 3317.2607421875

Train Data: 0.0621037 0.928225444013
valid Data: 0.161541 0.537709291416
Test  Data: 0.161541 0.537709291416 

Save model
Saving ccc model
Epoch 29
     Update 30 Cost 3015.62841796875

Train Data: 0.0939936 0.878876804646
valid Data: 0.19479 0.525278229684
Test  Data: 0.19479 0.525278229684 

Epoch 30
     Update 31 Cost 5243.56591796875

Train Data: 0.114547 0.755134184305
valid Data: 0.163512 0.479514049066
Test  Data: 0.163512 0.479514049066 

Epoch 31
     Update 32 Cost 6964.49609375

Train Data: 0.0672241 0.909524227448
valid Data: 0.159576 0.526970237355
Test  Data: 0.159576 0.526970237355 

Save model
Saving rmse model
Epoch 32
     Update 33 Cost 3307.597412109375

Train Data: 0.0654147 0.931467569377
valid Data: 0.175579 0.548624630402
Test  Data: 0.175579 0.548624630402 

Save model
Saving ccc model
Epoch 33
     Update 34 Cost 3570.70361328125

Train Data: 0.089091 0.847345469685
valid Data: 0.159064 0.517562407409
Test  Data: 0.159064 0.517562407409 

Save model
Saving rmse model
Epoch 34
     Update 35 Cost 5172.529296875

Train Data: 0.0614306 0.930809857203
valid Data: 0.167286 0.534574567329
Test  Data: 0.167286 0.534574567329 

Epoch 35
     Update 36 Cost 3110.667236328125

Train Data: 0.0609749 0.935192715963
valid Data: 0.160622 0.559693509327
Test  Data: 0.160622 0.559693509327 

Save model
Saving ccc model
Epoch 36
     Update 37 Cost 3294.22265625

Train Data: 0.104879 0.856080531502
valid Data: 0.202313 0.512034331929
Test  Data: 0.202313 0.512034331929 

Epoch 37
     Update 38 Cost 6167.5302734375

Train Data: 0.0826976 0.883197515151
valid Data: 0.163894 0.544794057456
Test  Data: 0.163894 0.544794057456 

Epoch 38
     Update 39 Cost 4810.48828125

Train Data: 0.059598 0.937409404194
valid Data: 0.168493 0.54625991884
Test  Data: 0.168493 0.54625991884 

Epoch 39
     Update 40 Cost 3102.63134765625

Train Data: 0.0556226 0.947675322668
valid Data: 0.162441 0.569265950425
Test  Data: 0.162441 0.569265950425 

Save model
Saving ccc model
Epoch 40
     Update 41 Cost 2853.749267578125

Train Data: 0.061571 0.943831112287
valid Data: 0.17886 0.560747032631
Test  Data: 0.17886 0.560747032631 

Epoch 41
     Update 42 Cost 3512.32568359375

Train Data: 0.069581 0.90804995871
valid Data: 0.15827 0.541358143773
Test  Data: 0.15827 0.541358143773 

Save model
Saving rmse model
Epoch 42
     Update 43 Cost 3610.99755859375

Train Data: 0.0541831 0.948767517463
valid Data: 0.168955 0.54242019831
Test  Data: 0.168955 0.54242019831 

Epoch 43
     Update 44 Cost 2860.517578125

Train Data: 0.0603376 0.945746427711
valid Data: 0.170111 0.572954514279
Test  Data: 0.170111 0.572954514279 

Save model
Saving ccc model
Epoch 44
     Update 45 Cost 3310.1689453125

Train Data: 0.0875717 0.884560472465
valid Data: 0.191889 0.502131186082
Test  Data: 0.191889 0.502131186082 

Epoch 45
     Update 46 Cost 5398.591796875

Train Data: 0.0654624 0.920308595852
valid Data: 0.159024 0.549105196999
Test  Data: 0.159024 0.549105196999 

Epoch 46
     Update 47 Cost 3310.64697265625

Train Data: 0.0474379 0.961438093494
valid Data: 0.166192 0.557928057133
Test  Data: 0.166192 0.557928057133 

Epoch 47
     Update 48 Cost 2421.857421875

Train Data: 0.0416123 0.972315004742
valid Data: 0.164807 0.57785253095
Test  Data: 0.164807 0.57785253095 

Save model
Saving ccc model
Epoch 48
     Update 49 Cost 2068.4130859375

Train Data: 0.0404295 0.974896857277
valid Data: 0.170451 0.57102274911
Test  Data: 0.170451 0.57102274911 

Epoch 49
     Update 50 Cost 2273.6787109375

Train Data: 0.0723129 0.897472339328
valid Data: 0.157489 0.525025724639
Test  Data: 0.157489 0.525025724639 

Save model
Saving rmse model
Epoch 50
     Update 51 Cost 3794.620849609375

Train Data: 0.0505155 0.952219929007
valid Data: 0.16506 0.524675623137
Test  Data: 0.16506 0.524675623137 

Epoch 51
     Update 52 Cost 2679.65234375

Train Data: 0.055169 0.961425523918
valid Data: 0.180896 0.583325399912
Test  Data: 0.180896 0.583325399912 

Save model
Saving ccc model
Epoch 52
     Update 53 Cost 2796.896484375

Train Data: 0.075386 0.876302356402
valid Data: 0.159475 0.483938038232
Test  Data: 0.159475 0.483938038232 

Epoch 53
     Update 54 Cost 3925.835205078125

Train Data: 0.0461492 0.963230266825
valid Data: 0.160355 0.563485564193
Test  Data: 0.160355 0.563485564193 

Epoch 54
     Update 55 Cost 2392.86083984375

Train Data: 0.0607978 0.946618582477
valid Data: 0.180963 0.546556805717
Test  Data: 0.180963 0.546556805717 

Epoch 55
     Update 56 Cost 3648.418701171875

Train Data: 0.0721134 0.912063970905
valid Data: 0.163261 0.549274776295
Test  Data: 0.163261 0.549274776295 

Epoch 56
     Update 57 Cost 4232.22802734375

Train Data: 0.0539811 0.945096326981
valid Data: 0.166338 0.518283005503
Test  Data: 0.166338 0.518283005503 

Epoch 57
     Update 58 Cost 2946.5927734375

Train Data: 0.0407198 0.976531937408
valid Data: 0.171414 0.584993276415
Test  Data: 0.171414 0.584993276415 

Save model
Saving ccc model
Epoch 58
     Update 59 Cost 1994.3287353515625

Train Data: 0.0450462 0.962305226401
valid Data: 0.159484 0.543277195578
Test  Data: 0.159484 0.543277195578 

Epoch 59
     Update 60 Cost 2175.235107421875

Train Data: 0.0409173 0.977135897111
valid Data: 0.174473 0.582531152401
Test  Data: 0.174473 0.582531152401 

Epoch 60
     Update 61 Cost 2512.74853515625

Train Data: 0.0725343 0.891939193489
valid Data: 0.157297 0.508076099808
Test  Data: 0.157297 0.508076099808 

Save model
Saving rmse model
Epoch 61
     Update 62 Cost 3623.976806640625

Train Data: 0.0450535 0.96232320049
valid Data: 0.160342 0.541173229427
Test  Data: 0.160342 0.541173229427 

Epoch 62
     Update 63 Cost 2203.18115234375

Train Data: 0.0382416 0.980174108914
valid Data: 0.173474 0.586743789488
Test  Data: 0.173474 0.586743789488 

Save model
Saving ccc model
Epoch 63
     Update 64 Cost 2121.9375

Train Data: 0.0676445 0.905521729408
valid Data: 0.157949 0.506640118275
Test  Data: 0.157949 0.506640118275 

Epoch 64
     Update 65 Cost 3377.378173828125

Train Data: 0.0400603 0.973378314303
valid Data: 0.161646 0.56878610132
Test  Data: 0.161646 0.56878610132 

Epoch 65
     Update 66 Cost 2092.392578125

Train Data: 0.0563633 0.952792814197
valid Data: 0.178648 0.539703161152
Test  Data: 0.178648 0.539703161152 

Epoch 66
     Update 67 Cost 3483.295166015625

Train Data: 0.063819 0.933539293719
valid Data: 0.164044 0.558002845769
Test  Data: 0.164044 0.558002845769 

Epoch 67
     Update 68 Cost 3794.68408203125

Train Data: 0.0520288 0.95052194772
valid Data: 0.168731 0.515285631613
Test  Data: 0.168731 0.515285631613 

Epoch 68
     Update 69 Cost 2924.616943359375

Train Data: 0.0362631 0.981087640677
valid Data: 0.16937 0.583636478658
Test  Data: 0.16937 0.583636478658 

Epoch 69
     Update 70 Cost 1730.3604736328125

Train Data: 0.0299502 0.985504053373
valid Data: 0.165803 0.560063749518
Test  Data: 0.165803 0.560063749518 

Epoch 70
     Update 71 Cost 1451.3828125

Train Data: 0.0568949 0.946564791387
valid Data: 0.161994 0.556750873842
Test  Data: 0.161994 0.556750873842 

Epoch 71
     Update 72 Cost 3527.4208984375

Train Data: 0.0480141 0.961081428642
valid Data: 0.171259 0.522847125077
Test  Data: 0.171259 0.522847125077 

Epoch 72
     Update 73 Cost 2726.4365234375

Train Data: 0.056575 0.94556689466
valid Data: 0.160836 0.554727018123
Test  Data: 0.160836 0.554727018123 

Early Stop!

The Best test rmse: 0.157297238708
The Best test ccc: 0.586743789488
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0725343 0.891939193489
valid Data: 0.157297 0.508076099808
Test  Data: 0.157297 0.508076099808 


The code run for 73 epochs, with 64.561754 sec/epochs
Training took 4713s
((0.072534308, 0.89193919348928119), (0.15729724, 0.50807609980849933), (0.15729724, 0.50807609980849933))

Process finished with exit code 0

