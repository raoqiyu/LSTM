admin1_417@admin1:~/Raoqiyu/Exp/LSTM/Solution$ python AVEC2015Solution.py
Using gpu device 0: GeForce GTX 780 Ti
Data :  features_video_appearance valence
Data :  load_avec2015_data_generated2
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
3 layers
Input  Layer : 1
Hidden Layer : 1 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'validFreq': -1, 'epochs': 2000, 'optimizer': <optimizer.ADADELTA object at 0x7f65af970438>, 'L2_penalty': None, 'L1_penalty': None, 'batch_size': 15, 'shuffle': False, 'patience': 10, 'valid_batch_size': 5, 'reload_model': None, 'saveFreq': 1110, 'dispFreq': 1, 'learning_rate': 1e-05, 'saveto': 'Stage2/Basic/Unsupervised/model/'}
loss : abs
pretraining
9 9 9

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.176424 -0.0130374331338
valid Data: 0.157676 -0.00664925908831
Test  Data: 0.157676 -0.00664925908831
Epoch 0
     Update 1 Cost 8770.3916015625

Train Data: 0.173094 -0.010644751969
valid Data: 0.154706 -0.00543822215502
Test  Data: 0.154706 -0.00543822215502 

Save model
Saving rmse model
Epoch 1
     Update 2 Cost 8556.3447265625

Train Data: 0.169894 -0.00814326198959
valid Data: 0.151879 -0.00416061218446
Test  Data: 0.151879 -0.00416061218446 

Save model
Saving rmse model
Epoch 2
     Update 3 Cost 8354.3359375

Train Data: 0.166847 -0.00554840584697
valid Data: 0.149216 -0.00282368381947
Test  Data: 0.149216 -0.00282368381947 

Save model
Saving rmse model
Epoch 3
     Update 4 Cost 8165.310546875

Train Data: 0.163963 -0.00284919244001
valid Data: 0.146726 -0.00142417041899
Test  Data: 0.146726 -0.00142417041899 

Save model
Saving rmse model
Epoch 4
     Update 5 Cost 7990.65234375

Train Data: 0.161255 -2.4114529561e-05
valid Data: 0.14442 4.60087882881e-05
Test  Data: 0.14442 4.60087882881e-05 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 5
     Update 6 Cost 7831.751953125

Train Data: 0.15873 0.00295236828181
valid Data: 0.142303 0.00159681068478
Test  Data: 0.142303 0.00159681068478 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 6
     Update 7 Cost 7687.5166015625

Train Data: 0.156345 0.00611143815872
valid Data: 0.140338 0.00324194017548
Test  Data: 0.140338 0.00324194017548 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 7
     Update 8 Cost 7554.66650390625

Train Data: 0.154092 0.00948600268968
valid Data: 0.138516 0.00499556996098
Test  Data: 0.138516 0.00499556996098 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 8
     Update 9 Cost 7432.6767578125

Train Data: 0.15199 0.0130997276566
valid Data: 0.136852 0.00686667280655
Test  Data: 0.136852 0.00686667280655 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 9
     Update 10 Cost 7322.2255859375

Train Data: 0.15 0.0169884461836
valid Data: 0.135311 0.0088706318502
Test  Data: 0.135311 0.0088706318502 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 10
     Update 11 Cost 7221.02685546875

Train Data: 0.148112 0.0211835311302
valid Data: 0.133886 0.0110198287731
Test  Data: 0.133886 0.0110198287731 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 11
     Update 12 Cost 7127.8779296875

Train Data: 0.146315 0.025719246451
valid Data: 0.132566 0.0133275770088
Test  Data: 0.132566 0.0133275770088 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 12
     Update 13 Cost 7042.11279296875

Train Data: 0.144613 0.0306214898188
valid Data: 0.131352 0.0158024220651
Test  Data: 0.131352 0.0158024220651 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 13
     Update 14 Cost 6963.755859375

Train Data: 0.142954 0.0359643567436
valid Data: 0.130205 0.0184761929737
Test  Data: 0.130205 0.0184761929737 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 14
     Update 15 Cost 6889.7529296875

Train Data: 0.141347 0.0417864653382
valid Data: 0.129132 0.0213617021217
Test  Data: 0.129132 0.0213617021217 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 15
     Update 16 Cost 6820.62060546875

Train Data: 0.139789 0.048139441653
valid Data: 0.128131 0.0244774700686
Test  Data: 0.128131 0.0244774700686 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 16
     Update 17 Cost 6756.15625

Train Data: 0.138289 0.0550621845276
valid Data: 0.127206 0.0278360606622
Test  Data: 0.127206 0.0278360606622 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 17
     Update 18 Cost 6696.583984375

Train Data: 0.13679 0.0626925029455
valid Data: 0.126321 0.0314937133239
Test  Data: 0.126321 0.0314937133239 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 18
     Update 19 Cost 6639.36181640625

Train Data: 0.135307 0.071088448792
valid Data: 0.125487 0.035469271141
Test  Data: 0.125487 0.035469271141 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 19
     Update 20 Cost 6584.2216796875

Train Data: 0.133799 0.0804174871142
valid Data: 0.12468 0.0398295117324
Test  Data: 0.12468 0.0398295117324 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 20
     Update 21 Cost 6529.6806640625

Train Data: 0.132277 0.0907730881099
valid Data: 0.12391 0.0446072193922
Test  Data: 0.12391 0.0446072193922 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 21
     Update 22 Cost 6475.701171875

Train Data: 0.130735 0.102295471718
valid Data: 0.123176 0.0498576504185
Test  Data: 0.123176 0.0498576504185 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 22
     Update 23 Cost 6421.568359375

Train Data: 0.129132 0.115244855118
valid Data: 0.122461 0.0556820075691
Test  Data: 0.122461 0.0556820075691 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 23
     Update 24 Cost 6365.60107421875

Train Data: 0.127482 0.129764936016
valid Data: 0.121774 0.062145007724
Test  Data: 0.121774 0.062145007724 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 24
     Update 25 Cost 6308.28369140625

Train Data: 0.125794 0.146018089484
valid Data: 0.121119 0.0693389753677
Test  Data: 0.121119 0.0693389753677 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 25
     Update 26 Cost 6248.88232421875

Train Data: 0.124071 0.164168671199
valid Data: 0.120489 0.0773839366643
Test  Data: 0.120489 0.0773839366643 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 26
     Update 27 Cost 6186.09912109375

Train Data: 0.122267 0.184600022481
valid Data: 0.119857 0.0864943297634
Test  Data: 0.119857 0.0864943297634 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 27
     Update 28 Cost 6117.5087890625

Train Data: 0.120343 0.207726658005
valid Data: 0.119198 0.0969319212465
Test  Data: 0.119198 0.0969319212465 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 28
     Update 29 Cost 6041.05810546875

Train Data: 0.118287 0.233817876365
valid Data: 0.118488 0.108999935194
Test  Data: 0.118488 0.108999935194 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 29
     Update 30 Cost 5953.974609375

Train Data: 0.115978 0.263823130303
valid Data: 0.117683 0.123220137062
Test  Data: 0.117683 0.123220137062 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 30
     Update 31 Cost 5852.43896484375

Train Data: 0.113317 0.298703237991
valid Data: 0.116749 0.14025244772
Test  Data: 0.116749 0.14025244772 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 31
     Update 32 Cost 5732.1708984375

Train Data: 0.110202 0.339499334951
valid Data: 0.115643 0.160967369466
Test  Data: 0.115643 0.160967369466 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 32
     Update 33 Cost 5587.248046875

Train Data: 0.106481 0.387590005124
valid Data: 0.114316 0.186592629404
Test  Data: 0.114316 0.186592629404 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 33
     Update 34 Cost 5409.27392578125

Train Data: 0.101982 0.444363361215
valid Data: 0.112715 0.218748665403
Test  Data: 0.112715 0.218748665403 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 34
     Update 35 Cost 5186.05712890625

Train Data: 0.0964462 0.511483607471
valid Data: 0.110823 0.259537052053
Test  Data: 0.110823 0.259537052053 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 35
     Update 36 Cost 4899.1708984375

Train Data: 0.0897383 0.588552391365
valid Data: 0.108709 0.310504744242
Test  Data: 0.108709 0.310504744242 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 36
     Update 37 Cost 4522.54150390625

Train Data: 0.081982 0.671574382789
valid Data: 0.10681 0.369880528645
Test  Data: 0.10681 0.369880528645 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 37
     Update 38 Cost 4026.79638671875

Train Data: 0.0745187 0.746089233168
valid Data: 0.106024 0.426162338502
Test  Data: 0.106024 0.426162338502 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 38
     Update 39 Cost 3464.36865234375

Train Data: 0.0694521 0.786972749124
valid Data: 0.103946 0.463687063202
Test  Data: 0.103946 0.463687063202 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 39
     Update 40 Cost 2996.3955078125

Train Data: 0.0645091 0.824976813581
valid Data: 0.102907 0.498264957305
Test  Data: 0.102907 0.498264957305 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 40
     Update 41 Cost 2560.27392578125

Train Data: 0.0679658 0.798989110114
valid Data: 0.100534 0.486022219616
Test  Data: 0.100534 0.486022219616 

Save model
Saving rmse model
Epoch 41
     Update 42 Cost 3124.087158203125

Train Data: 0.0615881 0.858064148636
valid Data: 0.106848 0.521700444716
Test  Data: 0.106848 0.521700444716 

Save model
Saving ccc model
Epoch 42
     Update 43 Cost 2869.23291015625

Train Data: 0.0707462 0.784966779922
valid Data: 0.10119 0.474996034783
Test  Data: 0.10119 0.474996034783 

Epoch 43
     Update 44 Cost 3427.4501953125

Train Data: 0.0555962 0.881455012072
valid Data: 0.102753 0.542136895061
Test  Data: 0.102753 0.542136895061 

Save model
Saving ccc model
Epoch 44
     Update 45 Cost 2013.94921875

Train Data: 0.0584508 0.862455084412
valid Data: 0.0999062 0.530679868726
Test  Data: 0.0999062 0.530679868726 

Save model
Saving rmse model
Epoch 45
     Update 46 Cost 2558.8076171875

Train Data: 0.0615541 0.874781442227
valid Data: 0.111791 0.535436034263
Test  Data: 0.111791 0.535436034263 

Epoch 46
     Update 47 Cost 3066.401123046875

Train Data: 0.0645894 0.831120263173
valid Data: 0.10073 0.506121954687
Test  Data: 0.10073 0.506121954687 

Epoch 47
     Update 48 Cost 3166.3603515625

Train Data: 0.0498321 0.911768086019
valid Data: 0.104154 0.562862083516
Test  Data: 0.104154 0.562862083516 

Save model
Saving ccc model
Epoch 48
     Update 49 Cost 1799.7825927734375

Train Data: 0.0541913 0.886318730957
valid Data: 0.0998617 0.543293605103
Test  Data: 0.0998617 0.543293605103 

Save model
Saving rmse model
Epoch 49
     Update 50 Cost 2413.18701171875

Train Data: 0.056292 0.89945919826
valid Data: 0.112054 0.550752447207
Test  Data: 0.112054 0.550752447207 

Epoch 50
     Update 51 Cost 2701.48681640625

Train Data: 0.0613433 0.853145893566
valid Data: 0.100874 0.516635542589
Test  Data: 0.100874 0.516635542589 

Epoch 51
     Update 52 Cost 3062.50634765625

Train Data: 0.0450856 0.930328083562
valid Data: 0.104282 0.573174613857
Test  Data: 0.104282 0.573174613857 

Save model
Saving ccc model
Epoch 52
     Update 53 Cost 1570.652587890625

Train Data: 0.0471735 0.917886517931
valid Data: 0.100265 0.560442091801
Test  Data: 0.100265 0.560442091801 

Epoch 53
     Update 54 Cost 1918.69873046875

Train Data: 0.0599991 0.894692634299
valid Data: 0.117276 0.544627220202
Test  Data: 0.117276 0.544627220202 

Epoch 54
     Update 55 Cost 3068.200927734375

Train Data: 0.0552277 0.885185399773
valid Data: 0.10043 0.53565152168
Test  Data: 0.10043 0.53565152168 

Epoch 55
     Update 56 Cost 2723.2802734375

Train Data: 0.0425317 0.941200131911
valid Data: 0.106376 0.576774228676
Test  Data: 0.106376 0.576774228676 

Save model
Saving ccc model
Epoch 56
     Update 57 Cost 1551.9486083984375

Train Data: 0.0496805 0.908503644152
valid Data: 0.099916 0.54852043259
Test  Data: 0.099916 0.54852043259 

Epoch 57
     Update 58 Cost 2328.15185546875

Train Data: 0.0444755 0.938432063177
valid Data: 0.109593 0.570810648134
Test  Data: 0.109593 0.570810648134 

Epoch 58
     Update 59 Cost 1905.137451171875

Train Data: 0.0559178 0.883978837683
valid Data: 0.100978 0.529356041199
Test  Data: 0.100978 0.529356041199 

Epoch 59
     Update 60 Cost 2845.8759765625

Train Data: 0.0377763 0.953095459239
valid Data: 0.103997 0.581545241026
Test  Data: 0.103997 0.581545241026 

Save model
Saving ccc model
Epoch 60
     Update 61 Cost 1217.630859375

Train Data: 0.0393292 0.945818977652
valid Data: 0.100751 0.570350423643
Test  Data: 0.100751 0.570350423643 

Epoch 61
     Update 62 Cost 1431.122314453125

Train Data: 0.0575575 0.908867052759
valid Data: 0.120005 0.546499354013
Test  Data: 0.120005 0.546499354013 

Epoch 62
     Update 63 Cost 3016.31298828125

Train Data: 0.0468592 0.921562230353
valid Data: 0.100189 0.554117058059
Test  Data: 0.100189 0.554117058059 

Epoch 63
     Update 64 Cost 2258.242431640625

Train Data: 0.0385182 0.954674561127
valid Data: 0.10838 0.578570426636
Test  Data: 0.10838 0.578570426636 

Epoch 64
     Update 65 Cost 1512.1900634765625

Train Data: 0.0497133 0.911623861962
valid Data: 0.100574 0.545076432152
Test  Data: 0.100574 0.545076432152 

Epoch 65
     Update 66 Cost 2498.7333984375

Train Data: 0.0341925 0.963186846305
valid Data: 0.105249 0.583049376516
Test  Data: 0.105249 0.583049376516 

Save model
Saving ccc model
Epoch 66
     Update 67 Cost 1118.4296875

Train Data: 0.0410529 0.940453186648
valid Data: 0.0998316 0.560546140607
Test  Data: 0.0998316 0.560546140607 

Save model
Saving rmse model
Epoch 67
     Update 68 Cost 1813.5953369140625

Train Data: 0.0399676 0.952722026118
valid Data: 0.110905 0.570153343318
Test  Data: 0.110905 0.570153343318 

Epoch 68
     Update 69 Cost 1868.3931884765625

Train Data: 0.0470493 0.921951753743
valid Data: 0.100385 0.549136572733
Test  Data: 0.100385 0.549136572733 

Epoch 69
     Update 70 Cost 2342.1181640625

Train Data: 0.0319724 0.968145727666
valid Data: 0.105224 0.58200560062
Test  Data: 0.105224 0.58200560062 

Epoch 70
     Update 71 Cost 1033.38427734375

Train Data: 0.0412832 0.94031667937
valid Data: 0.099829 0.558294251641
Test  Data: 0.099829 0.558294251641 

Save model
Saving rmse model
Epoch 71
     Update 72 Cost 1898.598876953125

Train Data: 0.0345251 0.964156059228
valid Data: 0.10832 0.574933749507
Test  Data: 0.10832 0.574933749507 

Epoch 72
     Update 73 Cost 1478.41796875

Train Data: 0.0458046 0.927201376395
valid Data: 0.100456 0.551274278193
Test  Data: 0.100456 0.551274278193 

Epoch 73
     Update 74 Cost 2299.2314453125

Train Data: 0.0296645 0.972690264147
valid Data: 0.104686 0.582015821855
Test  Data: 0.104686 0.582015821855 

Epoch 74
     Update 75 Cost 908.3685302734375

Train Data: 0.0388388 0.947855747956
valid Data: 0.0997933 0.561008570417
Test  Data: 0.0997933 0.561008570417 

Save model
Saving rmse model
Epoch 75
     Update 76 Cost 1744.575439453125

Train Data: 0.0332613 0.967090312045
valid Data: 0.108535 0.573399787608
Test  Data: 0.108535 0.573399787608 

Epoch 76
     Update 77 Cost 1479.3734130859375

Train Data: 0.0429495 0.936991935429
valid Data: 0.100292 0.55659183018
Test  Data: 0.100292 0.55659183018 

Epoch 77
     Update 78 Cost 2130.820068359375

Train Data: 0.0284448 0.97523201411
valid Data: 0.105169 0.580347964277
Test  Data: 0.105169 0.580347964277 

Epoch 78
     Update 79 Cost 927.9763793945312

Train Data: 0.0412498 0.942099471323
valid Data: 0.100137 0.558701436354
Test  Data: 0.100137 0.558701436354 

Early Stop!

The Best test rmse: 0.0997933000326
The Best test ccc: 0.583049376516
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0388388 0.947855747956
valid Data: 0.0997933 0.561008570417
Test  Data: 0.0997933 0.561008570417 


The src run for 79 epochs, with 10.631001 sec/epochs
Training took 840s
Stage 2:  ((0.038838834, 0.94785574795606031), (0.0997933, 0.56100857041678298), (0.0997933, 0.56100857041678298))

