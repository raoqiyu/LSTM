admin1_417@admin1:~/Raoqiyu/Exp/LSTM/Solution$ python AVEC2015Solution.py 
Using gpu device 0: GeForce GTX 780 Ti
Data :  features_video_appearance arousal
Data :  load_avec2015_data_generated2
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
3 layers
Input  Layer : 1
Hidden Layer : 1 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'batch_size': 15, 'valid_batch_size': 5, 'L2_penalty': None, 'patience': 10, 'optimizer': <optimizer.ADADELTA object at 0x7fd9958ef438>, 'reload_model': None, 'dispFreq': 1, 'validFreq': -1, 'epochs': 2000, 'shuffle': False, 'saveFreq': 1110, 'saveto': 'Stage2/Basic/Unsupervised/arousal/model/', 'L1_penalty': None, 'learning_rate': 1e-05}
loss : abs
pretraining
9 9 9

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.185229 -0.0211899151292
valid Data: 0.200612 -0.00926911571867
Test  Data: 0.200612 -0.00926911571867
Epoch 0
     Update 1 Cost 10538.9453125

Train Data: 0.184179 -0.0168337961781
valid Data: 0.201561 -0.00723293472942
Test  Data: 0.201561 -0.00723293472942 

Save model
Saving rmse model
Epoch 1
     Update 2 Cost 10457.2890625

Train Data: 0.183263 -0.0124905159788
valid Data: 0.202572 -0.00527240555549
Test  Data: 0.202572 -0.00527240555549 

Epoch 2
     Update 3 Cost 10381.916015625

Train Data: 0.182481 -0.00818970217372
valid Data: 0.203602 -0.00339495220172
Test  Data: 0.203602 -0.00339495220172 

Epoch 3
     Update 4 Cost 10313.9765625

Train Data: 0.181817 -0.00392916800899
valid Data: 0.204633 -0.0015913715453
Test  Data: 0.204633 -0.0015913715453 

Epoch 4
     Update 5 Cost 10252.708984375

Train Data: 0.181255 0.000310945896057
valid Data: 0.205631 0.000153638710523
Test  Data: 0.205631 0.000153638710523 

Save model
Saving ccc model
Epoch 5
     Update 6 Cost 10198.130859375

Train Data: 0.180772 0.00455853419466
valid Data: 0.206582 0.00185920694124
Test  Data: 0.206582 0.00185920694124 

Save model
Saving ccc model
Epoch 6
     Update 7 Cost 10149.123046875

Train Data: 0.180351 0.00884603827451
valid Data: 0.207473 0.00354518201243
Test  Data: 0.207473 0.00354518201243 

Save model
Saving ccc model
Epoch 7
     Update 8 Cost 10104.744140625

Train Data: 0.179971 0.0132082935195
valid Data: 0.208302 0.00523056682407
Test  Data: 0.208302 0.00523056682407 

Save model
Saving ccc model
Epoch 8
     Update 9 Cost 10064.1181640625

Train Data: 0.179618 0.0176767671158
valid Data: 0.209041 0.00693345048183
Test  Data: 0.209041 0.00693345048183 

Save model
Saving ccc model
Epoch 9
     Update 10 Cost 10026.7890625

Train Data: 0.179276 0.0222831505176
valid Data: 0.209695 0.00866997146015
Test  Data: 0.209695 0.00866997146015 

Save model
Saving ccc model
Epoch 10
     Update 11 Cost 9991.56640625

Train Data: 0.178937 0.0270600497555
valid Data: 0.210282 0.0104541854365
Test  Data: 0.210282 0.0104541854365 

Save model
Saving ccc model
Epoch 11
     Update 12 Cost 9957.529296875

Train Data: 0.178588 0.0320405577028
valid Data: 0.210773 0.0123029364122
Test  Data: 0.210773 0.0123029364122 

Save model
Saving ccc model
Epoch 12
     Update 13 Cost 9924.5

Train Data: 0.17822 0.0372630006348
valid Data: 0.211183 0.0142315366476
Test  Data: 0.211183 0.0142315366476 

Save model
Saving ccc model
Epoch 13
     Update 14 Cost 9891.7548828125

Train Data: 0.17783 0.0427699460312
valid Data: 0.211525 0.0162561226
Test  Data: 0.211525 0.0162561226 

Save model
Saving ccc model
Epoch 14
     Update 15 Cost 9858.5234375

Train Data: 0.17741 0.0486099992968
valid Data: 0.211808 0.0183946412534
Test  Data: 0.211808 0.0183946412534 

Save model
Saving ccc model
Epoch 15
     Update 16 Cost 9824.23828125

Train Data: 0.176957 0.0548391202396
valid Data: 0.212039 0.0206669860891
Test  Data: 0.212039 0.0206669860891 

Save model
Saving ccc model
Epoch 16
     Update 17 Cost 9788.560546875

Train Data: 0.176458 0.0615221663742
valid Data: 0.212198 0.0230996457479
Test  Data: 0.212198 0.0230996457479 

Save model
Saving ccc model
Epoch 17
     Update 18 Cost 9751.240234375

Train Data: 0.175899 0.0687351206425
valid Data: 0.212258 0.0257253336756
Test  Data: 0.212258 0.0257253336756 

Save model
Saving ccc model
Epoch 18
     Update 19 Cost 9711.6259765625

Train Data: 0.175281 0.0765743329556
valid Data: 0.21226 0.0285728271861
Test  Data: 0.21226 0.0285728271861 

Save model
Saving ccc model
Epoch 19
     Update 20 Cost 9668.8974609375

Train Data: 0.174597 0.0851554356043
valid Data: 0.212219 0.0316806457147
Test  Data: 0.212219 0.0316806457147 

Save model
Saving ccc model
Epoch 20
     Update 21 Cost 9622.26953125

Train Data: 0.173828 0.0946176100763
valid Data: 0.212104 0.0351034612637
Test  Data: 0.212104 0.0351034612637 

Save model
Saving ccc model
Epoch 21
     Update 22 Cost 9571.0087890625

Train Data: 0.172967 0.10514439474
valid Data: 0.211954 0.0388978567286
Test  Data: 0.211954 0.0388978567286 

Save model
Saving ccc model
Epoch 22
     Update 23 Cost 9513.8935546875

Train Data: 0.171991 0.116961862844
valid Data: 0.21174 0.0431483271848
Test  Data: 0.21174 0.0431483271848 

Save model
Saving ccc model
Epoch 23
     Update 24 Cost 9449.6298828125

Train Data: 0.170879 0.130371556779
valid Data: 0.211474 0.0479579885437
Test  Data: 0.211474 0.0479579885437 

Save model
Saving ccc model
Epoch 24
     Update 25 Cost 9376.388671875

Train Data: 0.169595 0.145772701378
valid Data: 0.211145 0.0534694510199
Test  Data: 0.211145 0.0534694510199 

Save model
Saving ccc model
Epoch 25
     Update 26 Cost 9291.75390625

Train Data: 0.168093 0.163705769764
valid Data: 0.21074 0.05987963774
Test  Data: 0.21074 0.05987963774 

Save model
Saving ccc model
Epoch 26
     Update 27 Cost 9192.45703125

Train Data: 0.166311 0.184933094551
valid Data: 0.210249 0.067468160969
Test  Data: 0.210249 0.067468160969 

Save model
Saving ccc model
Epoch 27
     Update 28 Cost 9073.71875

Train Data: 0.16415 0.21052501968
valid Data: 0.209628 0.0766516165697
Test  Data: 0.209628 0.0766516165697 

Save model
Saving ccc model
Epoch 28
     Update 29 Cost 8928.5673828125

Train Data: 0.161482 0.242064086462
valid Data: 0.208875 0.0880558055427
Test  Data: 0.208875 0.0880558055427 

Save model
Saving ccc model
Epoch 29
     Update 30 Cost 8746.060546875

Train Data: 0.158107 0.281865247847
valid Data: 0.207946 0.102688795957
Test  Data: 0.207946 0.102688795957 

Save model
Saving ccc model
Epoch 30
     Update 31 Cost 8508.900390625

Train Data: 0.15373 0.333220795556
valid Data: 0.206775 0.122224495442
Test  Data: 0.206775 0.122224495442 

Save model
Saving ccc model
Epoch 31
     Update 32 Cost 8189.67236328125

Train Data: 0.147899 0.400050641327
valid Data: 0.2051 0.149485664284
Test  Data: 0.2051 0.149485664284 

Save model
Saving ccc model
Epoch 32
     Update 33 Cost 7746.35107421875

Train Data: 0.140192 0.484604445709
valid Data: 0.202581 0.188860439673
Test  Data: 0.202581 0.188860439673 

Save model
Saving ccc model
Epoch 33
     Update 34 Cost 7128.69921875

Train Data: 0.130007 0.581614210346
valid Data: 0.197535 0.244597569067
Test  Data: 0.197535 0.244597569067 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 34
     Update 35 Cost 6340.84765625

Train Data: 0.115222 0.681539366177
valid Data: 0.184624 0.313096162888
Test  Data: 0.184624 0.313096162888 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 35
     Update 36 Cost 5475.046875

Train Data: 0.10188 0.76152492431
valid Data: 0.170877 0.389515438014
Test  Data: 0.170877 0.389515438014 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 36
     Update 37 Cost 4900.55078125

Train Data: 0.121445 0.708701646138
valid Data: 0.198892 0.368245736824
Test  Data: 0.198892 0.368245736824 

Epoch 37
     Update 38 Cost 6606.5537109375

Train Data: 0.112917 0.708737206891
valid Data: 0.165472 0.369647448616
Test  Data: 0.165472 0.369647448616 

Save model
Saving rmse model
Epoch 38
     Update 39 Cost 6445.53955078125

Train Data: 0.124461 0.705601534595
valid Data: 0.202681 0.36831076281
Test  Data: 0.202681 0.36831076281 

Epoch 39
     Update 40 Cost 6889.439453125

Train Data: 0.103127 0.741726784778
valid Data: 0.170867 0.360091750512
Test  Data: 0.170867 0.360091750512 

Epoch 40
     Update 41 Cost 5214.0517578125

Train Data: 0.110786 0.758705592793
valid Data: 0.191377 0.401333170995
Test  Data: 0.191377 0.401333170995 

Save model
Saving ccc model
Epoch 41
     Update 42 Cost 5845.28466796875

Train Data: 0.103956 0.748377130834
valid Data: 0.164941 0.379833987636
Test  Data: 0.164941 0.379833987636 

Save model
Saving rmse model
Epoch 42
     Update 43 Cost 5786.46875

Train Data: 0.106829 0.778477888127
valid Data: 0.189243 0.415426549402
Test  Data: 0.189243 0.415426549402 

Save model
Saving ccc model
Epoch 43
     Update 44 Cost 5587.43359375

Train Data: 0.101352 0.762092219805
valid Data: 0.16448 0.38661793448
Test  Data: 0.16448 0.38661793448 

Save model
Saving rmse model
Epoch 44
     Update 45 Cost 5632.58154296875

Train Data: 0.101142 0.802376661106
valid Data: 0.185608 0.432164203648
Test  Data: 0.185608 0.432164203648 

Save model
Saving ccc model
Epoch 45
     Update 46 Cost 5179.3134765625

Train Data: 0.10016 0.771426963438
valid Data: 0.163534 0.395140161907
Test  Data: 0.163534 0.395140161907 

Save model
Saving rmse model
Epoch 46
     Update 47 Cost 5641.72998046875

Train Data: 0.0959943 0.823235469681
valid Data: 0.182626 0.446984781107
Test  Data: 0.182626 0.446984781107 

Save model
Saving ccc model
Epoch 47
     Update 48 Cost 4819.2587890625

Train Data: 0.0978526 0.784502184972
valid Data: 0.162668 0.405346893772
Test  Data: 0.162668 0.405346893772 

Save model
Saving rmse model
Epoch 48
     Update 49 Cost 5545.75537109375

Train Data: 0.0915119 0.841162022565
valid Data: 0.180422 0.460252839575
Test  Data: 0.180422 0.460252839575 

Save model
Saving ccc model
Epoch 49
     Update 50 Cost 4538.11865234375

Train Data: 0.0948617 0.799878129114
valid Data: 0.161756 0.417449667274
Test  Data: 0.161756 0.417449667274 

Save model
Saving rmse model
Epoch 50
     Update 51 Cost 5392.939453125

Train Data: 0.0875909 0.856563287808
valid Data: 0.178885 0.472019110868
Test  Data: 0.178885 0.472019110868 

Save model
Saving ccc model
Epoch 51
     Update 52 Cost 4326.98046875

Train Data: 0.0919828 0.814170897269
valid Data: 0.16087 0.429439660019
Test  Data: 0.16087 0.429439660019 

Save model
Saving rmse model
Epoch 52
     Update 53 Cost 5251.765625

Train Data: 0.0833379 0.871715473741
valid Data: 0.177192 0.483195194544
Test  Data: 0.177192 0.483195194544 

Save model
Saving ccc model
Epoch 53
     Update 54 Cost 4091.4423828125

Train Data: 0.0891319 0.827786707054
valid Data: 0.160019 0.441444275763
Test  Data: 0.160019 0.441444275763 

Save model
Saving rmse model
Epoch 54
     Update 55 Cost 5115.1357421875

Train Data: 0.0787974 0.886496497638
valid Data: 0.175428 0.493601545896
Test  Data: 0.175428 0.493601545896 

Save model
Saving ccc model
Epoch 55
     Update 56 Cost 3837.0224609375

Train Data: 0.0863588 0.840481678882
valid Data: 0.159233 0.453186815749
Test  Data: 0.159233 0.453186815749 

Save model
Saving rmse model
Epoch 56
     Update 57 Cost 4984.2783203125

Train Data: 0.0736599 0.901519933599
valid Data: 0.173355 0.503515627848
Test  Data: 0.173355 0.503515627848 

Save model
Saving ccc model
Epoch 57
     Update 58 Cost 3534.8828125

Train Data: 0.0834217 0.853312858173
valid Data: 0.158504 0.465477915263
Test  Data: 0.158504 0.465477915263 

Save model
Saving rmse model
Epoch 58
     Update 59 Cost 4838.044921875

Train Data: 0.0679305 0.916701541283
valid Data: 0.171102 0.513247677706
Test  Data: 0.171102 0.513247677706 

Save model
Saving ccc model
Epoch 59
     Update 60 Cost 3194.603271484375

Train Data: 0.0798943 0.867885308092
valid Data: 0.157838 0.479509076662
Test  Data: 0.157838 0.479509076662 

Save model
Saving rmse model
Epoch 60
     Update 61 Cost 4645.0400390625

Train Data: 0.0621163 0.93085737951
valid Data: 0.16923 0.522432032637
Test  Data: 0.16923 0.522432032637 

Save model
Saving ccc model
Epoch 61
     Update 62 Cost 2875.30908203125

Train Data: 0.0757965 0.883997606363
valid Data: 0.157343 0.495418734351
Test  Data: 0.157343 0.495418734351 

Save model
Saving rmse model
Epoch 62
     Update 63 Cost 4410.3818359375

Train Data: 0.0560107 0.944418756243
valid Data: 0.167716 0.532143350166
Test  Data: 0.167716 0.532143350166 

Save model
Saving ccc model
Epoch 63
     Update 64 Cost 2569.739013671875

Train Data: 0.0713402 0.900752665046
valid Data: 0.157255 0.512909028901
Test  Data: 0.157255 0.512909028901 

Save model
Saving rmse model
Epoch 64
     Update 65 Cost 4150.4521484375

Train Data: 0.050317 0.955890038182
valid Data: 0.166929 0.541234571561
Test  Data: 0.166929 0.541234571561 

Save model
Saving ccc model
Epoch 65
     Update 66 Cost 2329.80712890625

Train Data: 0.0667989 0.916650451069
valid Data: 0.157834 0.529991091713
Test  Data: 0.157834 0.529991091713 

Epoch 66
     Update 67 Cost 3888.19677734375

Train Data: 0.0466403 0.962784015307
valid Data: 0.167208 0.546427744578
Test  Data: 0.167208 0.546427744578 

Save model
Saving ccc model
Epoch 67
     Update 68 Cost 2246.605224609375

Train Data: 0.0631301 0.928502549005
valid Data: 0.158941 0.542703976344
Test  Data: 0.158941 0.542703976344 

Epoch 68
     Update 69 Cost 3685.5537109375

Train Data: 0.0446958 0.966262837546
valid Data: 0.167796 0.54788804465
Test  Data: 0.167796 0.54788804465 

Save model
Saving ccc model
Epoch 69
     Update 70 Cost 2248.95654296875

Train Data: 0.0602549 0.936664562707
valid Data: 0.159916 0.550220806327
Test  Data: 0.159916 0.550220806327 

Save model
Saving ccc model
Epoch 70
     Update 71 Cost 3518.87353515625

Train Data: 0.0438024 0.967805505734
valid Data: 0.168309 0.546856406322
Test  Data: 0.168309 0.546856406322 

Epoch 71
     Update 72 Cost 2287.392822265625

Train Data: 0.0576775 0.942845316605
valid Data: 0.160393 0.554255102347
Test  Data: 0.160393 0.554255102347 

Save model
Saving ccc model
Epoch 72
     Update 73 Cost 3362.965576171875

Train Data: 0.0431723 0.968828010821
valid Data: 0.168629 0.545319662532
Test  Data: 0.168629 0.545319662532 

Epoch 73
     Update 74 Cost 2314.59130859375

Train Data: 0.0549326 0.948506098068
valid Data: 0.160445 0.556584405573
Test  Data: 0.160445 0.556584405573 

Save model
Saving ccc model
Epoch 74
     Update 75 Cost 3187.2451171875

Train Data: 0.0425704 0.96980709161
valid Data: 0.168905 0.5441885682
Test  Data: 0.168905 0.5441885682 

Epoch 75
     Update 76 Cost 2331.92138671875

Train Data: 0.052515 0.953190586121
valid Data: 0.160458 0.558252562545
Test  Data: 0.160458 0.558252562545 

Save model
Saving ccc model
Epoch 76
     Update 77 Cost 3032.131591796875

Train Data: 0.0420125 0.970688933096
valid Data: 0.169124 0.543133541882
Test  Data: 0.169124 0.543133541882 

Epoch 77
     Update 78 Cost 2343.017578125

Train Data: 0.0502872 0.957264204342
valid Data: 0.160445 0.559502353418
Test  Data: 0.160445 0.559502353418 

Save model
Saving ccc model
Epoch 78
     Update 79 Cost 2887.89013671875

Train Data: 0.0415193 0.971465150767
valid Data: 0.169333 0.542182248373
Test  Data: 0.169333 0.542182248373 

Epoch 79
     Update 80 Cost 2352.91943359375

Train Data: 0.0482765 0.960764324614
valid Data: 0.160432 0.560451846739
Test  Data: 0.160432 0.560451846739 

Save model
Saving ccc model
Epoch 80
     Update 81 Cost 2756.4013671875

Train Data: 0.0410869 0.972133988166
valid Data: 0.169519 0.541231788462
Test  Data: 0.169519 0.541231788462 

Epoch 81
     Update 82 Cost 2361.54296875

Train Data: 0.0464569 0.963788515059
valid Data: 0.16042 0.561159052989
Test  Data: 0.16042 0.561159052989 

Save model
Saving ccc model
Epoch 82
     Update 83 Cost 2636.2236328125

Train Data: 0.0407353 0.972668890711
valid Data: 0.169687 0.540214641253
Test  Data: 0.169687 0.540214641253 

Epoch 83
     Update 84 Cost 2370.630126953125

Train Data: 0.0446926 0.96657773979
valid Data: 0.160394 0.561681521429
Test  Data: 0.160394 0.561681521429 

Save model
Saving ccc model
Epoch 84
     Update 85 Cost 2517.81396484375

Train Data: 0.0405439 0.972983454673
valid Data: 0.169889 0.539115668629
Test  Data: 0.169889 0.539115668629 

Epoch 85
     Update 86 Cost 2387.217529296875

Train Data: 0.0429609 0.969182531278
valid Data: 0.160359 0.562039232303
Test  Data: 0.160359 0.562039232303 

Save model
Saving ccc model
Epoch 86
     Update 87 Cost 2399.68017578125

Train Data: 0.0404587 0.973160518485
valid Data: 0.170119 0.538050652915
Test  Data: 0.170119 0.538050652915 

Epoch 87
     Update 88 Cost 2408.25537109375

Train Data: 0.0413473 0.971505981228
valid Data: 0.160331 0.562265818623
Test  Data: 0.160331 0.562265818623 

Save model
Saving ccc model
Epoch 88
     Update 89 Cost 2288.162109375

Train Data: 0.0404041 0.973292358883
valid Data: 0.170337 0.537040089576
Test  Data: 0.170337 0.537040089576 

Epoch 89
     Update 90 Cost 2428.099365234375

Train Data: 0.0398333 0.97359903821
valid Data: 0.160317 0.562406210193
Test  Data: 0.160317 0.562406210193 

Save model
Saving ccc model
Epoch 90
     Update 91 Cost 2182.2255859375

Train Data: 0.0403861 0.973373790376
valid Data: 0.170551 0.536077709543
Test  Data: 0.170551 0.536077709543 

Epoch 91
     Update 92 Cost 2447.7841796875

Train Data: 0.0384521 0.975438265454
valid Data: 0.160316 0.562472892304
Test  Data: 0.160316 0.562472892304 

Save model
Saving ccc model
Epoch 92
     Update 93 Cost 2084.3955078125

Train Data: 0.0403864 0.97342146205
valid Data: 0.170747 0.535124334352
Test  Data: 0.170747 0.535124334352 

Epoch 93
     Update 94 Cost 2465.816162109375

Train Data: 0.0371262 0.977137501309
valid Data: 0.160325 0.562486158962
Test  Data: 0.160325 0.562486158962 

Save model
Saving ccc model
Epoch 94
     Update 95 Cost 1989.25830078125

Train Data: 0.0404292 0.973417042762
valid Data: 0.17095 0.534233875485
Test  Data: 0.17095 0.534233875485 

Epoch 95
     Update 96 Cost 2484.975830078125

Train Data: 0.0358161 0.978757996345
valid Data: 0.160354 0.562510129306
Test  Data: 0.160354 0.562510129306 

Save model
Saving ccc model
Epoch 96
     Update 97 Cost 1894.8006591796875

Train Data: 0.0405513 0.973319955732
valid Data: 0.171185 0.533407736312
Test  Data: 0.171185 0.533407736312 

Epoch 97
     Update 98 Cost 2508.548828125

Train Data: 0.0346025 0.980206422259
valid Data: 0.160394 0.562504398152
Test  Data: 0.160394 0.562504398152 

Epoch 98
     Update 99 Cost 1806.405029296875

Train Data: 0.0406654 0.973230253462
valid Data: 0.171404 0.532648333307
Test  Data: 0.171404 0.532648333307 

Epoch 99
     Update 100 Cost 2529.728515625

Train Data: 0.0334689 0.981514330157
valid Data: 0.160445 0.562488611625
Test  Data: 0.160445 0.562488611625 

Epoch 100
     Update 101 Cost 1723.1593017578125

Train Data: 0.0407961 0.973115922196
valid Data: 0.171615 0.531916520833
Test  Data: 0.171615 0.531916520833 

Epoch 101
     Update 102 Cost 2550.4287109375

Train Data: 0.0324559 0.982641819246
valid Data: 0.160493 0.562396599701
Test  Data: 0.160493 0.562396599701 

Epoch 102
     Update 103 Cost 1647.052734375

Train Data: 0.0408894 0.973036655488
valid Data: 0.171787 0.531200313611
Test  Data: 0.171787 0.531200313611 

Epoch 103
     Update 104 Cost 2566.49365234375

Train Data: 0.0315126 0.983656713015
valid Data: 0.16054 0.562255543091
Test  Data: 0.16054 0.562255543091 

Epoch 104
     Update 105 Cost 1574.864501953125

Train Data: 0.0409915 0.972938418879
valid Data: 0.171945 0.530484693815
Test  Data: 0.171945 0.530484693815 

Epoch 105
     Update 106 Cost 2581.6337890625

Train Data: 0.0306398 0.984564214837
valid Data: 0.160582 0.562052212069
Test  Data: 0.160582 0.562052212069 

Early Stop!

The Best test rmse: 0.15725453198
The Best test ccc: 0.562510129306
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0713402 0.900752665046
valid Data: 0.157255 0.512909028901
Test  Data: 0.157255 0.512909028901 


The src run for 106 epochs, with 10.545736 sec/epochs
Training took 1118s
Stage 2:  ((0.071340233, 0.9007526650457699), (0.15725453, 0.51290902890052881), (0.15725453, 0.51290902890052881))
admin1_417@admin1:~/Raoqiyu/Exp/LSTM/Solution$ cls

admin1_417@admin1:~/Raoqiyu/Exp/LSTM/Solution$ python AVEC2015Solution.py 
Using gpu device 0: GeForce GTX 780 Ti
Data :  features_video_appearance arousal
Data :  load_avec2015_data_generated2
-------------------- Loading Data --------------------
9 train examples
3 valid examples
6 test  examples

 -------------------- Building Model --------------------
Add a BLSTM layer
Add a avec activation layer

--------------------Model Configuration--------------------
3 layers
Input  Layer : 1
Hidden Layer : 1 BLSTM
Output Layer : 1 avec_activate

--------------------Model Paramter--------------------
{'valid_batch_size': 5, 'reload_model': None, 'patience': 10, 'epochs': 2000, 'learning_rate': 1e-05, 'dispFreq': 1, 'optimizer': <optimizer.ADADELTA object at 0x7fb6cd248438>, 'shuffle': False, 'batch_size': 4, 'saveto': 'Stage2/Basic/Unsupervised/arousal/model/', 'L2_penalty': None, 'L1_penalty': None, 'validFreq': -1, 'saveFreq': 1110}
loss : abs
pretraining
9 9 9

 -------------------- Trainig --------------------
Before Training:
Train Data: 0.185229 -0.0211899151292
valid Data: 0.200612 -0.00926911571867
Test  Data: 0.200612 -0.00926911571867
Epoch 0
     Update 1 Cost 4642.37109375
     Update 2 Cost 4731.63671875
     Update 3 Cost 1117.6728515625

Train Data: 0.183135 -0.0112049941997
valid Data: 0.202534 -0.00471720138941
Test  Data: 0.202534 -0.00471720138941 

Save model
Saving rmse model
Epoch 1
     Update 4 Cost 4556.2294921875
     Update 5 Cost 4693.453125
     Update 6 Cost 1085.774169921875

Train Data: 0.181594 -0.00144993045322
valid Data: 0.204492 -0.000560224190491
Test  Data: 0.204492 -0.000560224190491 

Epoch 2
     Update 7 Cost 4486.21484375
     Update 8 Cost 4664.5791015625
     Update 9 Cost 1059.149658203125

Train Data: 0.180438 0.00829289858319
valid Data: 0.206317 0.00337517267148
Test  Data: 0.206317 0.00337517267148 

Save model
Saving ccc model
Epoch 3
     Update 10 Cost 4429.18359375
     Update 11 Cost 4641.181640625
     Update 12 Cost 1036.379638671875

Train Data: 0.179495 0.0184249189066
valid Data: 0.207941 0.00731113997772
Test  Data: 0.207941 0.00731113997772 

Save model
Saving ccc model
Epoch 4
     Update 13 Cost 4381.28857421875
     Update 14 Cost 4620.7548828125
     Update 15 Cost 1017.1277465820312

Train Data: 0.178624 0.0293239035497
valid Data: 0.209188 0.0114468191393
Test  Data: 0.209188 0.0114468191393 

Save model
Saving ccc model
Epoch 5
     Update 16 Cost 4339.38232421875
     Update 17 Cost 4600.03076171875
     Update 18 Cost 999.7903442382812

Train Data: 0.177724 0.0413677209993
valid Data: 0.210176 0.015946708386
Test  Data: 0.210176 0.015946708386 

Save model
Saving ccc model
Epoch 6
     Update 19 Cost 4299.375
     Update 20 Cost 4577.134765625
     Update 21 Cost 983.8916015625

Train Data: 0.176705 0.0549939353672
valid Data: 0.210819 0.0210028597551
Test  Data: 0.210819 0.0210028597551 

Save model
Saving ccc model
Epoch 7
     Update 22 Cost 4259.310546875
     Update 23 Cost 4549.7236328125
     Update 24 Cost 968.1409912109375

Train Data: 0.175503 0.0708016128342
valid Data: 0.211218 0.0268391532646
Test  Data: 0.211218 0.0268391532646 

Save model
Saving ccc model
Epoch 8
     Update 25 Cost 4215.92529296875
     Update 26 Cost 4516.14501953125
     Update 27 Cost 952.0040283203125

Train Data: 0.174024 0.089596149704
valid Data: 0.211308 0.0337767162694
Test  Data: 0.211308 0.0337767162694 

Save model
Saving ccc model
Epoch 9
     Update 28 Cost 4167.32763671875
     Update 29 Cost 4473.2138671875
     Update 30 Cost 935.05517578125

Train Data: 0.172146 0.112557687206
valid Data: 0.211042 0.0422806006289
Test  Data: 0.211042 0.0422806006289 

Save model
Saving ccc model
Epoch 10
     Update 31 Cost 4109.75634765625
     Update 32 Cost 4418.2958984375
     Update 33 Cost 914.8447875976562

Train Data: 0.169741 0.141525102376
valid Data: 0.210528 0.0530286946972
Test  Data: 0.210528 0.0530286946972 

Save model
Saving ccc model
Epoch 11
     Update 34 Cost 4037.38134765625
     Update 35 Cost 4345.9892578125
     Update 36 Cost 889.1890869140625

Train Data: 0.16655 0.17943713008
valid Data: 0.2097 0.0671738741341
Test  Data: 0.2097 0.0671738741341 

Save model
Saving ccc model
Epoch 12
     Update 37 Cost 3941.843505859375
     Update 38 Cost 4247.30712890625
     Update 39 Cost 854.34423828125

Train Data: 0.162135 0.231350808564
valid Data: 0.20848 0.0867769382064
Test  Data: 0.20848 0.0867769382064 

Save model
Saving ccc model
Epoch 13
     Update 40 Cost 3808.010498046875
     Update 41 Cost 4105.11376953125
     Update 42 Cost 802.4977416992188

Train Data: 0.155676 0.306538957894
valid Data: 0.206742 0.115956570376
Test  Data: 0.206742 0.115956570376 

Save model
Saving ccc model
Epoch 14
     Update 43 Cost 3605.107666015625
     Update 44 Cost 3881.82958984375
     Update 45 Cost 717.2763671875

Train Data: 0.145571 0.421168346632
valid Data: 0.204131 0.163916372233
Test  Data: 0.204131 0.163916372233 

Save model
Saving ccc model
Epoch 15
     Update 46 Cost 3267.9091796875
     Update 47 Cost 3491.94873046875
     Update 48 Cost 569.1309204101562

Train Data: 0.129489 0.586520196721
valid Data: 0.199186 0.249973806447
Test  Data: 0.199186 0.249973806447 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 16
     Update 49 Cost 2698.3271484375
     Update 50 Cost 2794.82177734375
     Update 51 Cost 383.4227294921875

Train Data: 0.107388 0.750422408625
valid Data: 0.187871 0.372817055655
Test  Data: 0.187871 0.372817055655 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 17
     Update 52 Cost 2092.121826171875
     Update 53 Cost 2668.823974609375
     Update 54 Cost 364.7149963378906

Train Data: 0.0939286 0.796709192441
valid Data: 0.171977 0.397907220844
Test  Data: 0.171977 0.397907220844 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 18
     Update 55 Cost 1756.8515625
     Update 56 Cost 2828.19189453125
     Update 57 Cost 476.77288818359375

Train Data: 0.0839386 0.850091147025
valid Data: 0.169244 0.451525939158
Test  Data: 0.169244 0.451525939158 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 19
     Update 58 Cost 1452.2459716796875
     Update 59 Cost 1805.4569091796875
     Update 60 Cost 533.2479248046875

Train Data: 0.0763321 0.878269861754
valid Data: 0.163935 0.476142496594
Test  Data: 0.163935 0.476142496594 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 20
     Update 61 Cost 1398.9111328125
     Update 62 Cost 2587.082275390625
     Update 63 Cost 442.84375

Train Data: 0.0698138 0.904429106066
valid Data: 0.164113 0.50552907535
Test  Data: 0.164113 0.50552907535 

Save model
Saving ccc model
Epoch 21
     Update 64 Cost 1244.07373046875
     Update 65 Cost 1497.2818603515625
     Update 66 Cost 423.1646423339844

Train Data: 0.0644927 0.918583063976
valid Data: 0.162581 0.51179894885
Test  Data: 0.162581 0.51179894885 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 22
     Update 67 Cost 1105.74853515625
     Update 68 Cost 1744.32763671875
     Update 69 Cost 537.589111328125

Train Data: 0.0637777 0.920065741836
valid Data: 0.158397 0.51830835836
Test  Data: 0.158397 0.51830835836 

Save model
Saving rmse model
Save model
Saving ccc model
Epoch 23
     Update 70 Cost 1399.87060546875
     Update 71 Cost 2405.98046875
     Update 72 Cost 328.12408447265625

Train Data: 0.0539377 0.947730558319
valid Data: 0.16258 0.545489120016
Test  Data: 0.16258 0.545489120016 

Save model
Saving ccc model
Epoch 24
     Update 73 Cost 970.5487060546875
     Update 74 Cost 1045.282958984375
     Update 75 Cost 176.3629608154297

Train Data: 0.0510453 0.951266199671
valid Data: 0.159924 0.539345173008
Test  Data: 0.159924 0.539345173008 

Epoch 25
     Update 76 Cost 914.6051635742188
     Update 77 Cost 2107.523681640625
     Update 78 Cost 301.72430419921875

Train Data: 0.044598 0.965364460531
valid Data: 0.161732 0.559788948107
Test  Data: 0.161732 0.559788948107 

Save model
Saving ccc model
Epoch 26
     Update 79 Cost 807.885498046875
     Update 80 Cost 973.375244140625
     Update 81 Cost 377.4349670410156

Train Data: 0.0453494 0.963183692686
valid Data: 0.159198 0.554933070657
Test  Data: 0.159198 0.554933070657 

Epoch 27
     Update 82 Cost 970.0452880859375
     Update 83 Cost 2010.7884521484375
     Update 84 Cost 235.0144500732422

Train Data: 0.0377863 0.976304413217
valid Data: 0.163486 0.569628301068
Test  Data: 0.163486 0.569628301068 

Save model
Saving ccc model
Epoch 28
     Update 85 Cost 722.32421875
     Update 86 Cost 723.7684326171875
     Update 87 Cost 275.5409240722656

Train Data: 0.0353035 0.979048964951
valid Data: 0.163815 0.563174986079
Test  Data: 0.163815 0.563174986079 

Epoch 29
     Update 88 Cost 636.5791015625
     Update 89 Cost 919.1668701171875
     Update 90 Cost 376.06024169921875

Train Data: 0.0371021 0.977471709957
valid Data: 0.167364 0.558696891292
Test  Data: 0.167364 0.558696891292 

Epoch 30
     Update 91 Cost 805.9840087890625
     Update 92 Cost 1288.39404296875
     Update 93 Cost 223.45407104492188

Train Data: 0.0320949 0.982488960059
valid Data: 0.163082 0.559180895204
Test  Data: 0.163082 0.559180895204 

Epoch 31
     Update 94 Cost 572.3643798828125
     Update 95 Cost 748.0572509765625
     Update 96 Cost 415.1554870605469

Train Data: 0.0369586 0.97848794992
valid Data: 0.169713 0.560003893501
Test  Data: 0.169713 0.560003893501 

Epoch 32
     Update 97 Cost 880.8170166015625
     Update 98 Cost 1206.517578125
     Update 99 Cost 207.19056701660156

Train Data: 0.029467 0.98531685415
valid Data: 0.163125 0.557958887677
Test  Data: 0.163125 0.557958887677 

Epoch 33
     Update 100 Cost 539.2382202148438
     Update 101 Cost 765.5303955078125
     Update 102 Cost 394.56634521484375

Train Data: 0.0340711 0.98179683187
valid Data: 0.169254 0.560172469631
Test  Data: 0.169254 0.560172469631 

Epoch 34
     Update 103 Cost 818.510986328125
     Update 104 Cost 1186.11572265625
     Update 105 Cost 191.2287139892578

Train Data: 0.0273629 0.987377734751
valid Data: 0.162888 0.557256511088
Test  Data: 0.162888 0.557256511088 

Epoch 35
     Update 106 Cost 488.40228271484375
     Update 107 Cost 739.8505249023438
     Update 108 Cost 395.86248779296875

Train Data: 0.0325947 0.983520519573
valid Data: 0.169326 0.561008859665
Test  Data: 0.169326 0.561008859665 

Epoch 36
     Update 109 Cost 789.0938720703125
     Update 110 Cost 1172.422119140625
     Update 111 Cost 174.43209838867188

Train Data: 0.025287 0.989290087027
valid Data: 0.162653 0.558122038264
Test  Data: 0.162653 0.558122038264 

Epoch 37
     Update 112 Cost 428.57489013671875
     Update 113 Cost 646.7658081054688
     Update 114 Cost 407.85125732421875

Train Data: 0.0327877 0.983530843799
valid Data: 0.169946 0.560591848547
Test  Data: 0.169946 0.560591848547 

Epoch 38
     Update 115 Cost 812.7615966796875
     Update 116 Cost 1139.20068359375
     Update 117 Cost 170.78292846679688

Train Data: 0.0235242 0.990800346723
valid Data: 0.162719 0.558607525655
Test  Data: 0.162719 0.558607525655 

Epoch 39
     Update 118 Cost 389.0216979980469
     Update 119 Cost 649.0913696289062
     Update 120 Cost 389.6416320800781

Train Data: 0.0307973 0.985500119912
valid Data: 0.169438 0.561196869767
Test  Data: 0.169438 0.561196869767 

Epoch 40
     Update 121 Cost 760.7296142578125
     Update 122 Cost 1137.0308837890625
     Update 123 Cost 154.97401428222656

Train Data: 0.0221356 0.991881795781
valid Data: 0.162458 0.558999934836
Test  Data: 0.162458 0.558999934836 

Early Stop!

The Best test rmse: 0.158397376537
The Best test ccc: 0.569628301068
Test with best Param
Load model, the model loaded must have the same network struct with this
Train Data: 0.0637777 0.920065741836
valid Data: 0.158397 0.51830835836
Test  Data: 0.158397 0.51830835836 


The src run for 41 epochs, with 23.738972 sec/epochs
Training took 973s
Stage 2:  ((0.063777685, 0.92006574183604795), (0.15839738, 0.51830835836016753), (0.15839738, 0.51830835836016753))

